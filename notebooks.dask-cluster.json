{"version":2,"kind":"Notebook","sha256":"1c579c9726c74eccbfca8a4e37043479cbcb580aec0bd577b2367bc8b3d42711","slug":"notebooks.dask-cluster","location":"/notebooks/04-dask-cluster.ipynb","dependencies":[],"frontmatter":{"title":"Dask Schedulers","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Negin Sobhani","given":"Negin","family":"Sobhani"},"name":"Negin Sobhani","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Brian Vanderwende","given":"Brian","family":"Vanderwende"},"name":"Brian Vanderwende","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Deepak Cherian","given":"Deepak","family":"Cherian"},"name":"Deepak Cherian","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Ben Kirk","given":"Ben","family":"Kirk"},"name":"Ben Kirk","id":"contributors-myst-generated-uid-3"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/dask-cookbook","copyright":"2024","affiliations":[{"id":"University at Albany (State University of New York)","name":"University at Albany (State University of New York)"},{"id":"UCAR/NCAR","name":"UCAR/NCAR"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/dask-cookbook/blob/main/notebooks/04-dask-cluster.ipynb","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","exports":[{"format":"ipynb","filename":"04-dask-cluster.ipynb","url":"/dask-cookbook/build/04-dask-cluster-7bc15edcd1cc21fe8e91724dacb37b0a.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","alt":"Dask logo","key":"XXMJ6cd6OM","urlSource":"https://docs.dask.org/en/stable/_images/dask_horizontal.svg"}],"key":"onEhOBnFDY"},{"type":"heading","depth":1,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Dask Schedulers","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RZL4LFAreK"}],"identifier":"dask-schedulers","label":"Dask Schedulers","html_id":"dask-schedulers","implicit":true,"key":"bBA792q62H"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In this tutorial, you learn:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qYCpBRMrBL"}],"identifier":"in-this-tutorial-you-learn","label":"In this tutorial, you learn:","html_id":"in-this-tutorial-you-learn","implicit":true,"key":"mErBRSIwg6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Components of Dask Schedulers","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"g9omCLmhbq"}],"key":"uKcDNUUUHr"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Types of Dask Schedulers","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"LxExK7ibGI"}],"key":"HkzLlT9nQr"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Single Machine Schedulers","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"OI3ZtS6nhR"}],"key":"AaeahYYSkt"}],"key":"kv1n95Ccnh"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Related Documentation","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"cXeIHEqWxT"}],"key":"hjvinVucas"}],"key":"krfCS9oasJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"link","url":"https://docs.dask.org/en/stable/scheduling.html","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Dask Scheduling","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"eAiTy2tReO"}],"urlSource":"https://docs.dask.org/en/stable/scheduling.html","key":"r13MXVu1he"}],"key":"pcM812jDCh"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"link","url":"https://docs.dask.org/en/stable/deploying-python.html","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Dask Local Cluster","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Mpjd33KFiV"}],"urlSource":"https://docs.dask.org/en/stable/deploying-python.html","key":"vxmfjw4m3O"}],"key":"XxZy4G8eAP"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"link","url":"https://docs.dask.org/en/stable/deploying.html","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Deploying Dask Cluster Manager","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"CZxh093uDF"}],"urlSource":"https://docs.dask.org/en/stable/deploying.html","key":"WBEl5enrbP"}],"key":"XbHCQRTPKh"}],"key":"cJ9VgkAOtp"}],"key":"szhp61ncZw"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HD65TusC5E"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"LXmaLW9uSD"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"As we mentioned in our Dask overview, Dask is composed of two main parts:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"va4UM44Hiu"}],"key":"vxUnGStomI"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dask Collections (APIs)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Nyw4TxxkpE"}],"key":"IhOEHsr7m6"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Dynamic Task Scheduling","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dypyBTglzt"}],"key":"V1ogp5VVgW"}],"key":"ejGG1TXKdV"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"So far, we have talked about different Dask collections, but in this tutorial we are going to talk more about the second part.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"coPVYEyIhq"}],"key":"EXTeUiJ4Jr"},{"type":"heading","depth":2,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The Dask scheduler - our task orchestrator","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kU04yXiurm"}],"identifier":"the-dask-scheduler-our-task-orchestrator","label":"The Dask scheduler - our task orchestrator","html_id":"the-dask-scheduler-our-task-orchestrator","implicit":true,"key":"CFg7Vka8jb"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"dcR2Q9X61C"},{"type":"inlineCode","value":"Dask.distributed","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"khd2wzCfhd"},{"type":"text","value":" task ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"dr9ZhyXON8"},{"type":"emphasis","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"scheduler","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"iYK0F8mOTv"}],"key":"MToGP788YD"},{"type":"text","value":" is a centralized, dynamic system that coordinates the efforts of various dask ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"scmO7mMTQJ"},{"type":"emphasis","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"worker","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"TR17AKoEQD"}],"key":"tvApLPwL2q"},{"type":"text","value":" processes spread accross different machines.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Dpnj9rXLIY"}],"key":"RH8DsjOxpO"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"When a computational task is submitted, the Dask distributed ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"E17e0HiTKh"},{"type":"emphasis","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"scheduler","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"pUmoaqJAt2"}],"key":"GnVNIx5icG"},{"type":"text","value":" sends it off to a Dask ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"qEoUe7RQ6S"},{"type":"emphasis","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"cluster","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"mzjlXNwUDz"}],"key":"Zlluam1d6s"},{"type":"text","value":" - simply a collection of Dask ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"RpuXx8phkI"},{"type":"emphasis","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"workers","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"VoDhnGyL4c"}],"key":"NyZw39N67m"},{"type":"text","value":". A worker is typically a separate Python process on either the local host or a remote machine.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"yRC9Hfii2A"}],"key":"zpheQ9N4gq"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"To perform work, a scheduler must be assigned resources in the form of a Dask cluster. The cluster consists of the following components:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"AmogntBZG6"}],"key":"wT9XHbModQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"scheduler","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"waHI1flSNy"}],"key":"yVN4jIwwRZ"},{"type":"text","value":" : A scheduler creates and manages task graphs and distributes tasks to workers.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"y9vINMnn7L"}],"key":"vnNSPwmG3s"}],"key":"UgGR50BYWR"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"workers","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"NvPCCOl8Af"}],"key":"xWvZdKqFBY"},{"type":"text","value":" : A worker is typically a separate Python process on either the local host or a remote machine. A Dask ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"yB77S4j4U1"},{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"cluster","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"OFFJXaCf86"}],"key":"NySOZVz5xL"},{"type":"text","value":" usually consists of many workers. Basically, a worker is a Python interpretor which will perform work on a subset of our dataset.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"SYCuAVyyeY"}],"key":"Ij2ceHzwG7"}],"key":"zD9uBQp8HK"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"client","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Bu8H6KLk4N"}],"key":"icI7nBx2Tl"},{"type":"text","value":" - A high-level interface that points to the scheduler (often local but not always). A client serves as the entry point for interacting with a Dask scheduler.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"w4JRCkbnOp"}],"key":"I7DbpH6Fmk"}],"key":"V3xRpdkny8"}],"key":"ozwTfq4rnY"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"image","url":"/dask-cookbook/build/7445a9f1307deaa4760238b8ed4d85c3.png","alt":"Dask Distributed Cluster","key":"LxvObCIhgC","urlSource":"https://tutorial.dask.org/_images/distributed-overview.png"}],"key":"VyO6idOgjz"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Image credit: Dask Contributors","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"ixiIj1aRwM"}],"key":"tDGUFW4u2h"}],"key":"oSVbjqTx7w"}],"visibility":"show","key":"H8xre1q36m"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Schedulers","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M4YS6AXgVQ"}],"identifier":"schedulers","label":"Schedulers","html_id":"schedulers","implicit":true,"key":"M1yk5dJLjd"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Dask essentially offers two types of schedulers:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HK3BeFsr9F"}],"key":"FdYZ6qDtDV"},{"type":"image","style":{"verticalAlign":"middle","margin":"30px 0px"},"url":"/dask-cookbook/build/8b6da849318d7659184d63558507155e.svg","alt":"High level collections are used to generate task graphs which can be executed by schedulers on a single machine or a cluster.","key":"bsrWYBrY8G","urlSource":"https://docs.dask.org/en/stable/_images/dask-overview.svg"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Image credit: Dask Contributors","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jwSPZ2t0DI"}],"key":"JixGFZBN1E"}],"key":"psYxDHVoV7"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"1. Single machine scheduler","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UYvX4b6nUh"}],"identifier":"id-1-single-machine-scheduler","label":"1. Single machine scheduler","html_id":"id-1-single-machine-scheduler","implicit":true,"key":"VfbHjGzGQA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The Single-machine Scheduler schedules tasks and manages the execution of those tasks on the same machine where the scheduler is running.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Xw7GPwKPwx"}],"key":"hzgWPdLlMF"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"It is designed to be used in situations where the amount of data or the computational requirements are too large for a single process to handle, but not large enough to warrant the use of a cluster of machines.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"cSWGLGswTz"}],"key":"uORaRLjU3w"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"It is relatively simple and cheap to use but it does not scale as it only runs on a single machine.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"haZrvHVSm8"}],"key":"XGIYKee9Cv"}],"key":"Hz0zWxBcG1"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Single machine scheduler is the default choice used by Dask.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"mE6cYz8oSr"}],"key":"SqEXR9ofqL"}],"key":"hzhKDLWIca"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"In Dask, there are several types of single machine schedulers that can be used to schedule computations on a single machine:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Y40HEApYIj"}],"key":"thagXhCwwV"},{"type":"heading","depth":4,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"1.1. Single-threaded scheduler","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Nx1SwcBzIN"}],"identifier":"id-1-1-single-threaded-scheduler","label":"1.1. Single-threaded scheduler","html_id":"id-1-1-single-threaded-scheduler","implicit":true,"key":"zmMDeWFRgS"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"This scheduler runs all tasks ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"T9TeBfPsIx"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"serially","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Ktds6uopfG"}],"key":"QcHBZBaj1x"},{"type":"text","value":" on a single thread.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"qeSIjghEXq"},{"type":"break","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"mrDBIRxZds"},{"type":"text","value":"This is only useful for debugging and profiling, but does not have any parallelization.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"nYop13bver"}],"key":"bOKILJPpXa"},{"type":"heading","depth":4,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"1.2. Threaded scheduler","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Z81Nu86t8p"}],"identifier":"id-1-2-threaded-scheduler","label":"1.2. Threaded scheduler","html_id":"id-1-2-threaded-scheduler","implicit":true,"key":"oeS7Lu6qpy"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"The threaded scheduler uses a pool of ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"S4hSclx4su"},{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"local","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"FSRlMzNdne"}],"key":"G5vsLXJte6"},{"type":"text","value":" threads to execute tasks concurrently.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"p2y9g23WjX"},{"type":"break","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"pJhhLhrsAi"},{"type":"text","value":"This is the default scheduler for Dask, and is suitable for most use cases on a single machine. Multithreading works well for Dask Array and Dask DataFrame.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Nxw1RHvuJE"}],"key":"JsgF4XudhQ"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"To select one of the above scheduler for your computation, you can specify it when doing ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"RpRG2ymzFw"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"duQGlnQpLj"},{"type":"text","value":":","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"ycw5IhzvtG"}],"key":"Hh7mVM7OUz"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"For example:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"cbK6zgsW9f"}],"key":"riYHu17Z5z"},{"type":"code","lang":"python","value":"this.compute(scheduler=\"single-threaded\")  # for debugging and profiling only","position":{"start":{"line":28,"column":1},"end":{"line":30,"column":1}},"key":"YMWhftplis"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"As mentioned above the ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"YfYC8fPLf3"},{"type":"emphasis","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"threaded scheduler","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"AiIFwY0RCZ"}],"key":"Xtafq7AViD"},{"type":"text","value":" is the default scheduler in Dask. But you can set the default scheduler to Single-threaded or multi-processing by:","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"jPMOEhPYLs"}],"key":"xA0z2bPuQw"},{"type":"code","lang":"python","value":"import dask\ndask.config.set(scheduler='synchronous')  # overwrite default with single-threaded scheduler","position":{"start":{"line":35,"column":1},"end":{"line":38,"column":1}},"key":"fjXMnFX6yv"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Multi-processing works well for pure Python code - ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"ctjKPJPjKy"},{"type":"emphasis","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"delayed","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"KYRHklm9V7"}],"key":"ffMb4K4k61"},{"type":"text","value":" functions and operations on Dask Bags.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"uWW1FeqOMY"}],"key":"ZyXw9f0sbw"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Let’s compare the performance of each of these single-machine schedulers:","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Bsgo9Dexn5"}],"key":"X8UbYwZCAf"}],"key":"dJD4k2B8wV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport dask.array as da","key":"aeTw3GlJub"},{"type":"output","id":"8uFPn19xAlFAlUWlI99yH","data":[],"key":"WEvRaLY8cL"}],"key":"XTpZZGSGo8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n## - numpy performance\nxn = np.random.normal(10, 0.1, size=(20_000, 20_000))\nyn = xn.mean(axis=0)\nyn","key":"SiUk1NLPiS"},{"type":"output","id":"S5zz_ycbp-Kqsn_MVAiC8","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 10.5 s, sys: 560 ms, total: 11.1 s\nWall time: 12.8 s\n"},{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"array([10.00059125, 10.00023498,  9.99930007, ..., 10.00024688,\n       10.00109689,  9.99996966], shape=(20000,))","content_type":"text/plain"}}}],"key":"r4j702hAka"}],"key":"nRGBCM8iT2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# -- dask array using the default\nxd = da.random.normal(10, 0.1, size=(20_000, 20_000), chunks=(2000, 2000))\nyd = xd.mean(axis=0)\nyd.compute()","key":"lWh9OjaeIF"},{"type":"output","id":"yLQ0ihQHIMdi86RDBNbz-","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 13.5 s, sys: 91.4 ms, total: 13.6 s\nWall time: 8.1 s\n"},{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"array([ 9.99966558,  9.99941789,  9.99947001, ..., 10.00069628,\n        9.99886034,  9.99942357], shape=(20000,))","content_type":"text/plain"}}}],"key":"yQFBrmWuHE"}],"key":"pvbuSwSTka"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import time\n# -- dask testing different schedulers:\nfor sch in ['threading', 'processes', 'sync']:\n    t0 = time.time()\n    r = yd.compute(scheduler=sch)\n    t1 = time.time()\n    print(f\"{sch:>10} :  {t1 - t0:0.4f} s\")","key":"fPPWM0dqvi"},{"type":"output","id":"kUKP9X_bnzWOAFvSzx_Mv","data":[{"output_type":"stream","name":"stdout","text":" threading :  8.5858 s\n"},{"output_type":"stream","name":"stdout","text":" processes :  13.3546 s\n"},{"output_type":"stream","name":"stdout","text":"      sync :  19.1504 s\n"}],"key":"UQPcyYDz4s"}],"key":"n9fGbK2wVs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"yd.dask","key":"SpaZ8IXtWF"},{"type":"output","id":"Fyf5hJAvhHIdiSM08JKM1","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"HighLevelGraph with 4 layers.\n<dask.highlevelgraph.HighLevelGraph object at 0x7f62e6cc0b00>\n 0. normal-0bd0ae0233e478a373da25399129e5ab\n 1. mean_chunk-7efa5b8e0b8747de0e6087c8151d5fc3\n 2. mean_combine-partial-72deb16c1034a633c842e13aeb2a85b6\n 3. mean_agg-aggregate-4dd8a9cc478fce7a32ac4b0e55f58501","content_type":"text/plain"},"text/html":{"content":"<div>\n    <div>\n        <div style=\"width: 52px; height: 52px; position: absolute;\">\n            <svg width=\"76\" height=\"71\" viewBox=\"0 0 76 71\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <circle cx=\"61.5\" cy=\"36.5\" r=\"13.5\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);\" stroke-width=\"2\"/>\n                <circle cx=\"14.5\" cy=\"14.5\" r=\"13.5\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);\" stroke-width=\"2\"/>\n                <circle cx=\"14.5\" cy=\"56.5\" r=\"13.5\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);\" stroke-width=\"2\"/>\n                <path d=\"M28 16L30.5 16C33.2614 16 35.5 18.2386 35.5 21L35.5 32.0001C35.5 34.7615 37.7386 37.0001 40.5 37.0001L43 37.0001\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D);\" stroke-width=\"1.5\"/>\n                <path d=\"M40.5 37L40.5 37.75L40.5 37.75L40.5 37ZM35.5 42L36.25 42L35.5 42ZM35.5 52L34.75 52L35.5 52ZM30.5 57L30.5 57.75L30.5 57ZM41.5001 36.25L40.5 36.25L40.5 37.75L41.5001 37.75L41.5001 36.25ZM34.75 42L34.75 52L36.25 52L36.25 42L34.75 42ZM30.5 56.25L28.0001 56.25L28.0001 57.75L30.5 57.75L30.5 56.25ZM34.75 52C34.75 54.3472 32.8472 56.25 30.5 56.25L30.5 57.75C33.6756 57.75 36.25 55.1756 36.25 52L34.75 52ZM40.5 36.25C37.3244 36.25 34.75 38.8243 34.75 42L36.25 42C36.25 39.6528 38.1528 37.75 40.5 37.75L40.5 36.25Z\" style=\"fill: var(--jp-ui-font-color2, #1D1D1D);\"/>\n                <circle cx=\"28\" cy=\"16\" r=\"2.25\" fill=\"#E5E5E5\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D);\" stroke-width=\"1.5\"/>\n                <circle cx=\"28\" cy=\"57\" r=\"2.25\" fill=\"#E5E5E5\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D);\" stroke-width=\"1.5\"/>\n                <path d=\"M45.25 36.567C45.5833 36.7594 45.5833 37.2406 45.25 37.433L42.25 39.1651C41.9167 39.3575 41.5 39.117 41.5 38.7321V35.2679C41.5 34.883 41.9167 34.6425 42.25 34.8349L45.25 36.567Z\" style=\"fill: var(--jp-ui-font-color2, #1D1D1D);\"/>\n            </svg>\n        </div>\n        <div style=\"margin-left: 64px;\">\n            <h3 style=\"margin-bottom: 0px;\">HighLevelGraph</h3>\n            <p style=\"color: var(--jp-ui-font-color2, #5D5851); margin-bottom:0px;\">\n                HighLevelGraph with 4 layers and 240 keys from all layers.\n            </p>\n            \n            <div style=\"\">\n    <svg width=\"24\" height=\"24\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"position: absolute;\">\n        \n        <circle cx=\"16\" cy=\"16\" r=\"14\" fill=\"#8F8F8F\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D);\" stroke-width=\"2\"/>\n        \n    </svg>\n\n    <details style=\"margin-left: 32px;\">\n        <summary style=\"margin-bottom: 10px; margin-top: 10px;\">\n            <h4 style=\"display: inline;\">Layer1: normal</h4>\n        </summary>\n        <p style=\"color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;\">\n            normal-0bd0ae0233e478a373da25399129e5ab\n        </p>\n\n        <table>\n        <tr>\n            <td>\n                <table>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">layer_type</th>\n                        <td style=\"text-align: left;\">MaterializedLayer</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">is_materialized</th>\n                        <td style=\"text-align: left;\">True</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">number of outputs</th>\n                        <td style=\"text-align: left;\">100</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">shape</th>\n                        <td style=\"text-align: left;\">(20000, 20000)</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">dtype</th>\n                        <td style=\"text-align: left;\">float64</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">chunksize</th>\n                        <td style=\"text-align: left;\">(2000, 2000)</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">type</th>\n                        <td style=\"text-align: left;\">dask.array.core.Array</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">chunk_type</th>\n                        <td style=\"text-align: left;\">numpy.ndarray</td>\n                    </tr>\n                \n                \n                </table>\n            </td>\n            <td>\n                <svg width=\"250\" height=\"250\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"200\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"20\" x2=\"200\" y2=\"20\" />\n  <line x1=\"0\" y1=\"40\" x2=\"200\" y2=\"40\" />\n  <line x1=\"0\" y1=\"60\" x2=\"200\" y2=\"60\" />\n  <line x1=\"0\" y1=\"80\" x2=\"200\" y2=\"80\" />\n  <line x1=\"0\" y1=\"100\" x2=\"200\" y2=\"100\" />\n  <line x1=\"0\" y1=\"120\" x2=\"200\" y2=\"120\" />\n  <line x1=\"0\" y1=\"140\" x2=\"200\" y2=\"140\" />\n  <line x1=\"0\" y1=\"160\" x2=\"200\" y2=\"160\" />\n  <line x1=\"0\" y1=\"180\" x2=\"200\" y2=\"180\" />\n  <line x1=\"0\" y1=\"200\" x2=\"200\" y2=\"200\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"200\" style=\"stroke-width:2\" />\n  <line x1=\"20\" y1=\"0\" x2=\"20\" y2=\"200\" />\n  <line x1=\"40\" y1=\"0\" x2=\"40\" y2=\"200\" />\n  <line x1=\"60\" y1=\"0\" x2=\"60\" y2=\"200\" />\n  <line x1=\"80\" y1=\"0\" x2=\"80\" y2=\"200\" />\n  <line x1=\"100\" y1=\"0\" x2=\"100\" y2=\"200\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"200\" />\n  <line x1=\"140\" y1=\"0\" x2=\"140\" y2=\"200\" />\n  <line x1=\"160\" y1=\"0\" x2=\"160\" y2=\"200\" />\n  <line x1=\"180\" y1=\"0\" x2=\"180\" y2=\"200\" />\n  <line x1=\"200\" y1=\"0\" x2=\"200\" y2=\"200\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 200.0,0.0 200.0,200.0 0.0,200.0\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"100.000000\" y=\"220.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >20000</text>\n  <text x=\"220.000000\" y=\"100.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,220.000000,100.000000)\">20000</text>\n</svg>\n            </td>\n        </tr>\n        </table>\n\n    </details>\n</div>\n            \n            <div style=\"\">\n    <svg width=\"24\" height=\"24\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"position: absolute;\">\n        \n        <circle cx=\"16\" cy=\"16\" r=\"14\" fill=\"#8F8F8F\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D);\" stroke-width=\"2\"/>\n        \n    </svg>\n\n    <details style=\"margin-left: 32px;\">\n        <summary style=\"margin-bottom: 10px; margin-top: 10px;\">\n            <h4 style=\"display: inline;\">Layer2: mean_chunk</h4>\n        </summary>\n        <p style=\"color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;\">\n            mean_chunk-7efa5b8e0b8747de0e6087c8151d5fc3\n        </p>\n\n        <table>\n        <tr>\n            <td>\n                <table>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">layer_type</th>\n                        <td style=\"text-align: left;\">Blockwise</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">is_materialized</th>\n                        <td style=\"text-align: left;\">True</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">number of outputs</th>\n                        <td style=\"text-align: left;\">100</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">shape</th>\n                        <td style=\"text-align: left;\">(20000, 20000)</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">dtype</th>\n                        <td style=\"text-align: left;\">float64</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">chunksize</th>\n                        <td style=\"text-align: left;\">(2000, 2000)</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">type</th>\n                        <td style=\"text-align: left;\">dask.array.core.Array</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">chunk_type</th>\n                        <td style=\"text-align: left;\">numpy.ndarray</td>\n                    </tr>\n                \n                \n                    \n                        <tr>\n                            <th style=\"text-align: left; width: 150px;\"> depends on </th>\n                            <td style=\"text-align: left;\">normal-0bd0ae0233e478a373da25399129e5ab</td>\n                        </tr>\n                    \n                \n                </table>\n            </td>\n            <td>\n                <svg width=\"250\" height=\"250\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"200\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"20\" x2=\"200\" y2=\"20\" />\n  <line x1=\"0\" y1=\"40\" x2=\"200\" y2=\"40\" />\n  <line x1=\"0\" y1=\"60\" x2=\"200\" y2=\"60\" />\n  <line x1=\"0\" y1=\"80\" x2=\"200\" y2=\"80\" />\n  <line x1=\"0\" y1=\"100\" x2=\"200\" y2=\"100\" />\n  <line x1=\"0\" y1=\"120\" x2=\"200\" y2=\"120\" />\n  <line x1=\"0\" y1=\"140\" x2=\"200\" y2=\"140\" />\n  <line x1=\"0\" y1=\"160\" x2=\"200\" y2=\"160\" />\n  <line x1=\"0\" y1=\"180\" x2=\"200\" y2=\"180\" />\n  <line x1=\"0\" y1=\"200\" x2=\"200\" y2=\"200\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"200\" style=\"stroke-width:2\" />\n  <line x1=\"20\" y1=\"0\" x2=\"20\" y2=\"200\" />\n  <line x1=\"40\" y1=\"0\" x2=\"40\" y2=\"200\" />\n  <line x1=\"60\" y1=\"0\" x2=\"60\" y2=\"200\" />\n  <line x1=\"80\" y1=\"0\" x2=\"80\" y2=\"200\" />\n  <line x1=\"100\" y1=\"0\" x2=\"100\" y2=\"200\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"200\" />\n  <line x1=\"140\" y1=\"0\" x2=\"140\" y2=\"200\" />\n  <line x1=\"160\" y1=\"0\" x2=\"160\" y2=\"200\" />\n  <line x1=\"180\" y1=\"0\" x2=\"180\" y2=\"200\" />\n  <line x1=\"200\" y1=\"0\" x2=\"200\" y2=\"200\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 200.0,0.0 200.0,200.0 0.0,200.0\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"100.000000\" y=\"220.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >20000</text>\n  <text x=\"220.000000\" y=\"100.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,220.000000,100.000000)\">20000</text>\n</svg>\n            </td>\n        </tr>\n        </table>\n\n    </details>\n</div>\n            \n            <div style=\"\">\n    <svg width=\"24\" height=\"24\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"position: absolute;\">\n        \n        <circle cx=\"16\" cy=\"16\" r=\"14\" fill=\"#8F8F8F\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D);\" stroke-width=\"2\"/>\n        \n    </svg>\n\n    <details style=\"margin-left: 32px;\">\n        <summary style=\"margin-bottom: 10px; margin-top: 10px;\">\n            <h4 style=\"display: inline;\">Layer3: mean_combine-partial</h4>\n        </summary>\n        <p style=\"color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;\">\n            mean_combine-partial-72deb16c1034a633c842e13aeb2a85b6\n        </p>\n\n        <table>\n        <tr>\n            <td>\n                <table>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">layer_type</th>\n                        <td style=\"text-align: left;\">MaterializedLayer</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">is_materialized</th>\n                        <td style=\"text-align: left;\">True</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">number of outputs</th>\n                        <td style=\"text-align: left;\">30</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">shape</th>\n                        <td style=\"text-align: left;\">(3, 20000)</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">dtype</th>\n                        <td style=\"text-align: left;\">float64</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">chunksize</th>\n                        <td style=\"text-align: left;\">(1, 2000)</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">type</th>\n                        <td style=\"text-align: left;\">dask.array.core.Array</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">chunk_type</th>\n                        <td style=\"text-align: left;\">numpy.ndarray</td>\n                    </tr>\n                \n                \n                    \n                        <tr>\n                            <th style=\"text-align: left; width: 150px;\"> depends on </th>\n                            <td style=\"text-align: left;\">mean_chunk-7efa5b8e0b8747de0e6087c8151d5fc3</td>\n                        </tr>\n                    \n                \n                </table>\n            </td>\n            <td>\n                <svg width=\"250\" height=\"92\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"200\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"14\" x2=\"200\" y2=\"14\" />\n  <line x1=\"0\" y1=\"28\" x2=\"200\" y2=\"28\" />\n  <line x1=\"0\" y1=\"42\" x2=\"200\" y2=\"42\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"42\" style=\"stroke-width:2\" />\n  <line x1=\"20\" y1=\"0\" x2=\"20\" y2=\"42\" />\n  <line x1=\"40\" y1=\"0\" x2=\"40\" y2=\"42\" />\n  <line x1=\"60\" y1=\"0\" x2=\"60\" y2=\"42\" />\n  <line x1=\"80\" y1=\"0\" x2=\"80\" y2=\"42\" />\n  <line x1=\"100\" y1=\"0\" x2=\"100\" y2=\"42\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"42\" />\n  <line x1=\"140\" y1=\"0\" x2=\"140\" y2=\"42\" />\n  <line x1=\"160\" y1=\"0\" x2=\"160\" y2=\"42\" />\n  <line x1=\"180\" y1=\"0\" x2=\"180\" y2=\"42\" />\n  <line x1=\"200\" y1=\"0\" x2=\"200\" y2=\"42\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 200.0,0.0 200.0,42.354360857637474 0.0,42.354360857637474\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"100.000000\" y=\"62.354361\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >20000</text>\n  <text x=\"220.000000\" y=\"21.177180\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,220.000000,21.177180)\">3</text>\n</svg>\n            </td>\n        </tr>\n        </table>\n\n    </details>\n</div>\n            \n            <div style=\"\">\n    <svg width=\"24\" height=\"24\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"position: absolute;\">\n        \n        <circle cx=\"16\" cy=\"16\" r=\"14\" fill=\"#8F8F8F\" style=\"stroke: var(--jp-ui-font-color2, #1D1D1D);\" stroke-width=\"2\"/>\n        \n    </svg>\n\n    <details style=\"margin-left: 32px;\">\n        <summary style=\"margin-bottom: 10px; margin-top: 10px;\">\n            <h4 style=\"display: inline;\">Layer4: mean_agg-aggregate</h4>\n        </summary>\n        <p style=\"color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;\">\n            mean_agg-aggregate-4dd8a9cc478fce7a32ac4b0e55f58501\n        </p>\n\n        <table>\n        <tr>\n            <td>\n                <table>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">layer_type</th>\n                        <td style=\"text-align: left;\">MaterializedLayer</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">is_materialized</th>\n                        <td style=\"text-align: left;\">True</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">number of outputs</th>\n                        <td style=\"text-align: left;\">10</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">shape</th>\n                        <td style=\"text-align: left;\">(20000,)</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">dtype</th>\n                        <td style=\"text-align: left;\">float64</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">chunksize</th>\n                        <td style=\"text-align: left;\">(2000,)</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">type</th>\n                        <td style=\"text-align: left;\">dask.array.core.Array</td>\n                    </tr>\n                \n                    <tr>\n                        <th style=\"text-align: left; width: 150px;\">chunk_type</th>\n                        <td style=\"text-align: left;\">numpy.ndarray</td>\n                    </tr>\n                \n                \n                    \n                        <tr>\n                            <th style=\"text-align: left; width: 150px;\"> depends on </th>\n                            <td style=\"text-align: left;\">mean_combine-partial-72deb16c1034a633c842e13aeb2a85b6</td>\n                        </tr>\n                    \n                \n                </table>\n            </td>\n            <td>\n                <svg width=\"250\" height=\"92\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"200\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"42\" x2=\"200\" y2=\"42\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"42\" style=\"stroke-width:2\" />\n  <line x1=\"20\" y1=\"0\" x2=\"20\" y2=\"42\" />\n  <line x1=\"40\" y1=\"0\" x2=\"40\" y2=\"42\" />\n  <line x1=\"60\" y1=\"0\" x2=\"60\" y2=\"42\" />\n  <line x1=\"80\" y1=\"0\" x2=\"80\" y2=\"42\" />\n  <line x1=\"100\" y1=\"0\" x2=\"100\" y2=\"42\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"42\" />\n  <line x1=\"140\" y1=\"0\" x2=\"140\" y2=\"42\" />\n  <line x1=\"160\" y1=\"0\" x2=\"160\" y2=\"42\" />\n  <line x1=\"180\" y1=\"0\" x2=\"180\" y2=\"42\" />\n  <line x1=\"200\" y1=\"0\" x2=\"200\" y2=\"42\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 200.0,0.0 200.0,42.354360857637474 0.0,42.354360857637474\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"100.000000\" y=\"62.354361\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >20000</text>\n  <text x=\"220.000000\" y=\"21.177180\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,220.000000,21.177180)\">1</text>\n</svg>\n            </td>\n        </tr>\n        </table>\n\n    </details>\n</div>\n            \n        </div>\n    </div>\n</div>","content_type":"text/html"}}}],"key":"J7a92Knaxn"}],"key":"oA36obUatY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"yd","key":"NEgSpozvFo"},{"type":"output","id":"SnHbPV_-cgrOZH2iPb6B1","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"dask.array<mean_agg-aggregate, shape=(20000,), dtype=float64, chunksize=(2000,), chunktype=numpy.ndarray>","content_type":"text/plain"},"text/html":{"content":"<table>\n    <tr>\n        <td>\n            <table style=\"border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <td> </td>\n                        <th> Array </th>\n                        <th> Chunk </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr>\n                        <th> Bytes </th>\n                        <td> 156.25 kiB </td>\n                        <td> 15.62 kiB </td>\n                    </tr>\n                    \n                    <tr>\n                        <th> Shape </th>\n                        <td> (20000,) </td>\n                        <td> (2000,) </td>\n                    </tr>\n                    <tr>\n                        <th> Dask graph </th>\n                        <td colspan=\"2\"> 10 chunks in 4 graph layers </td>\n                    </tr>\n                    <tr>\n                        <th> Data type </th>\n                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n                    </tr>\n                </tbody>\n            </table>\n        </td>\n        <td>\n        <svg width=\"170\" height=\"75\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"25\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" />\n  <line x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" />\n  <line x1=\"24\" y1=\"0\" x2=\"24\" y2=\"25\" />\n  <line x1=\"36\" y1=\"0\" x2=\"36\" y2=\"25\" />\n  <line x1=\"48\" y1=\"0\" x2=\"48\" y2=\"25\" />\n  <line x1=\"60\" y1=\"0\" x2=\"60\" y2=\"25\" />\n  <line x1=\"72\" y1=\"0\" x2=\"72\" y2=\"25\" />\n  <line x1=\"84\" y1=\"0\" x2=\"84\" y2=\"25\" />\n  <line x1=\"96\" y1=\"0\" x2=\"96\" y2=\"25\" />\n  <line x1=\"108\" y1=\"0\" x2=\"108\" y2=\"25\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"60.000000\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >20000</text>\n  <text x=\"140.000000\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,140.000000,12.706308)\">1</text>\n</svg>\n        </td>\n    </tr>\n</table>","content_type":"text/html"}}}],"key":"Ayj5Q3yEK7"}],"key":"tMgMbKYFW6"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notice how ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F2mNcAU4PO"},{"type":"inlineCode","value":"sync","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U81rg5FM6L"},{"type":"text","value":" scheduler takes almost the same time as pure NumPy code.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EKehUXyEkO"}],"key":"aeuKTwmGR6"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Why is the multiprocessing scheduler so much slower?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"l43scYSMhI"}],"key":"TAEKGStaj0"}],"key":"XmbeyjR5M3"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"If you use the multiprocessing backend, all communication between processes still needs to pass through the main process because processes are isolated from other processes. This introduces a large overhead.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YTLP88autN"}],"key":"mUkXm6sQu7"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The Dask developers recommend using the Dask Distributed Scheduler which we will cover now.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aq2JHd9XvP"}],"key":"kIxnQ5o6iI"}],"key":"R7vN10kR9u"}],"key":"ddqZxdz4tE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"2. Distributed scheduler","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AgWu31bSWL"}],"identifier":"id-2-distributed-scheduler","label":"2. Distributed scheduler","html_id":"id-2-distributed-scheduler","implicit":true,"key":"rY28c4QXWz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Distributed scheduler or ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QxFHBc8GOZ"},{"type":"inlineCode","value":"dask.distributed","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"plN9WYMSYD"},{"type":"text","value":" schedules tasks and manages the execution of those tasks on workers from a single or multiple machines.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KBX6GSOEJo"}],"key":"xStfRAvZUI"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This scheduler is more sophisticated and offers more features including a live diagnostic dashboard which provides live insight on performance and progress of the calculations.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DRDLcijR1K"}],"key":"ld1jGJPdOp"}],"key":"j65M1erQ04"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In most cases, ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NZ3q5J05ux"},{"type":"inlineCode","value":"dask.distributed","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CVP73LXq3G"},{"type":"text","value":" is preferred since it is very scalable, and provides and informative interactive dashboard and access to more complex Dask collections such as ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"w5WxkzUTnU"},{"type":"inlineCode","value":"futures","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"h3WC6Xl7gv"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Q3bel6U3v6"}],"key":"K8FnulYD5E"}],"key":"thMuf2Cs0d"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.1. Local Cluster","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EdK6XLmopL"}],"identifier":"id-2-1-local-cluster","label":"2.1. Local Cluster","html_id":"id-2-1-local-cluster","implicit":true,"key":"YFosOsFYvb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A Dask Local Cluster refers to a group of worker processes that run on a single machine and are managed by a single Dask scheduler.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q0cfqulUhI"}],"key":"YEjhmpgucB"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This is useful for situations where the computational requirements are not large enough to warrant the use of a full cluster of separate machines. It provides an easy way to run parallel computations on a single machine, without the need for complex cluster management or other infrastructure.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AIkLnxTR03"}],"key":"NSBQxSugL1"}],"key":"CZCrbvgtRB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s start by creating a Local Cluster","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P8vOUNW2be"}],"identifier":"lets-start-by-creating-a-local-cluster","label":"Let’s start by creating a Local Cluster","html_id":"lets-start-by-creating-a-local-cluster","implicit":true,"key":"jBRcsFk33b"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this we need to set up a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EiZGOEiW6y"},{"type":"inlineCode","value":"LocalCluster","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hyJaddD8Sl"},{"type":"text","value":" using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TbKDK6PExW"},{"type":"inlineCode","value":"dask.distributed","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K22KmPD5SZ"},{"type":"text","value":" and connect a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DQWgzBCn5P"},{"type":"inlineCode","value":"client","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZGHQFn59Sk"},{"type":"text","value":" to it.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OOfba6JYey"}],"key":"PHeRxdvo90"}],"key":"YB4WzmNHGi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from dask.distributed import LocalCluster, Client\n\ncluster = LocalCluster()\nclient = Client(cluster)\nclient","key":"rtM8tzLL3x"},{"type":"output","id":"1pMCvAWr2HYAp_T7bic0k","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"<Client: 'tcp://127.0.0.1:40521' processes=4 threads=4, memory=15.62 GiB>","content_type":"text/plain"},"text/html":{"content":"<div>\n    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\"> </div>\n    <div style=\"margin-left: 48px;\">\n        <h3 style=\"margin-bottom: 0px;\">Client</h3>\n        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Client-b0989080-4fd4-11f0-8efc-7c1e5241d17c</p>\n        <table style=\"width: 100%; text-align: left;\">\n\n        <tr>\n        \n            <td style=\"text-align: left;\"><strong>Connection method:</strong> Cluster object</td>\n            <td style=\"text-align: left;\"><strong>Cluster type:</strong> distributed.LocalCluster</td>\n        \n        </tr>\n\n        \n            <tr>\n                <td style=\"text-align: left;\">\n                    <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n                </td>\n                <td style=\"text-align: left;\"></td>\n            </tr>\n        \n\n        </table>\n\n        \n            <button style=\"margin-bottom: 12px;\" data-commandlinker-command=\"dask:populate-and-launch-layout\" data-commandlinker-args='{\"url\": \"http://127.0.0.1:8787/status\" }'>\n                Launch dashboard in JupyterLab\n            </button>\n        \n\n        \n            <details>\n            <summary style=\"margin-bottom: 20px;\"><h3 style=\"display: inline;\">Cluster Info</h3></summary>\n            <div class=\"jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output\">\n    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\">\n    </div>\n    <div style=\"margin-left: 48px;\">\n        <h3 style=\"margin-bottom: 0px; margin-top: 0px;\">LocalCluster</h3>\n        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">90fbd732</p>\n        <table style=\"width: 100%; text-align: left;\">\n            <tr>\n                <td style=\"text-align: left;\">\n                    <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n                </td>\n                <td style=\"text-align: left;\">\n                    <strong>Workers:</strong> 4\n                </td>\n            </tr>\n            <tr>\n                <td style=\"text-align: left;\">\n                    <strong>Total threads:</strong> 4\n                </td>\n                <td style=\"text-align: left;\">\n                    <strong>Total memory:</strong> 15.62 GiB\n                </td>\n            </tr>\n            \n            <tr>\n    <td style=\"text-align: left;\"><strong>Status:</strong> running</td>\n    <td style=\"text-align: left;\"><strong>Using processes:</strong> True</td>\n</tr>\n\n            \n        </table>\n\n        <details>\n            <summary style=\"margin-bottom: 20px;\">\n                <h3 style=\"display: inline;\">Scheduler Info</h3>\n            </summary>\n\n            <div style=\"\">\n    <div>\n        <div style=\"width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;\"> </div>\n        <div style=\"margin-left: 48px;\">\n            <h3 style=\"margin-bottom: 0px;\">Scheduler</h3>\n            <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Scheduler-cf6f3f27-7937-48d0-8dd2-0e1c1557163d</p>\n            <table style=\"width: 100%; text-align: left;\">\n                <tr>\n                    <td style=\"text-align: left;\">\n                        <strong>Comm:</strong> tcp://127.0.0.1:40521\n                    </td>\n                    <td style=\"text-align: left;\">\n                        <strong>Workers:</strong> 0 \n                    </td>\n                </tr>\n                <tr>\n                    <td style=\"text-align: left;\">\n                        <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n                    </td>\n                    <td style=\"text-align: left;\">\n                        <strong>Total threads:</strong> 0\n                    </td>\n                </tr>\n                <tr>\n                    <td style=\"text-align: left;\">\n                        <strong>Started:</strong> Just now\n                    </td>\n                    <td style=\"text-align: left;\">\n                        <strong>Total memory:</strong> 0 B\n                    </td>\n                </tr>\n            </table>\n        </div>\n    </div>\n\n    <details style=\"margin-left: 48px;\">\n        <summary style=\"margin-bottom: 20px;\">\n            <h3 style=\"display: inline;\">Workers</h3>\n        </summary>\n\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 0</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:42011\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:36749/status\" target=\"_blank\">http://127.0.0.1:36749/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:44731\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-_ht3n7zk\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 1</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:36857\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:44751/status\" target=\"_blank\">http://127.0.0.1:44751/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:42167\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-xs9burpe\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 2</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:38561\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:33071/status\" target=\"_blank\">http://127.0.0.1:33071/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:36537\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-l29gg3iu\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 3</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:37115\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:45417/status\" target=\"_blank\">http://127.0.0.1:45417/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:41209\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-6nqyhjex\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n\n    </details>\n</div>\n\n        </details>\n    </div>\n</div>\n            </details>\n        \n\n    </div>\n</div>","content_type":"text/html"}}}],"key":"wag4h2LVMb"}],"key":"G2SGG6swE9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"☝️ Click the Dashboard link above.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AEj1eQeD1X"}],"key":"dbnLB6k0Qj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"👈 Or click the “Search” 🔍 button in the dask-labextension dashboard.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vz50iSfiGl"}],"key":"fp59OfsJdE"}],"key":"fP54g8rljJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If no arguments are specified in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u0iWBfobVV"},{"type":"inlineCode","value":"LocalCluster","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fSGcTnynrR"},{"type":"text","value":" it will automatically detect the number of CPU cores your system has and the amount of memory and create workers to appropriately fill that.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YLrXwjtJ73"}],"key":"TJpQZWTAde"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CAxbUalgx1"},{"type":"inlineCode","value":"LocalCluster","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aRcasg6rIm"},{"type":"text","value":" will use the full resources of the current JupyterLab session.  For example, if you used BinderHub, it will use the number of CPUs selected.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"riwgn8TAAr"}],"key":"nodM0jOQDr"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DX4CxyFNZt"},{"type":"inlineCode","value":"LocalCluster()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QAqLqn0cDN"},{"type":"text","value":" takes a lot of optional arguments, allowing you to configure the number of processes/threads, memory limits and other settings.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XGWCMsNA9u"}],"key":"E7dWGYCP1P"}],"key":"KZGoPkHYsV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can also find your cluster dashboard link using :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vLakO8zRfG"}],"key":"WLpS54ffyI"}],"key":"YQGFNUbWy0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cluster.dashboard_link","key":"UfCAWLOFdG"},{"type":"output","id":"4q1ARLh4tn9iyObQbvkqz","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"'http://127.0.0.1:8787/status'","content_type":"text/plain"}}}],"key":"VQTzzFUN1t"}],"key":"sPifOQXaJc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# -- dask array using the default\nxd = da.random.normal(10, 0.1, size=(30_000, 30_000), chunks=(3000, 3000))\nyd = xd.mean(axis=0)\nyd.compute()","key":"ktEDOKMrPc"},{"type":"output","id":"7biXhABUzJBDlIqf3tPEm","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 1.03 s, sys: 159 ms, total: 1.19 s\nWall time: 18.7 s\n"},{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"array([ 9.99996864,  9.99955829, 10.00080801, ...,  9.99987736,\n        9.99980998, 10.00002461], shape=(30000,))","content_type":"text/plain"}}}],"key":"qUKeCwEG9k"}],"key":"FQa1zSjLIZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Always remember to close your local Dask cluster:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mXYzun2I9z"}],"key":"nen69bw2bn"}],"key":"JfUaHszZC2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"client.shutdown()","key":"BD1cLgJpOZ"},{"type":"output","id":"5m69p8X5DA8uV0BKeyoOr","data":[{"output_type":"stream","name":"stderr","text":"2025-06-23 01:52:35,191 - distributed.worker - ERROR - Failed to communicate with scheduler during heartbeat.\nTraceback (most recent call last):\n  File \"/home/runner/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/distributed/comm/tcp.py\", line 226, in read\n    frames_nosplit_nbytes_bin = await stream.read_bytes(fmt_size)\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\ntornado.iostream.StreamClosedError: Stream is closed\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/runner/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/distributed/worker.py\", line 1267, in heartbeat\n    response = await retry_operation(\n               ^^^^^^^^^^^^^^^^^^^^^^\n    ...<14 lines>...\n    )\n    ^\n  File \"/home/runner/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/distributed/utils_comm.py\", line 416, in retry_operation\n    return await retry(\n           ^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/home/runner/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/distributed/utils_comm.py\", line 395, in retry\n    return await coro()\n           ^^^^^^^^^^^^\n  File \"/home/runner/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/distributed/core.py\", line 1259, in send_recv_from_rpc\n    return await send_recv(comm=comm, op=key, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/distributed/core.py\", line 1018, in send_recv\n    response = await comm.read(deserializers=deserializers)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/distributed/comm/tcp.py\", line 237, in read\n    convert_stream_closed_error(self, e)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^\n  File \"/home/runner/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/distributed/comm/tcp.py\", line 137, in convert_stream_closed_error\n    raise CommClosedError(f\"in {obj}: {exc}\") from exc\ndistributed.comm.core.CommClosedError: in <TCP (closed) ConnectionPool.heartbeat_worker local=tcp://127.0.0.1:51970 remote=tcp://127.0.0.1:40521>: Stream is closed\n"}],"key":"hxPIgTDxnP"}],"key":"QlT0xV4O1y"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dask Distributed (Cluster Managers)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lSBzbTcusr"}],"identifier":"dask-distributed-cluster-managers","label":"Dask Distributed (Cluster Managers)","html_id":"dask-distributed-cluster-managers","implicit":true,"key":"fXg9wVcsmm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"So far we have talked about running a job on a local machine.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GpVcnryf60"}],"key":"f60N2QarQ2"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Dask can be deployed on distributed infrastructure, such as a an HPC system or a cloud computing system.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"scB0IbSkga"}],"key":"WwbVP85Uxr"},{"type":"image","style":{"verticalAlign":"middle","margin":"30px 0px"},"url":"/dask-cookbook/build/5bb4678f8c7e666155eecf57b9320e34.svg","alt":"High level collections are used to generate task graphs which can be executed by schedulers on a single machine or a cluster.","key":"qgVvcH7PRz","urlSource":"https://docs.dask.org/en/stable/_images/dask-cluster-manager.svg"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Image credit: Dask Contributors","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HgcCxlwezq"}],"key":"jwmB9Qa4Gw"}],"key":"Vuz7aYzsf8"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Dask Cluster Managers have different names corresponding to different computing environments. Some examples are ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"fquevvk1dd"},{"type":"inlineCode","value":"dask-jobqueue","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CSMGpVsixK"},{"type":"text","value":" for your HPC systems (including ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RnJbAuuc9N"},{"type":"inlineCode","value":"PBSCluster","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QZuqzebJ7L"},{"type":"text","value":") or Kubernetes Cluster for machines on the Cloud.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"i7WvW5rpQA"}],"key":"l06vuwd4EX"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The NCAR tutorial series includes an in-depth exploration and practical use cases of Dask on HPC systems and best practices for Dask on HPC. For the complete set of NCAR tutorial materials, please refer to the main NCAR tutorial content available ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LISQ6Z4CNc"},{"type":"link","url":"https://ncar.github.io/dask-tutorial/README.html","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tiBFUGQSHu"}],"urlSource":"https://ncar.github.io/dask-tutorial/README.html","key":"L7KRWpe5HU"},{"type":"text","value":".","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"AJptlNSOHk"}],"key":"ks5FYcWIsb"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"For more information visit the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"gWPmSE4k6a"},{"type":"link","url":"https://docs.dask.org/en/stable/deploying.html","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Dask Docs","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"B5ROHcYhe6"}],"urlSource":"https://docs.dask.org/en/stable/deploying.html","key":"QTtiNfeUg5"},{"type":"text","value":".","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mOc436P1E4"}],"key":"LyxegfSPEX"}],"key":"ZdESpe3oju"}],"key":"jNvHQZRbRJ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Dask DataFrame","url":"/notebooks/dask-dataframe","group":"Introductions to Dask"},"next":{"title":"Parallelizing Xarray with Dask","url":"/notebooks/dask-xarray","group":"Dask and Xarray"}}},"domain":"http://localhost:3000"}