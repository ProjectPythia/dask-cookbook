{"version":2,"kind":"Notebook","sha256":"2bd7ef110d55ac498f81fcee8e1d87e7a2cd488ceba44d80e1ec84cd75d40f58","slug":"notebooks.dask-dataframe","location":"/notebooks/02-dask-dataframe.ipynb","dependencies":[],"frontmatter":{"title":"Dask DataFrame","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Negin Sobhani","given":"Negin","family":"Sobhani"},"name":"Negin Sobhani","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Brian Vanderwende","given":"Brian","family":"Vanderwende"},"name":"Brian Vanderwende","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Deepak Cherian","given":"Deepak","family":"Cherian"},"name":"Deepak Cherian","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Ben Kirk","given":"Ben","family":"Kirk"},"name":"Ben Kirk","id":"contributors-myst-generated-uid-3"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/dask-cookbook","copyright":"2024","affiliations":[{"id":"University at Albany (State University of New York)","name":"University at Albany (State University of New York)"},{"id":"UCAR/NCAR","name":"UCAR/NCAR"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/dask-cookbook/blob/HEAD/notebooks/02-dask-dataframe.ipynb","thumbnail":"/dask-cookbook/_preview/24/build/efb0893141695015b5a57e9702d22b2e.svg","exports":[{"format":"ipynb","filename":"02-dask-dataframe.ipynb","url":"/dask-cookbook/_preview/24/build/02-dask-dataframe-5b57afc843aa3a2e746101429a585f2d.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/dask-cookbook/_preview/24/build/efb0893141695015b5a57e9702d22b2e.svg","alt":"Dask logo","key":"rT0IYBeJuj","urlSource":"https://docs.dask.org/en/stable/_images/dask_horizontal.svg"}],"key":"zaBsUMGn7B"},{"type":"heading","depth":1,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Dask DataFrame","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mCduOnwKE1"}],"identifier":"dask-dataframe","label":"Dask DataFrame","html_id":"dask-dataframe","implicit":true,"key":"oHVkkdOOLu"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In this tutorial, you learn:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ZYwgwJ1mrQ"}],"identifier":"in-this-tutorial-you-learn","label":"In this tutorial, you learn:","html_id":"in-this-tutorial-you-learn","implicit":true,"key":"EOxjU8nnbx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Basic concepts and features of Dask DataFrames","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yMumnh0nJj"}],"key":"wFzIQF8iX0"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Applications of Dask DataFrames","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kJtLDnWfaU"}],"key":"JkyeeT6JRk"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Interacting with Dask DataFrames","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"XNFchHnx9h"}],"key":"UF1fqTH9hf"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Built-in operations with Dask DataFrames","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"vRSondmzA4"}],"key":"b4eAKhuCkc"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Dask DataFrames Best Practices","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"yZ2k6rMZPj"}],"key":"dJK4sBWA8w"}],"key":"zEyJvvLvYZ"},{"type":"heading","depth":3,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Related Documentation","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"SEfdmFS8e7"}],"identifier":"related-documentation","label":"Related Documentation","html_id":"related-documentation","implicit":true,"key":"NEjxUKG104"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"link","url":"https://docs.dask.org/en/stable/dataframe.html","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Dask DataFrame documentation","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Kr6QZGe1Sk"}],"urlSource":"https://docs.dask.org/en/stable/dataframe.html","key":"gzvY4k3GEA"}],"key":"FrHs48hVFV"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"link","url":"https://docs.dask.org/en/stable/dataframe-api.html","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Dask DataFrame API","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"fcU7G9J7V2"}],"urlSource":"https://docs.dask.org/en/stable/dataframe-api.html","key":"eG18bysJph"}],"key":"P7VD5tA1cX"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"link","url":"https://examples.dask.org/dataframe.html","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Dask DataFrame examples","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Pyhvr1g47l"}],"urlSource":"https://examples.dask.org/dataframe.html","key":"W0Gxb8eQ7C"}],"key":"MSeKFkzRqR"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"link","url":"https://pandas.pydata.org/pandas-docs/stable/","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"pandas documentation","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"qfcDJzq7ao"}],"urlSource":"https://pandas.pydata.org/pandas-docs/stable/","key":"ibhFWF33qY"}],"key":"W6I5cpaKYo"}],"key":"rgKnGnEUci"},{"type":"heading","depth":3,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"vo3ESjugQw"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"mBny1EJBYR"},{"type":"table","position":{"start":{"line":25,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"YmjgiHpJrB"}],"key":"XUuDoBmP1s"},{"type":"tableCell","header":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Bm1ma2MHor"}],"key":"Fdsjt5MdPA"},{"type":"tableCell","header":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"C2KTbd44s4"}],"key":"gaKTtgRUKo"}],"key":"SW63OdXYNN"},{"type":"tableRow","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"link","url":"https://pandas.pydata.org/docs/user_guide/10min.html","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Familiarity with Pandas DataFrame","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"FAiPUSA2eO"}],"urlSource":"https://pandas.pydata.org/docs/user_guide/10min.html","key":"uRt06svwYr"}],"key":"Vo7b3Txs81"},{"type":"tableCell","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"mfP9JYHE9j"}],"key":"pyClmDMAtr"},{"type":"tableCell","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[],"key":"DPu44hdq4c"}],"key":"GGPn5XMjr8"},{"type":"tableRow","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"link","url":"https://pandas.pydata.org/docs/user_guide/10min.html","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Dask Overview","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"DSIyVxXvTI"}],"urlSource":"https://pandas.pydata.org/docs/user_guide/10min.html","key":"JUKM7FXi9u"}],"key":"DmbPqJQgeT"},{"type":"tableCell","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"XKYO8oIbFp"}],"key":"YQwCrNVwty"},{"type":"tableCell","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[],"key":"UwYmHt2eGz"}],"key":"hdtwHWQvPp"}],"key":"jIxttBXdXn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"strong","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"AYONpKbwcd"}],"key":"a9790KXDJO"},{"type":"text","value":": 40 minutes","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"pMLELjUbvM"}],"key":"Ne5hzPRqlJ"}],"key":"Rep3WnXqfu"},{"type":"thematicBreak","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"VQfJRHyoac"},{"type":"heading","depth":2,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"kkMmkZfbt5"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"ykT7IgaKYQ"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"image","url":"/dask-cookbook/_preview/24/build/b82c470bd299758cae1ef1bfd8655169.svg","alt":"Dask DataFrame is composed of pandas DataFrames","key":"LjsX5oZ8rM","urlSource":"https://docs.dask.org/en/stable/_images/dask-dataframe.svg"}],"key":"jlfRZKkAyz"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Image credit: Dask Contributors","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"EJhL4uqhod"}],"key":"tt6FaG5CAV"}],"key":"JscF9pREpi"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"pandas is a very popular tool for working with ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"MZfS7dpO9v"},{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"tabular datasets","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"KGRq32sNim"}],"key":"m7EMFm6zpY"},{"type":"text","value":", but the dataset needs to ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"MdSVWJYh46"},{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"fit into the memory","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"zbisTZU5Td"}],"key":"oAZgAKRWzP"},{"type":"text","value":".","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"PTqE9EGLhf"}],"key":"zkhhX0J8iR"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"pandas operates best with smaller datasets, and if you have a large dataset, you’ll receive an out of memory error using pandas. A general rule of thumb for pandas is:","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"HAwxnr7x1Z"}],"key":"LqxzcjkfiL"},{"type":"blockquote","position":{"start":{"line":46,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"definitionList","position":{"start":{"line":46,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"definitionTerm","position":{"start":{"line":46,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"“Have 5 to 10 times as much RAM as the size of your dataset”","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"dOshwN6F52"}],"key":"POinL8CuGs"},{"type":"definitionDescription","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Wes McKinney (2017) in ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"tqPf4sieX2"},{"type":"link","url":"https://wesmckinney.com/blog/apache-arrow-pandas-internals/","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"10 things I hate about pandas","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"RhnbM7kyMz"}],"urlSource":"https://wesmckinney.com/blog/apache-arrow-pandas-internals/","key":"dE64NMaqSn"}],"key":"FpoIJDsmIT"}],"key":"UHsFRb6j9q"}],"key":"X4P5baBGwK"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"But Dask DataFrame can be used to solve pandas performance issues with larger-than-memory datasets.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"DgphAOgI1e"}],"key":"HwAQVaxhPx"},{"type":"heading","depth":3,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"What is Dask DataFrame?","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"h2dtXsShlb"}],"identifier":"what-is-dask-dataframe","label":"What is Dask DataFrame?","html_id":"what-is-dask-dataframe","implicit":true,"key":"oNFxGI7LQs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":56,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"strong","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"A Dask DataFrame is a parallel DataFrame composed of smaller pandas DataFrames (also known as ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"lMS6lWKhsr"},{"type":"emphasis","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"partitions","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"n3M6FO6o7E"}],"key":"fColFp0CaZ"},{"type":"text","value":").","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"DcvtLsd1Fg"}],"key":"UEWVNB4odw"}],"key":"vPlfJdcM6A"}],"key":"TAYZQKqe7G"},{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Dask Dataframes look and feel like the pandas DataFrames on the surface.","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"YEt6hEnhGQ"}],"key":"jpuNkIgvZo"}],"key":"Is8AB1dz2x"},{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Dask DataFrames partition the data into manageable ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"yeppVlGBHU"},{"type":"strong","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"partitions","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"wm9gIJzQBn"}],"key":"hwjVztU2XU"},{"type":"text","value":" that can be processed in parallel and across multiple cores or computers.","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"XZhxP01BUO"}],"key":"XCMGMJbT6N"}],"key":"QJFUsMCmDu"},{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Similar to Dask Arrays, Dask DataFrames are lazy!","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"gwtTuDq5NF"}],"key":"IrPb9YCW06"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Unlike pandas, operations on Dask DataFrames are not computed until you explicitly request them (e.g. by calling ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"j7pbtQx3Cl"},{"type":"inlineCode","value":".compute","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"OJ9TGZZFMk"},{"type":"text","value":").","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"wWf8SX4X7C"}],"key":"OXHj0fUG1c"}],"key":"Dy6V9wkibQ"}],"key":"KpxC5Mb3u5"}],"key":"AMWbIU8vwp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When to use Dask DataFrame and when to avoid it?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"POH1oy2mih"}],"identifier":"when-to-use-dask-dataframe-and-when-to-avoid-it","label":"When to use Dask DataFrame and when to avoid it?","html_id":"when-to-use-dask-dataframe-and-when-to-avoid-it","implicit":true,"key":"SilOd1Lq2y"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Dask DataFrames are used in situations where pandas ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kZrysL9w6Q"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"fails","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QKq6zz5VfS"}],"key":"UD5mmvSBk3"},{"type":"text","value":" or has ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sSTVNPJQvl"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"poor performance due to data size","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gdiCvOLUfY"}],"key":"tZbZSklCAj"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oFx1F2Gs0t"}],"key":"GFVFZdgZE0"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Dask DataFrame is a good choice when doing ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GHzRqCtmUj"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"parallalizeable computations","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xZc6WFzVvL"}],"key":"gBbdT2LeHe"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pp7BqppK1k"},{"type":"break","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yi7SKSoIGZ"},{"type":"text","value":"Some examples are:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aGRyscMNe2"}],"key":"WPYkH3ChLC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Element-wise operations such as ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IzOt9IDnE7"},{"type":"inlineCode","value":"df.x + df.y","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uGdWqz29mz"}],"key":"Kvq2xnrgG3"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Row-wise filtering such as ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"luS4Fbpr7l"},{"type":"inlineCode","value":"df[df.x>0]","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Yq8GBsGf5t"}],"key":"QXmX7qFYMv"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Common aggregations such as ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ldMRX9Dyic"},{"type":"inlineCode","value":"df.x.max()","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"pJpxAbjmj9"}],"key":"cxV3lcVnvr"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Dropping duplicates such as ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"s0FsDyCC5g"},{"type":"inlineCode","value":"df.x.drop_duplicate()","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"mTHZ4ccSWj"}],"key":"X5DWLGFUHE"}],"key":"WcpqIs4pGp"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"However, Dask is not great for operations that requires shuffling or re-indexing.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"i9SDZRKUc0"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"bjPv7S2Xlp"},{"type":"text","value":"Some examples are:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"r8W7HCjrxh"}],"key":"iQlpRkdlNq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Set index: ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"urwlQo6uZx"},{"type":"inlineCode","value":"df.set_index(df.x)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"W2YdBUAClM"}],"key":"DojFOe8PFa"}],"key":"ePrJxeIy4a"},{"type":"div","class":"alert alert-block alert-warning","children":[{"type":"strong","children":[{"type":"text","value":"WARNING:","key":"K0H56rFSQc"}],"key":"uLrU8dFAXT"},{"type":"text","value":" Although, Dask DataFrame has a very similar interface to the pandas DataFrame (as we will see in this tutorial), it does NOT include some of the pandas interface yet.","key":"BOavQCjo3e"},{"type":"paragraph","children":[{"type":"text","value":"See the ","key":"CxLbJycmVH"},{"type":"link","url":"https://docs.dask.org/en/stable/dataframe-api.html","children":[{"type":"text","value":"Dask DataFrame API documentation","key":"VrNp5zZaLr"}],"urlSource":"https://docs.dask.org/en/stable/dataframe-api.html","key":"aKhP9tuTQ8"},{"type":"text","value":" for a compehnsive list of available functions.","key":"pVKLyMKUM0"}],"key":"t68iXhKKdL"}],"key":"NpbkkXzBbe"},{"type":"thematicBreak","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"qkZMdNhJdM"}],"key":"JEVQKCBihC"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Tutorial Dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sqp3LkFgBT"}],"identifier":"tutorial-dataset","label":"Tutorial Dataset","html_id":"tutorial-dataset","implicit":true,"key":"Zxfs8yoquK"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In this tutorial, we are going to use the NOAA Global Historical Climatology Network Daily (GHCN-D) dataset.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pmLqkHlDq0"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VKAjp79rTd"},{"type":"text","value":"GHCN-D is a public available dataset that includes daily climate records from +100,000 surface observations around the world.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"X8o5IKCC4F"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"s5Tx1oWTXC"},{"type":"text","value":"This is an example of a real dataset that is used by NCAR scientists for their research. GHCN-D raw dataset for all stations is available through ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rUlOpVEKsw"},{"type":"link","url":"https://www.ncdc.noaa.gov/cdo-web/search?datasetid=GHCND","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"NOAA Climate Data Online","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hiFZo0l3Du"}],"urlSource":"https://www.ncdc.noaa.gov/cdo-web/search?datasetid=GHCND","key":"gNBgJ0Ue8A"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sMkrfiBUN6"}],"key":"Zo7rP88mSW"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"To learn more about GHCNd dataset, please visit:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"y1NLAwSPU0"}],"key":"AK7gt8cGTX"}],"key":"MNhHPFruSo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://journals.ametsoc.org/view/journals/atot/29/7/jtech-d-11-00103_1.xml","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GHCNd Journal Paper","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bDiVKstqtQ"}],"urlSource":"https://journals.ametsoc.org/view/journals/atot/29/7/jtech-d-11-00103_1.xml","key":"zKfcMU2Uq5"}],"key":"VMmVqVmWoA"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"link","url":"https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"GHCNd Official Website","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"slf7CQfOyX"}],"urlSource":"https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily","key":"BM9hbkOg5K"}],"key":"AJ2Doou8v5"}],"key":"rA69eqsXAP"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Download the data","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QVzupfjNnL"}],"identifier":"download-the-data","label":"Download the data","html_id":"download-the-data","implicit":true,"key":"XIFHdjLc6B"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"For this example, we are going to look through a subset of data from the GHCN-D dataset.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"bulKcjaZDM"}],"key":"HJtHZwTGr5"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"First, we look at the daily observations from Denver International Airport, next we are going to look through selected stations in the US.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Y5GeDIw1JM"}],"key":"O10RqjdNdR"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The access the preprocessed dataset for this tutorial, please run the following script:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"HwYeFvgRcV"}],"key":"Rf4Oy00vaT"}],"visibility":"show","key":"vo7W953pxP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"!./get_data.sh","key":"ATObRPmxCF"},{"type":"output","id":"xYwr3sAglh4bf1QetKZd8","data":[{"output_type":"stream","name":"stdout","text":"Downloading https://docs.google.com/uc?export=download&id=14doSRn8hT14QYtjZz28GKv14JgdIsbFF\r\n"},{"output_type":"stream","name":"stdout","text":"tar (child): data.tar.gz: Cannot open: No such file or directory\r\ntar (child): Error is not recoverable: exiting now\r\ntar: Child returned status 2\r\ntar: Error is not recoverable: exiting now\r\nrm: cannot remove 'data.tar.gz': No such file or directory\r\nDownloading https://docs.google.com/uc?export=download&id=15rCwQUxxpH6angDhpXzlvbe1nGetYHrf\r\n"},{"output_type":"stream","name":"stdout","text":"USC00057936.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00058204.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00058429.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00059243.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00068138.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00080211.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00084731.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00088824.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00098703.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00100010.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00100470.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00105275.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00106152.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00107264.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00108137.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00110338.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00112140.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00112193.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00112348.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00112483.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00113335.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00114108.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00114442.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00114823.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00115079.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00115326.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00115712.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00115768.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00115833.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00115901.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00115943.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USC00116446.csv\r\n"},{"output_type":"stream","name":"stdout","text":"USW00003017.csv\r\n"},{"output_type":"stream","name":"stdout","text":"Downloading https://docs.google.com/uc?export=download&id=1Tbuom1KMCwHjy7-eexEQcOXSr51i6mae\r\n"},{"output_type":"stream","name":"stdout","text":"\r\ngzip: stdin: not in gzip format\r\ntar: Child returned status 1\r\ntar: Error is not recoverable: exiting now\r\n"}],"key":"lnr3b1LG7T"}],"key":"xaoFAMWBPu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This script should save the preprocessed GHCN-D data in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"srGPFmNmLt"},{"type":"inlineCode","value":"../data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OGYDhwpDJ7"},{"type":"text","value":" path.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DGKghjSliW"}],"key":"KDUDVEUgH3"}],"key":"WJySsqEGri"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"otgYbMyKnU"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Pandas DataFrame Basics","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FgNR4WweLt"}],"identifier":"pandas-dataframe-basics","label":"Pandas DataFrame Basics","html_id":"pandas-dataframe-basics","implicit":true,"key":"czzEVtro1e"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s start with an example using pandas DataFrame.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZwlsoWryju"}],"key":"SwWCuQ765H"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"First, let’s read in the comma-seperated GHCN-D dataset for one station at ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AcW8cdVwiW"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Denver International Airport (DIA), CO","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cC8a9lTWO9"}],"key":"dtX4s32zfC"},{"type":"text","value":" (site ID : ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"klcgFSIljc"},{"type":"inlineCode","value":"USW00003017","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RLCO0LGPRU"},{"type":"text","value":").","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HCQzCOKQDt"}],"key":"TgVmj15LKa"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To see the list of all available GHCN-D sites and their coordinates and IDs, please see ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mYhlv97eIt"},{"type":"link","url":"https://www.ncei.noaa.gov/pub/data/ghcn/daily/ghcnd-stations.txt","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"this link","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"N9Muw3xG4M"}],"urlSource":"https://www.ncei.noaa.gov/pub/data/ghcn/daily/ghcnd-stations.txt","key":"NJ2zrsasGa"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UAwN4oUw5U"}],"key":"wNgNbCmfFg"}],"key":"wYDlqerNNW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport pandas as pd\n\n# DIA ghcnd id\nsite = 'USW00003017'\ndata_dir = '../data/'\n\n\ndf = pd.read_csv(os.path.join(data_dir, site+'.csv'), parse_dates=['DATE'], index_col=0)","key":"YLPUqTAmtM"},{"type":"output","id":"MKpmMsDx-w113W3tAuoZc","data":[],"key":"lNFyDOngrQ"}],"key":"fERLZ3TUjB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Display the top five rows of the dataframe\ndf.head()","key":"FWabE99xWv"},{"type":"output","id":"EK4KzPlu5vBcl43BgGSTU","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"                     ID  YEAR  MONTH  DAY   TMAX TMAX_FLAGS   TMIN TMIN_FLAGS  \\\nDATE                                                                            \n1994-07-20  USW00003017  1994      7   20  316.0        XXS  150.0        XXS   \n1994-07-23  USW00003017  1994      7   23  355.0        XXS  166.0        XXS   \n1994-07-24  USW00003017  1994      7   24  333.0        XXS  155.0        XXS   \n1994-07-25  USW00003017  1994      7   25  327.0        XXS  172.0        XXS   \n1994-07-26  USW00003017  1994      7   26  327.0        XXS  155.0        XXS   \n\n            PRCP PRCP_FLAGS  ...  RHMN_FLAGS RHMX  RHMX_FLAGS PSUN  \\\nDATE                         ...                                     \n1994-07-20  20.0        DXS  ...         XXX  NaN         XXX  NaN   \n1994-07-23   0.0        DXS  ...         XXX  NaN         XXX  NaN   \n1994-07-24  81.0        DXS  ...         XXX  NaN         XXX  NaN   \n1994-07-25   0.0        DXS  ...         XXX  NaN         XXX  NaN   \n1994-07-26   0.0        DXS  ...         XXX  NaN         XXX  NaN   \n\n            PSUN_FLAGS LATITUDE  LONGITUDE ELEVATION  STATE         STATION  \nDATE                                                                         \n1994-07-20         XXX  39.8467  -104.6561    1647.1     CO  DENVER INTL AP  \n1994-07-23         XXX  39.8467  -104.6561    1647.1     CO  DENVER INTL AP  \n1994-07-24         XXX  39.8467  -104.6561    1647.1     CO  DENVER INTL AP  \n1994-07-25         XXX  39.8467  -104.6561    1647.1     CO  DENVER INTL AP  \n1994-07-26         XXX  39.8467  -104.6561    1647.1     CO  DENVER INTL AP  \n\n[5 rows x 99 columns]","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ID</th>\n      <th>YEAR</th>\n      <th>MONTH</th>\n      <th>DAY</th>\n      <th>TMAX</th>\n      <th>TMAX_FLAGS</th>\n      <th>TMIN</th>\n      <th>TMIN_FLAGS</th>\n      <th>PRCP</th>\n      <th>PRCP_FLAGS</th>\n      <th>...</th>\n      <th>RHMN_FLAGS</th>\n      <th>RHMX</th>\n      <th>RHMX_FLAGS</th>\n      <th>PSUN</th>\n      <th>PSUN_FLAGS</th>\n      <th>LATITUDE</th>\n      <th>LONGITUDE</th>\n      <th>ELEVATION</th>\n      <th>STATE</th>\n      <th>STATION</th>\n    </tr>\n    <tr>\n      <th>DATE</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1994-07-20</th>\n      <td>USW00003017</td>\n      <td>1994</td>\n      <td>7</td>\n      <td>20</td>\n      <td>316.0</td>\n      <td>XXS</td>\n      <td>150.0</td>\n      <td>XXS</td>\n      <td>20.0</td>\n      <td>DXS</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>39.8467</td>\n      <td>-104.6561</td>\n      <td>1647.1</td>\n      <td>CO</td>\n      <td>DENVER INTL AP</td>\n    </tr>\n    <tr>\n      <th>1994-07-23</th>\n      <td>USW00003017</td>\n      <td>1994</td>\n      <td>7</td>\n      <td>23</td>\n      <td>355.0</td>\n      <td>XXS</td>\n      <td>166.0</td>\n      <td>XXS</td>\n      <td>0.0</td>\n      <td>DXS</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>39.8467</td>\n      <td>-104.6561</td>\n      <td>1647.1</td>\n      <td>CO</td>\n      <td>DENVER INTL AP</td>\n    </tr>\n    <tr>\n      <th>1994-07-24</th>\n      <td>USW00003017</td>\n      <td>1994</td>\n      <td>7</td>\n      <td>24</td>\n      <td>333.0</td>\n      <td>XXS</td>\n      <td>155.0</td>\n      <td>XXS</td>\n      <td>81.0</td>\n      <td>DXS</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>39.8467</td>\n      <td>-104.6561</td>\n      <td>1647.1</td>\n      <td>CO</td>\n      <td>DENVER INTL AP</td>\n    </tr>\n    <tr>\n      <th>1994-07-25</th>\n      <td>USW00003017</td>\n      <td>1994</td>\n      <td>7</td>\n      <td>25</td>\n      <td>327.0</td>\n      <td>XXS</td>\n      <td>172.0</td>\n      <td>XXS</td>\n      <td>0.0</td>\n      <td>DXS</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>39.8467</td>\n      <td>-104.6561</td>\n      <td>1647.1</td>\n      <td>CO</td>\n      <td>DENVER INTL AP</td>\n    </tr>\n    <tr>\n      <th>1994-07-26</th>\n      <td>USW00003017</td>\n      <td>1994</td>\n      <td>7</td>\n      <td>26</td>\n      <td>327.0</td>\n      <td>XXS</td>\n      <td>155.0</td>\n      <td>XXS</td>\n      <td>0.0</td>\n      <td>DXS</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>39.8467</td>\n      <td>-104.6561</td>\n      <td>1647.1</td>\n      <td>CO</td>\n      <td>DENVER INTL AP</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 99 columns</p>\n</div>","content_type":"text/html"}}}],"key":"cJtqP6yLAx"}],"key":"qhwHoD1Fsk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xRS0MUEavo"}],"key":"xwLtVBys6O"},{"type":"text","value":" What variables are available?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VfoZcY0qzH"}],"key":"SiSexdslRJ"}],"key":"m4QGnyD2Ej"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df.columns","key":"OcE3Y3wKst"},{"type":"output","id":"fdWILFOhJRV7rs-nj-bdg","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"Index(['ID', 'YEAR', 'MONTH', 'DAY', 'TMAX', 'TMAX_FLAGS', 'TMIN',\n       'TMIN_FLAGS', 'PRCP', 'PRCP_FLAGS', 'TAVG', 'TAVG_FLAGS', 'SNOW',\n       'SNOW_FLAGS', 'SNWD', 'SNWD_FLAGS', 'AWND', 'AWND_FLAGS', 'FMTM',\n       'FMTM_FLAGS', 'PGTM', 'PGTM_FLAGS', 'WDF2', 'WDF2_FLAGS', 'WDF5',\n       'WDF5_FLAGS', 'WSF2', 'WSF2_FLAGS', 'WSF5', 'WSF5_FLAGS', 'WT01',\n       'WT01_FLAGS', 'WT02', 'WT02_FLAGS', 'WT08', 'WT08_FLAGS', 'WT16',\n       'WT16_FLAGS', 'WT17', 'WT17_FLAGS', 'WT18', 'WT18_FLAGS', 'WT03',\n       'WT03_FLAGS', 'WT05', 'WT05_FLAGS', 'WT19', 'WT19_FLAGS', 'WT10',\n       'WT10_FLAGS', 'WT09', 'WT09_FLAGS', 'WT06', 'WT06_FLAGS', 'WT07',\n       'WT07_FLAGS', 'WT11', 'WT11_FLAGS', 'WT13', 'WT13_FLAGS', 'WT21',\n       'WT21_FLAGS', 'WT14', 'WT14_FLAGS', 'WT15', 'WT15_FLAGS', 'WT22',\n       'WT22_FLAGS', 'WT04', 'WT04_FLAGS', 'WV03', 'WV03_FLAGS', 'TSUN',\n       'TSUN_FLAGS', 'WV01', 'WV01_FLAGS', 'WESD', 'WESD_FLAGS', 'ADPT',\n       'ADPT_FLAGS', 'ASLP', 'ASLP_FLAGS', 'ASTP', 'ASTP_FLAGS', 'AWBT',\n       'AWBT_FLAGS', 'RHAV', 'RHAV_FLAGS', 'RHMN', 'RHMN_FLAGS', 'RHMX',\n       'RHMX_FLAGS', 'PSUN', 'PSUN_FLAGS', 'LATITUDE', 'LONGITUDE',\n       'ELEVATION', 'STATE', 'STATION'],\n      dtype='object')","content_type":"text/plain"}}}],"key":"p4cBGwd1l6"}],"key":"TBwyUfmozq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The description and units of the dataset is available ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B3geQP19zv"},{"type":"link","url":"https://www.ncei.noaa.gov/pub/data/ghcn/daily/readme.txt","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FjjdJG4qQg"}],"urlSource":"https://www.ncei.noaa.gov/pub/data/ghcn/daily/readme.txt","key":"LxMoC31x2R"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U3XpqcoGkC"}],"key":"KEnn7opzHA"}],"key":"ki4XbNU2wQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Operations on pandas DataFrame","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xU8iCkXnnu"}],"identifier":"operations-on-pandas-dataframe","label":"Operations on pandas DataFrame","html_id":"operations-on-pandas-dataframe","implicit":true,"key":"gePrGSndZK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"pandas DataFrames has several features that give us flexibility to do different calculations and analysis on our dataset. Let’s check some out:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Vci1FcoOfm"}],"key":"oBHDZgBCkR"},{"type":"heading","depth":4,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Simple Analysis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Fsz4rnO1Iz"}],"identifier":"simple-analysis","label":"Simple Analysis","html_id":"simple-analysis","implicit":true,"key":"e91A1nbBnR"}],"key":"Pu3WUoNRYD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For example:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y2URrf6E6x"}],"key":"k8x1pG9zi5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"When was the coldest day at this station during December of last year?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"x9goVfJWzu"}],"key":"iVxAzMA6lf"}],"key":"JjWWTCm5At"}],"key":"owlPSBXS5z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# use python slicing notation inside .loc \n# use idxmin() to find the index of minimum valus\ndf.loc['2022-12-01':'2022-12-31'].TMIN.idxmin()","key":"UYsrwHmpkS"},{"type":"output","id":"bOV8H8Kv727kzl87dSlzc","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Timestamp('2022-12-22 00:00:00')","content_type":"text/plain"}}}],"key":"GLv4C48N8X"}],"key":"XAL9oyzrY4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Here we easily plot the prior data using matplotlib from pandas\n# -- .loc for value based indexing\ndf.loc['2022-12-01':'2022-12-31'].SNWD.plot(ylabel= 'Daily Average Snow Depth [mm]')","key":"u7rjysBLF1"},{"type":"output","id":"Va78TDeztLEGItcECspvB","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"<Axes: xlabel='DATE', ylabel='Daily Average Snow Depth [mm]'>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3df08f8e4c5b4720681d97c30db47639","path":"/dask-cookbook/_preview/24/build/3df08f8e4c5b4720681d97c30db47639.png"}}}],"key":"VPQadMUYTQ"}],"key":"h4yYYJ7QtM"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"How many snow days do we have each year at this station?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I42dIsLAmJ"}],"key":"wCzZ2yDA7E"}],"key":"EsTbdwKBTh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Pandas groupby is used for grouping the data according to the categories.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XTlvoebtsz"}],"key":"dkLLyHjsrG"}],"key":"Vd8KomC1qH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 1- First select days with snow > 0\n# 2- Create a \"groupby object\" based on the selected columns\n# 3- use .size() to compute the size of each group\n# 4- sort the values descending \n\n# we count days where SNOW>0, and sort them and show top 5 years:\ndf[df['SNOW']>0].groupby('YEAR').size().sort_values(ascending=False).head()\n","key":"iWHuK0UxBk"},{"type":"output","id":"FsxPLnahrp4aNXuKaNzzO","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"YEAR\n2015    36\n2019    34\n2014    32\n2008    32\n2007    31\ndtype: int64","content_type":"text/plain"}}}],"key":"aCpjE2SEmh"}],"key":"FY8BfNJjEK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Or for a more complex analysis:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S0LpShUgKx"}],"key":"xhfxIQ4qDW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For example, we have heard that this could be Denver’s first January in 13 years with no 60-degree days.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ztzZpinsEV"}],"key":"eKwa7S90zB"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"image","url":"/dask-cookbook/_preview/24/build/576ee6c7ccc2f9c50f73ce145e8f7592.png","alt":"News article showing that this January is abnormally warm","key":"NSlUgGzWol","urlSource":"https://raw.githubusercontent.com/ProjectPythia/dask-cookbook/main/notebooks/images/denver.png"}],"key":"ArMLGbYS89"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Below, we show all days with high temperature above 60°F (155.5°C/10) since 2010:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"k304IpDbzw"}],"key":"RaJ7gUa1yN"}],"key":"jj3w5MsVm5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df[(df['MONTH']==1) & (df['YEAR']>=2010) & (df['TMAX']>155.5)].groupby(['YEAR']).size()","key":"qxv2AB9eLD"},{"type":"output","id":"QyqpbDfkUq6tfwrk2x57X","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"YEAR\n2011    1\n2012    6\n2013    4\n2014    3\n2015    6\n2016    1\n2017    4\n2018    5\n2019    3\n2020    2\n2021    2\n2022    3\ndtype: int64","content_type":"text/plain"}}}],"key":"SnoA9bBRGF"}],"key":"xwIz6jGk1Z"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is great! But how big is this dataset for one station?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NsncQtPRLM"}],"key":"WbHDz9Horc"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"First, let’s check the file size:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NTY6MX3mcy"}],"key":"iJvN9rnOLf"}],"key":"NN8gImGEkm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"!ls -lh ../data/USW00003017.csv","key":"q7mAQwjiBz"},{"type":"output","id":"o6Fzl5Lh7B8WYwffCpsHI","data":[{"output_type":"stream","name":"stdout","text":"-rw-r--r-- 1 runner docker 3.6M Feb  5  2023 ../data/USW00003017.csv\r\n"}],"key":"eHha0lCOA8"}],"key":"KoElpYbRHO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Similar to the previous tutorial, we can use the following function to find the size of a variable on memory.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gxd0tvdYOd"}],"key":"KDWJQF4x4c"}],"key":"ClEJcoZuBT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define function to display variable size in MB\nimport sys\ndef var_size(in_var):\n    result = sys.getsizeof(in_var) / 1e6\n    print(f\"Size of variable: {result:.2f} MB\")","key":"I6G5Sy8UOq"},{"type":"output","id":"IuLlSonMMSyOKyNZUwKBE","data":[],"key":"OoE9ldbneT"}],"key":"ECvEYRwF9S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"var_size(df)","key":"X5uCqvkqMH"},{"type":"output","id":"-H6dyy4EBP3QxCOOsCz33","data":[{"output_type":"stream","name":"stdout","text":"Size of variable: 29.39 MB\n"}],"key":"PVhjKKUDL1"}],"key":"xBh01Ta1Xk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Remember, the above rule?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J1JpJqmN64"}],"key":"B1LiTweiJn"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"definitionList","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"definitionTerm","position":{"start":{"line":3,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"“Have 5 to 10 times as much RAM as the size of your dataset”","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gogwXmzWD4"}],"key":"onQ7t3HYDS"},{"type":"definitionDescription","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Wes McKinney (2017) in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PD2QfMMdJQ"},{"type":"link","url":"https://wesmckinney.com/blog/apache-arrow-pandas-internals/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"10 things I hate about pandas","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Yol2LqavCV"}],"urlSource":"https://wesmckinney.com/blog/apache-arrow-pandas-internals/","key":"Gi94kHJDP7"}],"key":"lZbMn7WK6C"}],"key":"qGrNpRS4hD"}],"key":"HrbE6zKkg0"}],"key":"O0me0C0Owm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So far, we read in and analyzed data for one station. We have a total of +118,000 stations over the world and +4500 stations in Colorado alone!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"li3pby9Bd2"}],"key":"JwWMA5KDig"}],"key":"rPcqzRNbHf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"What if we want to look at the larger dataset?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n5NlMgpF1H"}],"key":"J4dcxgeFhC"}],"key":"B6jZlmCWQc"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Scaling up to a larger dataset","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZIG6MxqVtg"}],"identifier":"scaling-up-to-a-larger-dataset","label":"Scaling up to a larger dataset","html_id":"scaling-up-to-a-larger-dataset","implicit":true,"key":"pF6FqfuglQ"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Let’s start by reading data from selected stations. The downloaded data for this example includes the climatology observations from 66 selected sites in Colorado.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NNYVTzQ9WG"}],"key":"cRKf9JIJ12"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Pandas can concatenate data to load data spread across multiple files:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gSNjUsHloE"}],"key":"jB7PRdwVTv"}],"key":"MPRkTKiSvG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"!du -csh ../data/*.csv |tail -n1","key":"GFAQcBLGlC"},{"type":"output","id":"nuSEJ8cmzATUOGb9IBqEf","data":[{"output_type":"stream","name":"stdout","text":"286M\ttotal\r\n"}],"key":"xIbYcuyOCX"}],"key":"IawvOHhsc7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using a for loop with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LaAYePQpTY"},{"type":"inlineCode","value":"pandas.concat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xz8S3A7ElN"},{"type":"text","value":", we can read multiple files at the same time:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fmf8dws99a"}],"key":"YMDq8mg6Vq"}],"key":"k2zWfUDUCC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nimport glob\nco_sites = glob.glob(os.path.join(data_dir, '*.csv'))\ndf = pd.concat(pd.read_csv(f, index_col=0, parse_dates=['DATE']) for f in co_sites)","key":"gA1d4JTGX8"},{"type":"output","id":"oQtUmmqwk0iE4eZ9FVPtd","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 6.45 s, sys: 1.34 s, total: 7.79 s\nWall time: 16.2 s\n"}],"key":"kuMEYqjM8g"}],"key":"TQzrJoxgiv"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"How many stations have we read in?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c3ClVDruFn"}],"key":"P6Ee97qaIh"}],"key":"Bz9xDKGF6d"}],"key":"QqIEAbn65G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print (\"Concatenated data for\", len(df.ID.unique()), \"unique sites.\")","key":"MABAPZmbm4"},{"type":"output","id":"Q2uPFqZZLssqPBtW8ssoF","data":[{"output_type":"stream","name":"stdout","text":"Concatenated data for 33 unique sites.\n"}],"key":"emus0PDcTo"}],"key":"aMSZy6Vvh7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now that we concatenated the data for all sites in one DataFrame, we can do similar analysis on it:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ppHcPIIo5D"}],"key":"KRNWY5kyJ0"}],"key":"hMaDfhAuxd"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Which site has recorded the most snow days in a year?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JUGfv0Wti5"}],"key":"HcIuGCAWgU"}],"key":"bLi6AXlM5V"}],"key":"I4GUd7tcHx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# ~90s on 4GB RAM\nsnowy_days = df[df['SNOW']>0].groupby(['ID','YEAR']).size()\n\nprint ('This site has the highest number of snow days in a year : ')\nsnowy_days.agg(['idxmax','max'])","key":"OWT4zE4YCF"},{"type":"output","id":"ZG0nAzFItuvqkUAYxcBFU","data":[{"output_type":"stream","name":"stdout","text":"This site has the highest number of snow days in a year : \nCPU times: user 244 ms, sys: 2.39 ms, total: 246 ms\nWall time: 319 ms\n"},{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"idxmax    (USC00114823, 2009)\nmax                        97\ndtype: object","content_type":"text/plain"}}}],"key":"jPgU6gycr5"}],"key":"jjFZFueaBu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Excersise:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l0OXpjw7Ju"}],"key":"o4XrBj6Jq5"},{"type":"text","value":" Which Colorado site has recorded the most snow days in 2023?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hdd9cOO8yo"}],"key":"qMjl8zbglm"}],"key":"NIch79FzlJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dask allows us to conceptualize all of these files as a single dataframe!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xiKbqQQtYH"}],"key":"I85xTLDHnd"}],"key":"SZIoMwgMId"}],"key":"tCFGzY8Tfx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Let's do a little cleanup\ndel df, snowy_days","key":"u87JiLxSAP"},{"type":"output","id":"RwjyFm300LlpNhqEMc_C1","data":[],"key":"wlAYDfyIi2"}],"key":"JOepe3E9co"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Computations on Dask DataFrame","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PZItLfE0sJ"}],"identifier":"computations-on-dask-dataframe","label":"Computations on Dask DataFrame","html_id":"computations-on-dask-dataframe","implicit":true,"key":"LwRrwL1o7Q"}],"key":"hXxdNJtEOq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a “LocalCluster” Client with Dask","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lx6L6lzSwc"}],"identifier":"create-a-localcluster-client-with-dask","label":"Create a “LocalCluster” Client with Dask","html_id":"create-a-localcluster-client-with-dask","implicit":true,"key":"dq3hStXHER"}],"key":"iqAyw5vudq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from dask.distributed import Client, LocalCluster\n\ncluster = LocalCluster()\nclient = Client(cluster)\nclient","key":"ferBQT3UaB"},{"type":"output","id":"pihBthUX3x7AdCelON6-J","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/distributed/node.py:187: UserWarning: Port 8787 is already in use.\nPerhaps you already have a cluster running?\nHosting the HTTP server on port 42585 instead\n  warnings.warn(\n"},{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"<Client: 'tcp://127.0.0.1:38791' processes=4 threads=4, memory=15.62 GiB>","content_type":"text/plain"},"text/html":{"content":"<div>\n    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\"> </div>\n    <div style=\"margin-left: 48px;\">\n        <h3 style=\"margin-bottom: 0px;\">Client</h3>\n        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Client-f5347cbb-5066-11f0-8eed-7ced8d19e43e</p>\n        <table style=\"width: 100%; text-align: left;\">\n\n        <tr>\n        \n            <td style=\"text-align: left;\"><strong>Connection method:</strong> Cluster object</td>\n            <td style=\"text-align: left;\"><strong>Cluster type:</strong> distributed.LocalCluster</td>\n        \n        </tr>\n\n        \n            <tr>\n                <td style=\"text-align: left;\">\n                    <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:42585/status\" target=\"_blank\">http://127.0.0.1:42585/status</a>\n                </td>\n                <td style=\"text-align: left;\"></td>\n            </tr>\n        \n\n        </table>\n\n        \n            <button style=\"margin-bottom: 12px;\" data-commandlinker-command=\"dask:populate-and-launch-layout\" data-commandlinker-args='{\"url\": \"http://127.0.0.1:42585/status\" }'>\n                Launch dashboard in JupyterLab\n            </button>\n        \n\n        \n            <details>\n            <summary style=\"margin-bottom: 20px;\"><h3 style=\"display: inline;\">Cluster Info</h3></summary>\n            <div class=\"jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output\">\n    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\">\n    </div>\n    <div style=\"margin-left: 48px;\">\n        <h3 style=\"margin-bottom: 0px; margin-top: 0px;\">LocalCluster</h3>\n        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">00a9c39b</p>\n        <table style=\"width: 100%; text-align: left;\">\n            <tr>\n                <td style=\"text-align: left;\">\n                    <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:42585/status\" target=\"_blank\">http://127.0.0.1:42585/status</a>\n                </td>\n                <td style=\"text-align: left;\">\n                    <strong>Workers:</strong> 4\n                </td>\n            </tr>\n            <tr>\n                <td style=\"text-align: left;\">\n                    <strong>Total threads:</strong> 4\n                </td>\n                <td style=\"text-align: left;\">\n                    <strong>Total memory:</strong> 15.62 GiB\n                </td>\n            </tr>\n            \n            <tr>\n    <td style=\"text-align: left;\"><strong>Status:</strong> running</td>\n    <td style=\"text-align: left;\"><strong>Using processes:</strong> True</td>\n</tr>\n\n            \n        </table>\n\n        <details>\n            <summary style=\"margin-bottom: 20px;\">\n                <h3 style=\"display: inline;\">Scheduler Info</h3>\n            </summary>\n\n            <div style=\"\">\n    <div>\n        <div style=\"width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;\"> </div>\n        <div style=\"margin-left: 48px;\">\n            <h3 style=\"margin-bottom: 0px;\">Scheduler</h3>\n            <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Scheduler-321e7ffa-895f-429a-b772-ee4b9873b291</p>\n            <table style=\"width: 100%; text-align: left;\">\n                <tr>\n                    <td style=\"text-align: left;\">\n                        <strong>Comm:</strong> tcp://127.0.0.1:38791\n                    </td>\n                    <td style=\"text-align: left;\">\n                        <strong>Workers:</strong> 0 \n                    </td>\n                </tr>\n                <tr>\n                    <td style=\"text-align: left;\">\n                        <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:42585/status\" target=\"_blank\">http://127.0.0.1:42585/status</a>\n                    </td>\n                    <td style=\"text-align: left;\">\n                        <strong>Total threads:</strong> 0\n                    </td>\n                </tr>\n                <tr>\n                    <td style=\"text-align: left;\">\n                        <strong>Started:</strong> Just now\n                    </td>\n                    <td style=\"text-align: left;\">\n                        <strong>Total memory:</strong> 0 B\n                    </td>\n                </tr>\n            </table>\n        </div>\n    </div>\n\n    <details style=\"margin-left: 48px;\">\n        <summary style=\"margin-bottom: 20px;\">\n            <h3 style=\"display: inline;\">Workers</h3>\n        </summary>\n\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 0</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:35363\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:44351/status\" target=\"_blank\">http://127.0.0.1:44351/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:34783\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-yhdk84eo\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 1</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:35665\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:36667/status\" target=\"_blank\">http://127.0.0.1:36667/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:42759\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-8178dk8j\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 2</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:42603\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:34969/status\" target=\"_blank\">http://127.0.0.1:34969/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:38433\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-egp6gq1z\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 3</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:41433\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:34903/status\" target=\"_blank\">http://127.0.0.1:34903/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:34965\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-v5czrkld\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n\n    </details>\n</div>\n\n        </details>\n    </div>\n</div>\n            </details>\n        \n\n    </div>\n</div>","content_type":"text/html"}}}],"key":"hknySHhoh1"}],"key":"SA0ljh5BXX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"☝️ Click the Dashboard link above.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SzkT89EG49"}],"key":"o3HXwqM6gn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"👈 Or click the “Search” 🔍 button in the dask-labextension dashboard.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DGhhUMEWM6"}],"key":"PKyejSOQSO"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Dask DataFrame ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"skgqjBver2"},{"type":"inlineCode","value":"read_csv","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"a6893s7zPN"},{"type":"text","value":" to read multiple files","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NzVbHLp00U"}],"identifier":"dask-dataframe-read-csv-to-read-multiple-files","label":"Dask DataFrame read_csv to read multiple files","html_id":"dask-dataframe-read-csv-to-read-multiple-files","implicit":true,"key":"NmDcAc8noR"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"dask.dataframe.read_csv","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"K9mhDcfc2a"},{"type":"text","value":" function can be used in conjunction with ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UzT1YFekWj"},{"type":"inlineCode","value":"glob","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SJkHbLJ4I8"},{"type":"text","value":" to read multiple csv files at the same time.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SOj4f5x0pB"}],"key":"l1f6UOFLAA"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Remember we can read one file with ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kTTzVakNEb"},{"type":"inlineCode","value":"pandas.read_csv","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"AeeS07iDcA"},{"type":"text","value":". For reading multiple files with pandas, we have to concatenate them with ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MEaMWwWYw6"},{"type":"inlineCode","value":"pd.concatenate","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PNMFX1VciD"},{"type":"text","value":". However, we can read many files at once just using ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Hx7KBDicTr"},{"type":"inlineCode","value":"dask.dataframe.read_csv","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"LoS2vbg5L8"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zPFkCK9b0U"}],"key":"ZZmhXeaFMA"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Overall, Dask is designed to perform I/O in parallel and is more performant than pandas for operations with multiple files or large files.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UExZJuPnr8"}],"key":"gTduZM1o0n"}],"key":"pnlhDl6EAF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nimport dask\nimport dask.dataframe as dd\n\nddf = dd.read_csv(co_sites, parse_dates=['DATE'])\nddf","key":"aMC4pF8p76"},{"type":"output","id":"9VIu-23Do3i-jBVzDRlpn","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 801 ms, sys: 107 ms, total: 908 ms\nWall time: 1.84 s\n"},{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"Dask DataFrame Structure:\n                          DATE      ID   YEAR  MONTH    DAY     TMAX TMAX_FLAGS     TMIN TMIN_FLAGS     PRCP PRCP_FLAGS     SNOW SNOW_FLAGS     WT16 WT16_FLAGS     WT18 WT18_FLAGS     SNWD SNWD_FLAGS     WT01 WT01_FLAGS     WT03 WT03_FLAGS     WT04 WT04_FLAGS     WT05 WT05_FLAGS     EVAP EVAP_FLAGS     TOBS TOBS_FLAGS     DAPR DAPR_FLAGS     MDPR MDPR_FLAGS     DASF DASF_FLAGS     MDSF MDSF_FLAGS     WT11 WT11_FLAGS     WT07 WT07_FLAGS     WT09 WT09_FLAGS     WT08 WT08_FLAGS     WT14 WT14_FLAGS     WT06 WT06_FLAGS     WESD WESD_FLAGS LATITUDE LONGITUDE ELEVATION   STATE STATION\nnpartitions=33                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \n                datetime64[ns]  string  int64  int64  int64  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64     string  float64   float64   float64  string  string\n                           ...     ...    ...    ...    ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...       ...       ...     ...     ...\n...                        ...     ...    ...    ...    ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...       ...       ...     ...     ...\n                           ...     ...    ...    ...    ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...       ...       ...     ...     ...\n                           ...     ...    ...    ...    ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...        ...      ...       ...       ...     ...     ...\nDask Name: to_string_dtype, 2 expressions\nExpr=ArrowStringConversion(frame=FromMapProjectable(6491613))","content_type":"text/plain"},"text/html":{"content":"<div><strong>Dask DataFrame Structure:</strong></div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>DATE</th>\n      <th>ID</th>\n      <th>YEAR</th>\n      <th>MONTH</th>\n      <th>DAY</th>\n      <th>TMAX</th>\n      <th>TMAX_FLAGS</th>\n      <th>TMIN</th>\n      <th>TMIN_FLAGS</th>\n      <th>PRCP</th>\n      <th>PRCP_FLAGS</th>\n      <th>SNOW</th>\n      <th>SNOW_FLAGS</th>\n      <th>WT16</th>\n      <th>WT16_FLAGS</th>\n      <th>WT18</th>\n      <th>WT18_FLAGS</th>\n      <th>SNWD</th>\n      <th>SNWD_FLAGS</th>\n      <th>WT01</th>\n      <th>WT01_FLAGS</th>\n      <th>WT03</th>\n      <th>WT03_FLAGS</th>\n      <th>WT04</th>\n      <th>WT04_FLAGS</th>\n      <th>WT05</th>\n      <th>WT05_FLAGS</th>\n      <th>EVAP</th>\n      <th>EVAP_FLAGS</th>\n      <th>TOBS</th>\n      <th>TOBS_FLAGS</th>\n      <th>DAPR</th>\n      <th>DAPR_FLAGS</th>\n      <th>MDPR</th>\n      <th>MDPR_FLAGS</th>\n      <th>DASF</th>\n      <th>DASF_FLAGS</th>\n      <th>MDSF</th>\n      <th>MDSF_FLAGS</th>\n      <th>WT11</th>\n      <th>WT11_FLAGS</th>\n      <th>WT07</th>\n      <th>WT07_FLAGS</th>\n      <th>WT09</th>\n      <th>WT09_FLAGS</th>\n      <th>WT08</th>\n      <th>WT08_FLAGS</th>\n      <th>WT14</th>\n      <th>WT14_FLAGS</th>\n      <th>WT06</th>\n      <th>WT06_FLAGS</th>\n      <th>WESD</th>\n      <th>WESD_FLAGS</th>\n      <th>LATITUDE</th>\n      <th>LONGITUDE</th>\n      <th>ELEVATION</th>\n      <th>STATE</th>\n      <th>STATION</th>\n    </tr>\n    <tr>\n      <th>npartitions=33</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th></th>\n      <td>datetime64[ns]</td>\n      <td>string</td>\n      <td>int64</td>\n      <td>int64</td>\n      <td>int64</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>float64</td>\n      <td>float64</td>\n      <td>float64</td>\n      <td>string</td>\n      <td>string</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n  </tbody>\n</table>\n<div>Dask Name: to_string_dtype, 2 expressions</div>","content_type":"text/html"}}}],"key":"dHHhN7q2pB"}],"key":"Te5bBv0rHG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ddf.TMAX.mean()","key":"Z3deMrvvLz"},{"type":"output","id":"UlIIq9E_tSzR-5apw8Q5e","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"<dask_expr.expr.Scalar: expr=ArrowStringConversion(frame=FromMapProjectable(6491613))['TMAX'].mean(), dtype=float64>","content_type":"text/plain"}}}],"key":"sPTF9zjG51"}],"key":"a2qc6SMfOA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notice that the representation of the DataFrame object contains no data just headers and datatypes.  Why?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yxrdQLpWzU"}],"key":"w1DVrRypjc"}],"key":"s4moujIRK3"},{"type":"heading","depth":4,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Lazy Evaluation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TjZqQsBpRe"}],"identifier":"lazy-evaluation","label":"Lazy Evaluation","html_id":"lazy-evaluation","implicit":true,"key":"NkfHseyy2d"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Similar to Dask Arrays, Dask DataFrames are lazy. Here the data has not yet been read into the dataframe yet (a.k.a. lazy evaluation).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qnWCIvxA4P"},{"type":"break","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JL1D8dmoz2"},{"type":"text","value":"Dask just construct the task graph of the computation but it will “evaluate” them only when necessary.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Nvs6vBbuLZ"}],"key":"CrbiWSd9m7"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"So how does Dask know the name and dtype of each column?","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"D7DGsPP8Hd"}],"key":"KJzE4yTEYv"}],"key":"v7Y1RYp7jE"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Dask has just read the start of the first file and infers the column names and dtypes.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MKTFOuWjmC"}],"key":"IADiHuT0Pc"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Unlike ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"A8CABgv6Pd"},{"type":"inlineCode","value":"pandas.read_csv","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"cWAR0XBkwB"},{"type":"text","value":" that reads in all files before inferring data types, ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ZX5qag6SoL"},{"type":"inlineCode","value":"dask.dataframe.read_csv","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"rSx2pG9SAo"},{"type":"text","value":" only reads in a sample from the beginning of the file (or first file if using a glob). The column names and dtypes are then enforced when reading the specific partitions (","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"s0MLQcl4Pm"},{"type":"emphasis","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Dask can make mistakes on these inferences if there is missing or misleading data in the early rows","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"X78GpasR1Y"}],"key":"nBGopNwZ83"},{"type":"text","value":").","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"cM9b0zecmD"}],"key":"kLG7IPcMoO"}],"key":"BF3JCJS19g"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s take a look at the start of our dataframe:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a55yRIjOiu"}],"key":"zlR8UfaR3K"}],"key":"zyO5cLMZOp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ddf.head()","key":"AnnTvckIhi"},{"type":"output","id":"IIvHds4z0fiJM6r44RFnn","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"        DATE           ID  YEAR  MONTH  DAY   TMAX TMAX_FLAGS   TMIN  \\\n0 1893-01-01  USC00110338  1893      1    1  -11.0        XX6  -50.0   \n1 1893-01-02  USC00110338  1893      1    2  -44.0        XX6 -139.0   \n2 1893-01-03  USC00110338  1893      1    3 -139.0        XX6 -250.0   \n3 1893-01-04  USC00110338  1893      1    4  -83.0        XX6 -144.0   \n4 1893-01-05  USC00110338  1893      1    5 -100.0        XX6 -178.0   \n\n  TMIN_FLAGS  PRCP  ... WT14_FLAGS  WT06 WT06_FLAGS  WESD WESD_FLAGS  \\\n0        XX6   0.0  ...        XXX   NaN        XXX   NaN        XXX   \n1        XX6   0.0  ...        XXX   NaN        XXX   NaN        XXX   \n2        XX6   0.0  ...        XXX   NaN        XXX   NaN        XXX   \n3        XX6  23.0  ...        XXX   NaN        XXX   NaN        XXX   \n4        XX6   0.0  ...        XXX   NaN        XXX   NaN        XXX   \n\n   LATITUDE LONGITUDE  ELEVATION STATE  STATION  \n0   41.7803  -88.3092      201.2    IL   AURORA  \n1   41.7803  -88.3092      201.2    IL   AURORA  \n2   41.7803  -88.3092      201.2    IL   AURORA  \n3   41.7803  -88.3092      201.2    IL   AURORA  \n4   41.7803  -88.3092      201.2    IL   AURORA  \n\n[5 rows x 58 columns]","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>DATE</th>\n      <th>ID</th>\n      <th>YEAR</th>\n      <th>MONTH</th>\n      <th>DAY</th>\n      <th>TMAX</th>\n      <th>TMAX_FLAGS</th>\n      <th>TMIN</th>\n      <th>TMIN_FLAGS</th>\n      <th>PRCP</th>\n      <th>...</th>\n      <th>WT14_FLAGS</th>\n      <th>WT06</th>\n      <th>WT06_FLAGS</th>\n      <th>WESD</th>\n      <th>WESD_FLAGS</th>\n      <th>LATITUDE</th>\n      <th>LONGITUDE</th>\n      <th>ELEVATION</th>\n      <th>STATE</th>\n      <th>STATION</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1893-01-01</td>\n      <td>USC00110338</td>\n      <td>1893</td>\n      <td>1</td>\n      <td>1</td>\n      <td>-11.0</td>\n      <td>XX6</td>\n      <td>-50.0</td>\n      <td>XX6</td>\n      <td>0.0</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>41.7803</td>\n      <td>-88.3092</td>\n      <td>201.2</td>\n      <td>IL</td>\n      <td>AURORA</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1893-01-02</td>\n      <td>USC00110338</td>\n      <td>1893</td>\n      <td>1</td>\n      <td>2</td>\n      <td>-44.0</td>\n      <td>XX6</td>\n      <td>-139.0</td>\n      <td>XX6</td>\n      <td>0.0</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>41.7803</td>\n      <td>-88.3092</td>\n      <td>201.2</td>\n      <td>IL</td>\n      <td>AURORA</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1893-01-03</td>\n      <td>USC00110338</td>\n      <td>1893</td>\n      <td>1</td>\n      <td>3</td>\n      <td>-139.0</td>\n      <td>XX6</td>\n      <td>-250.0</td>\n      <td>XX6</td>\n      <td>0.0</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>41.7803</td>\n      <td>-88.3092</td>\n      <td>201.2</td>\n      <td>IL</td>\n      <td>AURORA</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1893-01-04</td>\n      <td>USC00110338</td>\n      <td>1893</td>\n      <td>1</td>\n      <td>4</td>\n      <td>-83.0</td>\n      <td>XX6</td>\n      <td>-144.0</td>\n      <td>XX6</td>\n      <td>23.0</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>41.7803</td>\n      <td>-88.3092</td>\n      <td>201.2</td>\n      <td>IL</td>\n      <td>AURORA</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1893-01-05</td>\n      <td>USC00110338</td>\n      <td>1893</td>\n      <td>1</td>\n      <td>5</td>\n      <td>-100.0</td>\n      <td>XX6</td>\n      <td>-178.0</td>\n      <td>XX6</td>\n      <td>0.0</td>\n      <td>...</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>NaN</td>\n      <td>XXX</td>\n      <td>41.7803</td>\n      <td>-88.3092</td>\n      <td>201.2</td>\n      <td>IL</td>\n      <td>AURORA</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 58 columns</p>\n</div>","content_type":"text/html"}}}],"key":"jpQ3kevvQv"}],"key":"WZDU1XvqKB"},{"type":"block","kind":"notebook-content","children":[{"type":"div","class":"alert alert-block alert-info","children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"NOTE:","key":"OcuK4XpuqP"}],"key":"BTyW9e6swM"},{"type":"text","value":" Whenever we operate on our dataframe we read through all of our CSV data so that we don’t fill up RAM. Dask will delete intermediate results (like the full pandas DataFrame for each file) as soon as possible. This enables you to handle larger than memory datasets but, repeated computations will have to load all of the data in each time.","key":"sWKt2oizsh"}],"key":"yBP6jKiWZD"}],"key":"HbnVOYLVsW"}],"key":"SrG7YMbAVG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Similar data manipulations as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TShjX4a5Rs"},{"type":"inlineCode","value":"pandas.dataframe","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s4uEhzbFUj"},{"type":"text","value":" can be done for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rYfdgAuKej"},{"type":"inlineCode","value":"dask.dataframes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XsMbAkhSIJ"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zEeNmCPgnW"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SWaFMUU5Cy"},{"type":"text","value":"For example, let’s find the highest number of snow days in Colorado:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FFsyev5slM"}],"key":"QxjoiW2rho"}],"key":"s8kFhh2Tmn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nprint ('This site has the highest number of snow days in a year : ')\nsnowy_days = ddf[ddf['SNOW']>0].groupby(['ID','YEAR']).size()\nsnowy_days.compute().agg(['idxmax','max'])","key":"uElJ78kY5i"},{"type":"output","id":"jwAw6UP_4w9B_wVgz98Le","data":[{"output_type":"stream","name":"stdout","text":"This site has the highest number of snow days in a year : \n"},{"output_type":"stream","name":"stdout","text":"CPU times: user 620 ms, sys: 88.6 ms, total: 708 ms\nWall time: 5.37 s\n"},{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"idxmax    (USC00114823, 2009)\nmax                        97\ndtype: object","content_type":"text/plain"}}}],"key":"RBU0aT584A"}],"key":"a3dKLdC5R2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Nice, but what did Dask do?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qHW5S0ivUE"}],"identifier":"nice-but-what-did-dask-do","label":"Nice, but what did Dask do?","html_id":"nice-but-what-did-dask-do","implicit":true,"key":"FoZOh8GOwq"}],"key":"XuiPHyCkar"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Requires ipywidgets\n\nsnowy_days.dask","key":"lwdqDH8qS5"},{"type":"output","id":"xKJ-7keDguSVtQcQGQKHb","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content_type":"text/plain","hash":"75dc5f2ace8a7d8fdcc9a3159b74af11","path":"/dask-cookbook/_preview/24/build/75dc5f2ace8a7d8fdcc9a3159b74af11.txt"}}}],"key":"UfWRbRRf0p"}],"key":"AnNcdrOa8H"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can also view the underlying task graph using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dPXWYfLTxL"},{"type":"inlineCode","value":".visualize()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VKB36qECOZ"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qzc82fedI8"}],"key":"JpL7ImGESt"}],"key":"wz8DhxRB7D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#graph is too large\nsnowy_days.visualize()","key":"B4e7IyI5gK"},{"type":"output","id":"xTiCkAHFFmUW7gzKgz2Eu","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 13.0.1 (20250616.1512)\n -->\n<!-- Pages: 1 -->\n<svg width=\"582pt\" height=\"404pt\"\n viewBox=\"0.00 0.00 582.00 404.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 400)\">\n<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-400 577.75,-400 577.75,4 -4,4\"/>\n<!-- &#45;4381479385856903565 -->\n<g id=\"node1\" class=\"node\">\n<title>&#45;4381479385856903565</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"232.75,-396 113.25,-396 113.25,-360 232.75,-360 232.75,-396\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"173\" y=\"-371\" font-family=\"Helvetica,sans-Serif\" font-size=\"20.00\">Size(Filter)</text>\n</g>\n<!-- &#45;1090793789410342831 -->\n<g id=\"node2\" class=\"node\">\n<title>&#45;1090793789410342831</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"346,-324 0,-324 0,-288 346,-288 346,-324\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"173\" y=\"-299\" font-family=\"Helvetica,sans-Serif\" font-size=\"20.00\">Filter(ArrowStringConversion, GT)</text>\n</g>\n<!-- &#45;1090793789410342831&#45;&gt;&#45;4381479385856903565 -->\n<g id=\"edge1\" class=\"edge\">\n<title>&#45;1090793789410342831&#45;&gt;&#45;4381479385856903565</title>\n<path fill=\"none\" stroke=\"black\" d=\"M173,-324.3C173,-331.59 173,-340.27 173,-348.46\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"169.5,-348.38 173,-358.38 176.5,-348.38 169.5,-348.38\"/>\n</g>\n<!-- &#45;7742456145572349401 -->\n<g id=\"node3\" class=\"node\">\n<title>&#45;7742456145572349401</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"385.12,-252 204.88,-252 204.88,-216 385.12,-216 385.12,-252\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"295\" y=\"-227\" font-family=\"Helvetica,sans-Serif\" font-size=\"20.00\">GT(Projection, 0)</text>\n</g>\n<!-- &#45;7742456145572349401&#45;&gt;&#45;1090793789410342831 -->\n<g id=\"edge3\" class=\"edge\">\n<title>&#45;7742456145572349401&#45;&gt;&#45;1090793789410342831</title>\n<path fill=\"none\" stroke=\"black\" d=\"M264.53,-252.48C248.84,-261.49 229.51,-272.58 212.67,-282.24\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"211.33,-278.97 204.4,-286.99 214.81,-285.05 211.33,-278.97\"/>\n</g>\n<!-- 1349672151626462994 -->\n<g id=\"node4\" class=\"node\">\n<title>1349672151626462994</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"573.75,-180 142.25,-180 142.25,-144 573.75,-144 573.75,-180\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"358\" y=\"-155\" font-family=\"Helvetica,sans-Serif\" font-size=\"20.00\">Projection(ArrowStringConversion, SNOW)</text>\n</g>\n<!-- 1349672151626462994&#45;&gt;&#45;7742456145572349401 -->\n<g id=\"edge4\" class=\"edge\">\n<title>1349672151626462994&#45;&gt;&#45;7742456145572349401</title>\n<path fill=\"none\" stroke=\"black\" d=\"M342.43,-180.3C335.03,-188.53 326.03,-198.52 317.88,-207.58\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"315.49,-205 311.41,-214.77 320.7,-209.68 315.49,-205\"/>\n</g>\n<!-- &#45;7543179715941142915 -->\n<g id=\"node5\" class=\"node\">\n<title>&#45;7543179715941142915</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"465.62,-108 6.38,-108 6.38,-72 465.62,-72 465.62,-108\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"236\" y=\"-83\" font-family=\"Helvetica,sans-Serif\" font-size=\"20.00\">ArrowStringConversion(FromMapProjectable)</text>\n</g>\n<!-- &#45;7543179715941142915&#45;&gt;&#45;1090793789410342831 -->\n<g id=\"edge2\" class=\"edge\">\n<title>&#45;7543179715941142915&#45;&gt;&#45;1090793789410342831</title>\n<path fill=\"none\" stroke=\"black\" d=\"M176.29,-108.42C159.35,-116.43 142.85,-127.86 133,-144 107.17,-186.34 134.18,-244.56 154.64,-278.14\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"151.59,-279.88 159.9,-286.45 157.51,-276.13 151.59,-279.88\"/>\n</g>\n<!-- &#45;7543179715941142915&#45;&gt;1349672151626462994 -->\n<g id=\"edge5\" class=\"edge\">\n<title>&#45;7543179715941142915&#45;&gt;1349672151626462994</title>\n<path fill=\"none\" stroke=\"black\" d=\"M266.47,-108.48C282.16,-117.49 301.49,-128.58 318.33,-138.24\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"316.19,-141.05 326.6,-142.99 319.67,-134.97 316.19,-141.05\"/>\n</g>\n<!-- 871126983739778943 -->\n<g id=\"node6\" class=\"node\">\n<title>871126983739778943</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"344.12,-36 127.88,-36 127.88,0 344.12,0 344.12,-36\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"236\" y=\"-11\" font-family=\"Helvetica,sans-Serif\" font-size=\"20.00\">FromMapProjectable</text>\n</g>\n<!-- 871126983739778943&#45;&gt;&#45;7543179715941142915 -->\n<g id=\"edge6\" class=\"edge\">\n<title>871126983739778943&#45;&gt;&#45;7543179715941142915</title>\n<path fill=\"none\" stroke=\"black\" d=\"M236,-36.3C236,-43.59 236,-52.27 236,-60.46\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"232.5,-60.38 236,-70.38 239.5,-60.38 232.5,-60.38\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7ffa70121e80>","content_type":"text/plain"}}}],"key":"mtTolQmCwg"}],"key":"duYZ8nCke9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OrHCi6I5YQ"},{"type":"inlineCode","value":".compute","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z3cirS4U2c"},{"type":"text","value":" wisely!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aTj1TruWwP"}],"identifier":"use-compute-wisely","label":"Use .compute wisely!","html_id":"use-compute-wisely","implicit":true,"key":"bcsOpxunet"},{"type":"heading","depth":4,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Share intermediate results","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rxcwg3PjrZ"}],"identifier":"share-intermediate-results","label":"Share intermediate results","html_id":"share-intermediate-results","implicit":true,"key":"KWQCV60KaU"}],"key":"jIh4Hq6QHi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For most operations, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C8v9V5kmJA"},{"type":"inlineCode","value":"dask.dataframe","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zYkVTIF5Qz"},{"type":"text","value":" hashes the arguments, allowing duplicate computations to be shared, and only computed once.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iTSCDKEu9i"}],"key":"WSSCfTwKR0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For example, let’s compute the mean and standard deviation for Maximum daily temperature of all snow days.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"krgTl7ibFW"}],"key":"EsDNMS813t"}],"key":"Z6G2ruvGhK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"snowy_days = ddf[ddf['SNOW']>0]\nmean_tmax = snowy_days.TMAX.mean()\nstd_tmax = snowy_days.TMAX.std()","key":"K77yqPoU32"},{"type":"output","id":"A52RNFjdKSlY-fpI82a9T","data":[],"key":"eaf7k25jlt"}],"key":"LScsbJ2G0A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nmean_tmax_result = mean_tmax.compute()\nstd_tmax_result = std_tmax.compute()","key":"FWUsll9nZe"},{"type":"output","id":"ZJ5rFkyxd9CP15EvCMcSE","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 762 ms, sys: 126 ms, total: 889 ms\nWall time: 9.3 s\n"}],"key":"dNQilaxK01"}],"key":"nAuQhy5Z6T"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"But if we pass both arguments in a single ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IXVIxqY63T"},{"type":"inlineCode","value":".compute","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PxMa25AqVU"},{"type":"text","value":", we can share the intermediate results:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xCcRRFa24f"}],"key":"ofhh980fsy"}],"key":"mvZa8DaUbX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nmean_tmax_result, std_tmax_result = dask.compute(mean_tmax, std_tmax)","key":"ESFK0E0FrH"},{"type":"output","id":"U2PuEY2peZQS8Y-mL_fyZ","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 407 ms, sys: 76.6 ms, total: 484 ms\nWall time: 5.2 s\n"}],"key":"bSaudddjQq"}],"key":"d8qsOl7j0P"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pteb5z7WTW"},{"type":"inlineCode","value":"dask.compute","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vm7Yjt1v1x"},{"type":"text","value":" only one allowed sharing intermediate results between TMAX mean and median calculations and improved total performance.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rvnvv32WpV"}],"key":"solFRdYdbP"}],"key":"FNStM35siG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mean_tmax.dask","key":"i01HnVDrdU"},{"type":"output","id":"eh51yKjrGIA-6lpNswKBK","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content_type":"text/plain","hash":"601a3daa4c3c3ab01af17534c5fa5c39","path":"/dask-cookbook/_preview/24/build/601a3daa4c3c3ab01af17534c5fa5c39.txt"}}}],"key":"j8axnCRjpm"}],"key":"I2hvyddd3V"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here some operations such as the calls to read the csv files, the filtering, and the grouping is exactly similar between both operations, so they can share intermediate results. Remember, Dask will delete intermediate results (like the full pandas DataFrame for each file) as soon as possible.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vi5jH52LNK"}],"key":"ag9CSP64Y0"}],"key":"C3C0eXjD3y"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":".persist","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"akaPU3sKnp"},{"type":"text","value":" or caching","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sX96shtaG6"}],"identifier":"id-persist-or-caching","label":".persist or caching","html_id":"id-persist-or-caching","implicit":true,"key":"XPwUncjFk7"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Sometimes you might want your computers to keep intermediate results in memory, if it fits in the memory.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"weZjsWGOhp"}],"key":"UTTJ5vqyUA"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tOCblXkQJS"},{"type":"inlineCode","value":".persist()","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"pMByhHHwuP"},{"type":"text","value":" method can be used to  “cache” data and tell Dask what results to keep around. You should only use ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bOAcvnCVrs"},{"type":"inlineCode","value":".persist()","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Kx5hwG0xQw"},{"type":"text","value":" with any data or computation that fits in memory.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"I2uu638VGr"}],"key":"Zk7GkRoNkP"}],"key":"e6IlEueMuz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For example, if we want to only do analysis on a subset of data (for example snow days at Boulder site):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RfHj60zlRJ"}],"key":"kOW9m8VA3Z"}],"key":"irQz12ToH3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"boulder_snow = ddf[(ddf['SNOW']>0)&(ddf['ID']=='USC00050848')]","key":"gWyWdAXgGd"},{"type":"output","id":"PPaHyM6UiqrWHc62Xz_lo","data":[],"key":"bQEK6GQYHp"}],"key":"hFOued1Wrj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\ntmax = boulder_snow.TMAX.mean().compute()\ntmin = boulder_snow.TMIN.mean().compute()\n\nprint (tmin, tmax)","key":"DfD1mCICgj"},{"type":"output","id":"Q0YNjxRcCs59zXa0TCB9Z","data":[{"output_type":"stream","name":"stdout","text":"nan nan\nCPU times: user 839 ms, sys: 118 ms, total: 957 ms\nWall time: 8.25 s\n"}],"key":"JBsli6lFH7"}],"key":"fAsppK1Pmu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"boulder_snow = ddf[(ddf['SNOW']>0)&(ddf['ID']=='USC00050848')].persist()","key":"esVdkmtiKA"},{"type":"output","id":"L6hSGtBw8upxhkDpG3-Xi","data":[],"key":"hDaFrrVFRf"}],"key":"eh1Y1kIH4s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\ntmax = boulder_snow.TMAX.mean().compute()\ntmin = boulder_snow.TMIN.mean().compute()\nprint (tmin, tmax)","key":"Muv9bhVPr9"},{"type":"output","id":"TWNkOo01ZFNBmCF4S9SNM","data":[{"output_type":"stream","name":"stdout","text":"nan nan\nCPU times: user 323 ms, sys: 47.3 ms, total: 370 ms\nWall time: 2.69 s\n"}],"key":"UqBPgrF75W"}],"key":"phigzRde7k"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see the analysis on this persisted data is much faster because we are not repeating the loading and selecting.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m773zfd6Ks"}],"key":"whZFRxCp9p"}],"key":"B0rvcNfCW1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dask DataFrames Best Practices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rop1BtpvPW"}],"identifier":"dask-dataframes-best-practices","label":"Dask DataFrames Best Practices","html_id":"dask-dataframes-best-practices","implicit":true,"key":"vi6rwlpRJo"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Use pandas (when you can)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xneCsqbOLU"}],"identifier":"use-pandas-when-you-can","label":"Use pandas (when you can)","html_id":"use-pandas-when-you-can","implicit":true,"key":"C5ZymKpXne"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"For data that fits into RAM, pandas can often be easier and more efficient to use than Dask DataFrame. However, Dask DataFrame is a powerful tool for larger-than-memory datasets.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"y2rjZ3dKFx"}],"key":"z000rQb6c3"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"When the data is still larger than memory, Dask DataFrame can be used to ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"N6sk530vcD"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"reduce","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tMzJLF12ib"}],"key":"OyprkEZWqn"},{"type":"text","value":" the larger datasets to a manageable level that pandas can handle. Next, use pandas at that point.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"h5YIY9JL0D"}],"key":"Lfa3h37GMc"},{"type":"heading","depth":3,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Avoid Full-Data Shuffling","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OKhhyJ95BF"}],"identifier":"avoid-full-data-shuffling","label":"Avoid Full-Data Shuffling","html_id":"avoid-full-data-shuffling","implicit":true,"key":"GSNmsGSmXn"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Some operations are more expensive to compute in a parallel setting than if they are in-memory on a single machine (for example, ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uu7OyKPkE3"},{"type":"inlineCode","value":"set_index","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tGKYW6eF60"},{"type":"text","value":" or ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Qot9ArTcJR"},{"type":"inlineCode","value":"merge","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nDXcvrW5LW"},{"type":"text","value":"). In particular, ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Hp897ZSwf1"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"shuffling","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hENayWdKJz"}],"key":"qEYhB06RKR"},{"type":"text","value":" operations that rearrange data can become very communication intensive.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JmTra0mRMj"}],"key":"OQR81flo8E"},{"type":"heading","depth":3,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"pandas performance tips","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Cl0ye9MH1g"}],"identifier":"pandas-performance-tips","label":"pandas performance tips","html_id":"pandas-performance-tips","implicit":true,"key":"thwulK9MdL"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"pandas performance tips such as using vectorized operations also apply to Dask DataFrames. See ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"dXEiCPq4ad"},{"type":"link","url":"https://github.com/TomAugspurger/effective-pandas/blob/master/modern_1_intro.ipynb","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Modern Pandas notebook","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"sVSjpbX4rO"}],"urlSource":"https://github.com/TomAugspurger/effective-pandas/blob/master/modern_1_intro.ipynb","data":{"kind":"file","org":"TomAugspurger","repo":"effective-pandas","reference":"master","file":"modern_1_intro.ipynb","raw":"https://raw.githubusercontent.com/TomAugspurger/effective-pandas/master/modern_1_intro.ipynb"},"internal":false,"protocol":"github","key":"dGzz0TkZhG"},{"type":"text","value":" for more tips on better performance with pandas.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"DzZ8CMbWEl"}],"key":"VEJsdP1Ttd"},{"type":"heading","depth":3,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Check Partition Size","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"flGPFkT6Xp"}],"identifier":"check-partition-size","label":"Check Partition Size","html_id":"check-partition-size","implicit":true,"key":"tJ2qCBwsbG"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Similar to chunks, partitions should be small enough that they fit in the memory, but large enough to avoid that the communication overhead.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"OE4jL2HyyB"}],"key":"HcF5tJvTQx"},{"type":"heading","depth":4,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"inlineCode","value":"blocksize","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ISUEsAZkAY"}],"identifier":"blocksize","label":"blocksize","html_id":"blocksize","implicit":true,"key":"k0CohqD5MY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"The number of partitions can be set using the ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"fOiRRyMpmN"},{"type":"inlineCode","value":"blocksize","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"rzgnmtXnPd"},{"type":"text","value":" argument.\nIf none is given, the number of partitions/blocksize is calculated depending on the available memory and the number of cores on a machine up to a max of 64 MB. As we increase the blocksize, the number of partitions (calculated by Dask) will decrease. This is especially important when reading one large csv file.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"zF3efnz4Rg"}],"key":"CoKYqS0kYM"}],"key":"Y3vmMDu9XZ"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"As a good rule of thumb, you should aim for partitions that have around 100MB of data each.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"r5Cl1ufZFE"}],"key":"o5LbUYam8x"}],"key":"mZzWfiOja2"},{"type":"heading","depth":3,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Smart use of ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"QALVAdcReh"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"zm3gLdWcUy"}],"identifier":"smart-use-of-compute","label":"Smart use of .compute()","html_id":"smart-use-of-compute","implicit":true,"key":"e1JfoJYqMM"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Try avoiding running ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"wumGrnuCJd"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"lIDU4t74Dn"},{"type":"text","value":" operation as long as possible. Dask works best when users avoid computation until results are needed. The ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ayWCJ8Ceox"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"kcTRF28djg"},{"type":"text","value":" command informs Dask to trigger computations on the Dask DataFrame.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Du1dhUfV9H"},{"type":"break","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"VTge7U86nx"},{"type":"text","value":"As shown in the above example, the intermediate results can also be shared by calling ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"e2DKfz4sxv"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"buUufJWJEG"},{"type":"text","value":" only once.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"VDHyM67kHU"}],"key":"t9EJy5BNlo"}],"key":"iX7Qhh2fNR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Close your local Dask Cluster","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MG0eRM9I4d"}],"identifier":"close-your-local-dask-cluster","label":"Close your local Dask Cluster","html_id":"close-your-local-dask-cluster","implicit":true,"key":"VtE9ECTllB"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"It is always a good practice to close the Dask cluster you created.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wUyK3Ml4lL"}],"key":"BD3LdUw8Fc"}],"key":"yy1FcVCKJa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"client.shutdown()","key":"kIQrpUpooZ"},{"type":"output","id":"dmLvBguGoAMj0RgoXr73r","data":[],"key":"pdNW63Mx7s"}],"key":"WPQnFWQoYG"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VXdzRmOmE7"}],"key":"MVOnOvidVq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D552p1sm9Z"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"vmxBHKDNtZ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this notebook, we have learned about:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XMVADtQyKm"}],"key":"TJ7Fo0EVFQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Dask DataFrame concept and component.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zQy8S7soSQ"}],"key":"I0h1sJnlzz"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"When to use and when to avoid Dask DataFrames?","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"XY4vIhzGAw"}],"key":"fEo4KJLRNG"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"How to use Dask DataFrame?","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VFH8fjMRvC"}],"key":"iM9U9Vck2y"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Some best practices around Dask DataFrames.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rZTk55KGr9"}],"key":"u3E2lOIlsF"}],"key":"dSWCMFZKmr"},{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"hsrNixZAGl"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"XPXZYiXStX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Reference","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"roqNJwNvS3"}],"key":"AiVVIf1jAc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"https://dask.org/","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Dask Docs","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"x8jYxdRZwl"}],"urlSource":"https://dask.org/","key":"LEqnYPzVkj"}],"key":"llPyNejIFL"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"https://examples.dask.org/","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Dask Examples","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Xx1pdWPMLP"}],"urlSource":"https://examples.dask.org/","key":"b9LM1L5zNl"}],"key":"SVC3AKJCso"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"link","url":"https://github.com/dask/dask/","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Dask Code","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"GK3582gFJn"}],"urlSource":"https://github.com/dask/dask/","error":true,"key":"fE2kvtcNQv"}],"key":"zl2VcPlBwi"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"link","url":"https://blog.dask.org/","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Dask Blog","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"IV7b8o050r"}],"urlSource":"https://blog.dask.org/","key":"XbicPmqHmb"}],"key":"KxZtTRdQbY"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"link","url":"https://pandas.pydata.org/docs/","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Pandas Docs","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"TTDYCq0D0e"}],"urlSource":"https://pandas.pydata.org/docs/","key":"RqEPKByU7d"}],"key":"LtjrQuigtI"}],"key":"qY6m7UGwje"}],"key":"EFV43TM6fs"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Ask for help","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"KjaDpeElmK"}],"key":"tYUJXc3gwf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"link","url":"http://stackoverflow.com/questions/tagged/dask","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"inlineCode","value":"dask","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"WdpddF3kVD"}],"urlSource":"http://stackoverflow.com/questions/tagged/dask","key":"mj9NRHmQHp"},{"type":"text","value":" tag on Stack Overflow, for usage questions","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"smLyGJuXJx"}],"key":"Vn66vEP2tb"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"link","url":"https://github.com/dask/dask/discussions","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"github discussions: dask","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"pqIrbT63xY"}],"urlSource":"https://github.com/dask/dask/discussions","error":true,"key":"feIYhABjp7"},{"type":"text","value":" for general, non-bug, discussion, and usage questions","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"cPsnuLVBFq"}],"key":"gTMM7DfhcR"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"link","url":"https://github.com/dask/dask/issues/new","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"github issues: dask","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"w02090rvgZ"}],"urlSource":"https://github.com/dask/dask/issues/new","error":true,"key":"I4jSspFCjS"},{"type":"text","value":" for bug reports and feature requests","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"gbCOzCgCAG"}],"key":"agDfqBZmsm"}],"key":"MXKFuOwY0p"}],"key":"LLHqSapZet"}],"key":"CqZBnCetae"}],"key":"n6wM7fLy1p"}],"key":"uQxznSLMyw"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Dask Array","url":"/notebooks/dask-array","group":"Introductions to Dask"},"next":{"title":"Dask Schedulers","url":"/notebooks/dask-cluster","group":"Dask Schedulers"}}},"domain":"http://localhost:3000"}