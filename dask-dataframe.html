<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Dask DataFrame - Dask Cookbook</title><meta property="og:title" content="Dask DataFrame - Dask Cookbook"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg"/><meta property="og:image" content="/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg"/><link rel="stylesheet" href="/dask-cookbook/build/_assets/app-SP33RAUV.css"/><link rel="stylesheet" href="/dask-cookbook/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/dask-cookbook/favicon.ico"/><link rel="stylesheet" href="/dask-cookbook/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/dask-cookbook/"><div class="p-1 mr-3"><img src="/dask-cookbook/build/config-item-24692dda-8646e3e20bfe10d7830e24dfd28e57b7.svg" class="h-9 dark:hidden" height="2.25rem"/><img src="/dask-cookbook/build/config-item-84d6d338-63dee7380e9a8578a26af3e2eae843b5.svg" class="hidden h-9 dark:block" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Home</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://foundations.projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Foundations</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://cookbooks.projectpythia.org/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Cookbooks</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org/resource-gallery.html" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Resources</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org/#join-us" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Community</a></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode." aria-label="Toggle theme between light and dark mode."><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Project Pythia</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Home</a><a href="https://foundations.projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Foundations</a><a href="https://cookbooks.projectpythia.org/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Cookbooks</a><a href="https://projectpythia.org/resource-gallery.html" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Resources</a><a href="https://projectpythia.org/#join-us" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Community</a></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Dask Cookbook" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/dask-cookbook/">Dask Cookbook</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Preamble" class="block break-words rounded py-2 grow cursor-pointer">Preamble</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Introductions to Dask" class="block break-words rounded py-2 grow cursor-pointer">Introductions to Dask</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Dask Schedulers" class="block break-words rounded py-2 grow cursor-pointer">Dask Schedulers</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Dask and Xarray" class="block break-words rounded py-2 grow cursor-pointer">Dask and Xarray</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://opensource.org/licenses/Apache-2.0" target="_blank" rel="noopener noreferrer" title="Content License: Apache License 2.0 (Apache-2.0)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Code License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Code License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/projectpythia/dask-cookbook" title="GitHub Repository: projectpythia/dask-cookbook" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/projectpythia/dask-cookbook/blob/main/notebooks/02-dask-dataframe.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8top:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="mb-0">Dask DataFrame</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rj8top:" data-state="closed">Negin Sobhani</button></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rl8top:" data-state="closed">Brian Vanderwende</button></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rn8top:" data-state="closed">Deepak Cherian</button></span><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rp8top:" data-state="closed">Ben Kirk</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="sticky top-[60px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>enable compute</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><div id="qoxqgq1G7j" class="relative group/block"><p><img id="IzFxmUAdBH" style="margin:0 auto" src="/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg" alt="Dask logo" data-canonical-url="https://docs.dask.org/en/stable/_images/dask_horizontal.svg"/></p><h1 id="dask-dataframe" class="relative group"><span class="heading-text">Dask DataFrame</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#dask-dataframe" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><h3 id="in-this-tutorial-you-learn" class="relative group"><span class="heading-text">In this tutorial, you learn:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#in-this-tutorial-you-learn" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li>Basic concepts and features of Dask DataFrames</li><li>Applications of Dask DataFrames</li><li>Interacting with Dask DataFrames</li><li>Built-in operations with Dask DataFrames</li><li>Dask DataFrames Best Practices</li></ul><h3 id="related-documentation" class="relative group"><span class="heading-text">Related Documentation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#related-documentation" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li><a target="_blank" rel="noreferrer" href="https://docs.dask.org/en/stable/dataframe.html" class="">Dask DataFrame documentation</a></li><li><a target="_blank" rel="noreferrer" href="https://docs.dask.org/en/stable/dataframe-api.html" class="">Dask DataFrame API</a></li><li><a target="_blank" rel="noreferrer" href="https://examples.dask.org/dataframe.html" class="">Dask DataFrame examples</a></li><li><a target="_blank" rel="noreferrer" href="https://pandas.pydata.org/pandas-docs/stable/" class="">pandas documentation</a></li></ul><h3 id="prerequisites" class="relative group"><span class="heading-text">Prerequisites</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#prerequisites" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><table class=""><tbody><tr class=""><th class="">Concepts</th><th class="">Importance</th><th class="">Notes</th></tr><tr class=""><td class=""><a target="_blank" rel="noreferrer" href="https://pandas.pydata.org/docs/user_guide/10min.html" class="">Familiarity with Pandas DataFrame</a></td><td class="">Necessary</td><td class=""></td></tr><tr class=""><td class=""><a target="_blank" rel="noreferrer" href="https://pandas.pydata.org/docs/user_guide/10min.html" class="">Dask Overview</a></td><td class="">Necessary</td><td class=""></td></tr></tbody></table><ul><li><strong>Time to learn</strong>: 40 minutes</li></ul><hr class="py-2 my-5 translate-y-2"/><h2 id="introduction" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><img id="Dvnk8i1MdP" style="margin:0 auto" src="/dask-cookbook/build/b82c470bd299758cae1ef1bfd8655169.svg" alt="Dask DataFrame is composed of pandas DataFrames" data-canonical-url="https://docs.dask.org/en/stable/_images/dask-dataframe.svg"/></p><p><em>Image credit: Dask Contributors</em></p><p>pandas is a very popular tool for working with <strong>tabular datasets</strong>, but the dataset needs to <strong>fit into the memory</strong>.</p><p>pandas operates best with smaller datasets, and if you have a large dataset, you’ll receive an out of memory error using pandas. A general rule of thumb for pandas is:</p><blockquote><dl class="my-5" id="GZfibzoi2H"><dt id="uezShz8toG"><strong>“Have 5 to 10 times as much RAM as the size of your dataset”</strong></dt><dd>Wes McKinney (2017) in <a target="_blank" rel="noreferrer" href="https://wesmckinney.com/blog/apache-arrow-pandas-internals/" class="">10 things I hate about pandas</a></dd></dl></blockquote><p>But Dask DataFrame can be used to solve pandas performance issues with larger-than-memory datasets.</p><h3 id="what-is-dask-dataframe" class="relative group"><span class="heading-text">What is Dask DataFrame?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#what-is-dask-dataframe" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li><p><strong>A Dask DataFrame is a parallel DataFrame composed of smaller pandas DataFrames (also known as <em>partitions</em>).</strong></p></li><li><p>Dask Dataframes look and feel like the pandas DataFrames on the surface.</p></li><li><p>Dask DataFrames partition the data into manageable <strong>partitions</strong> that can be processed in parallel and across multiple cores or computers.</p></li><li><p>Similar to Dask Arrays, Dask DataFrames are lazy!</p><p>Unlike pandas, operations on Dask DataFrames are not computed until you explicitly request them (e.g. by calling <code>.compute</code>).</p></li></ul></div><div id="QtEdsvzPiW" class="relative group/block"><h2 id="when-to-use-dask-dataframe-and-when-to-avoid-it" class="relative group"><span class="heading-text">When to use Dask DataFrame and when to avoid it?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#when-to-use-dask-dataframe-and-when-to-avoid-it" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Dask DataFrames are used in situations where pandas <em>fails</em> or has <em>poor performance due to data size</em>.</p><p>Dask DataFrame is a good choice when doing <strong>parallalizeable computations</strong>.<br/>Some examples are:</p><ul><li>Element-wise operations such as <code>df.x + df.y</code></li><li>Row-wise filtering such as <code>df[df.x&gt;0]</code></li><li>Common aggregations such as <code>df.x.max()</code></li><li>Dropping duplicates such as <code>df.x.drop_duplicate()</code></li></ul><p>However, Dask is not great for operations that requires shuffling or re-indexing.<br/>Some examples are:</p><ul><li>Set index: <code>df.set_index(df.x)</code></li></ul><div class="alert alert-block alert-warning"><strong>WARNING:</strong> Although, Dask DataFrame has a very similar interface to the pandas DataFrame (as we will see in this tutorial), it does NOT include some of the pandas interface yet.<p>See the <a target="_blank" rel="noreferrer" href="https://docs.dask.org/en/stable/dataframe-api.html" class="">Dask DataFrame API documentation</a> for a compehnsive list of available functions.</p></div><hr class="py-2 my-5 translate-y-2"/></div><div id="vlQKSbjhiC" class="relative group/block"><h2 id="tutorial-dataset" class="relative group"><span class="heading-text">Tutorial Dataset</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#tutorial-dataset" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this tutorial, we are going to use the NOAA Global Historical Climatology Network Daily (GHCN-D) dataset.<br/>GHCN-D is a public available dataset that includes daily climate records from +100,000 surface observations around the world.<br/>This is an example of a real dataset that is used by NCAR scientists for their research. GHCN-D raw dataset for all stations is available through <a target="_blank" rel="noreferrer" href="https://www.ncdc.noaa.gov/cdo-web/search?datasetid=GHCND" class="">NOAA Climate Data Online</a>.</p><p><strong>To learn more about GHCNd dataset, please visit:</strong></p><ul><li><a target="_blank" rel="noreferrer" href="https://journals.ametsoc.org/view/journals/atot/29/7/jtech-d-11-00103_1.xml" class="">GHCNd Journal Paper</a></li><li><a target="_blank" rel="noreferrer" href="https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily" class="">GHCNd Official Website</a></li></ul><h3 id="download-the-data" class="relative group"><span class="heading-text">Download the data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#download-the-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>For this example, we are going to look through a subset of data from the GHCN-D dataset.</p><p>First, we look at the daily observations from Denver International Airport, next we are going to look through selected stations in the US.</p><p>The access the preprocessed dataset for this tutorial, please run the following script:</p></div><div id="DBL7ilh1pZ" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">!./get_data.sh</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kyMy1U7GGcNQrTduWZI6M" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Downloading https://docs.google.com/uc?export=download&amp;id=14doSRn8hT14QYtjZz28GKv14JgdIsbFF
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
gzip: stdin: not in gzip format
tar: Child returned status 1
tar: Error is not recoverable: exiting now
Downloading https://docs.google.com/uc?export=download&amp;id=15rCwQUxxpH6angDhpXzlvbe1nGetYHrf
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>tar (child): data.tar.gz: Cannot open: No such file or directory
tar (child): Error is not recoverable: exiting now
tar: Child returned status 2
tar: Error is not recoverable: exiting now
rm: cannot remove &#x27;data.tar.gz&#x27;: No such file or directory
Downloading https://docs.google.com/uc?export=download&amp;id=1Tbuom1KMCwHjy7-eexEQcOXSr51i6mae
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
gzip: stdin: not in gzip format
tar: Child returned status 1
tar: Error is not recoverable: exiting now
</span></code></pre></div></div></div><div id="qb8UzMpZsx" class="relative group/block"><p>This script should save the preprocessed GHCN-D data in <code>../data</code> path.</p></div><div id="Bs1aSo12Vi" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="pandas-dataframe-basics" class="relative group"><span class="heading-text">Pandas DataFrame Basics</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#pandas-dataframe-basics" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s start with an example using pandas DataFrame.</p><p>First, let’s read in the comma-seperated GHCN-D dataset for one station at <strong>Denver International Airport (DIA), CO</strong> (site ID : <code>USW00003017</code>).</p><p>To see the list of all available GHCN-D sites and their coordinates and IDs, please see <a target="_blank" rel="noreferrer" href="https://www.ncei.noaa.gov/pub/data/ghcn/daily/ghcnd-stations.txt" class="">this link</a>.</p></div><div id="cBDObOZAtM" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
import pandas as pd

# DIA ghcnd id
site = &#x27;USW00003017&#x27;
data_dir = &#x27;../data/&#x27;


df = pd.read_csv(os.path.join(data_dir, site+&#x27;.csv&#x27;), parse_dates=[&#x27;DATE&#x27;], index_col=0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_oy5WQfxONzhMMAou83I7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">FileNotFoundError</span><span>                         Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[2]</span><span style="color:rgb(0, 187, 0)">, line 9</span><span>
</span><span style="color:rgb(0, 187, 0)">      5</span><span> site = </span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">USW00003017</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>
</span><span style="color:rgb(0, 187, 0)">      6</span><span> data_dir = </span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">../data/</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>
</span><span style="color:rgb(0, 187, 0)">----&gt; </span><span style="color:rgb(0, 187, 0)">9</span><span> df = </span><span style="background-color:rgb(187, 187, 0)">pd</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">read_csv</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">os</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">path</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">join</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">data_dir</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">site</span><span style="background-color:rgb(187, 187, 0)">+</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&#x27;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">.csv</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&#x27;</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">parse_dates</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&#x27;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">DATE</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&#x27;</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">index_col</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">0</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/parsers/readers.py:1026</span><span>, in </span><span style="color:rgb(0, 187, 187)">read_csv</span><span style="color:rgb(0, 0, 187)">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1013</span><span> kwds_defaults = _refine_defaults_read(
</span><span style="color:rgb(0, 187, 0)">   1014</span><span>     dialect,
</span><span style="color:rgb(0, 187, 0)">   1015</span><span>     delimiter,
</span><span style="color:rgb(0, 187, 0)">   (...)</span><span style="color:rgb(0, 187, 0)">   1022</span><span>     dtype_backend=dtype_backend,
</span><span style="color:rgb(0, 187, 0)">   1023</span><span> )
</span><span style="color:rgb(0, 187, 0)">   1024</span><span> kwds.update(kwds_defaults)
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">1026</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">_read</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">filepath_or_buffer</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">kwds</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/parsers/readers.py:620</span><span>, in </span><span style="color:rgb(0, 187, 187)">_read</span><span style="color:rgb(0, 0, 187)">(filepath_or_buffer, kwds)</span><span>
</span><span style="color:rgb(0, 187, 0)">    617</span><span> _validate_names(kwds.get(</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">names</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>, </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>))
</span><span style="color:rgb(0, 187, 0)">    619</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># Create the parser.</span><span>
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">620</span><span> parser = </span><span style="background-color:rgb(187, 187, 0)">TextFileReader</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">filepath_or_buffer</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">kwds</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    622</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> chunksize </span><span style="color:rgb(175, 0, 255);font-weight:bold">or</span><span> iterator:
</span><span style="color:rgb(0, 187, 0)">    623</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> parser

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/parsers/readers.py:1620</span><span>, in </span><span style="color:rgb(0, 187, 187)">TextFileReader.__init__</span><span style="color:rgb(0, 0, 187)">(self, f, engine, **kwds)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1617</span><span>     </span><span style="color:rgb(0, 135, 0)">self</span><span>.options[</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">has_index_names</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>] = kwds[</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">has_index_names</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>]
</span><span style="color:rgb(0, 187, 0)">   1619</span><span> </span><span style="color:rgb(0, 135, 0)">self</span><span>.handles: IOHandles | </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span> = </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">1620</span><span> </span><span style="color:rgb(0, 135, 0)">self</span><span>._engine = </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">_make_engine</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">f</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">engine</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/parsers/readers.py:1880</span><span>, in </span><span style="color:rgb(0, 187, 187)">TextFileReader._make_engine</span><span style="color:rgb(0, 0, 187)">(self, f, engine)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1878</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">b</span><span style="color:rgb(187, 187, 0)">&quot;</span><span> </span><span style="color:rgb(175, 0, 255);font-weight:bold">not</span><span> </span><span style="color:rgb(175, 0, 255);font-weight:bold">in</span><span> mode:
</span><span style="color:rgb(0, 187, 0)">   1879</span><span>         mode += </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">b</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">1880</span><span> </span><span style="color:rgb(0, 135, 0)">self</span><span>.handles = </span><span style="background-color:rgb(187, 187, 0)">get_handle</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">   1881</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">f</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1882</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">mode</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1883</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">encoding</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">options</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">get</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">encoding</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0);font-weight:bold">None</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1884</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">compression</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">options</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">get</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">compression</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0);font-weight:bold">None</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1885</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">memory_map</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">options</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">get</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">memory_map</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0);font-weight:bold">False</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1886</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">is_text</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">is_text</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1887</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">errors</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">options</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">get</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">encoding_errors</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">strict</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1888</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">storage_options</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">self</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">options</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">get</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">storage_options</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0);font-weight:bold">None</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1889</span><span> </span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1890</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">assert</span><span> </span><span style="color:rgb(0, 135, 0)">self</span><span>.handles </span><span style="color:rgb(175, 0, 255);font-weight:bold">is</span><span> </span><span style="color:rgb(175, 0, 255);font-weight:bold">not</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>
</span><span style="color:rgb(0, 187, 0)">   1891</span><span> f = </span><span style="color:rgb(0, 135, 0)">self</span><span>.handles.handle

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/common.py:873</span><span>, in </span><span style="color:rgb(0, 187, 187)">get_handle</span><span style="color:rgb(0, 0, 187)">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span><span>
</span><span style="color:rgb(0, 187, 0)">    868</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">elif</span><span> </span><span style="color:rgb(0, 135, 0)">isinstance</span><span>(handle, </span><span style="color:rgb(0, 135, 0)">str</span><span>):
</span><span style="color:rgb(0, 187, 0)">    869</span><span>     </span><span style="color:rgb(95, 135, 135);font-style:italic"># Check whether the filename is to be opened in binary mode.</span><span>
</span><span style="color:rgb(0, 187, 0)">    870</span><span>     </span><span style="color:rgb(95, 135, 135);font-style:italic"># Binary mode does not support &#x27;encoding&#x27; and &#x27;newline&#x27;.</span><span>
</span><span style="color:rgb(0, 187, 0)">    871</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> ioargs.encoding </span><span style="color:rgb(175, 0, 255);font-weight:bold">and</span><span> </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">b</span><span style="color:rgb(187, 187, 0)">&quot;</span><span> </span><span style="color:rgb(175, 0, 255);font-weight:bold">not</span><span> </span><span style="color:rgb(175, 0, 255);font-weight:bold">in</span><span> ioargs.mode:
</span><span style="color:rgb(0, 187, 0)">    872</span><span>         </span><span style="color:rgb(95, 135, 135);font-style:italic"># Encoding</span><span>
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">873</span><span>         handle = </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">open</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">    874</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">handle</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">    875</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">ioargs</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">mode</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">    876</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">encoding</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">ioargs</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">encoding</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">    877</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">errors</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">errors</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">    878</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">newline</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&quot;</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">    879</span><span> </span><span style="background-color:rgb(187, 187, 0)">        </span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    880</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">else</span><span>:
</span><span style="color:rgb(0, 187, 0)">    881</span><span>         </span><span style="color:rgb(95, 135, 135);font-style:italic"># Binary mode</span><span>
</span><span style="color:rgb(0, 187, 0)">    882</span><span>         handle = </span><span style="color:rgb(0, 135, 0)">open</span><span>(handle, ioargs.mode)

</span><span style="color:rgb(187, 0, 0)">FileNotFoundError</span><span>: [Errno 2] No such file or directory: &#x27;../data/USW00003017.csv&#x27;</span></code></pre></div></div></div><div id="JgL1TqsDU3" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Display the top five rows of the dataframe
df.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="T4i99m8492MPU1C5vIu-n" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="anKfg04cOr" class="relative group/block"><p><strong>Question:</strong> What variables are available?</p></div><div id="gRDqcZGZV0" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df.columns</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_JH_YJSiZZAdTEsdRas5S" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="KGKWNIT89g" class="relative group/block"><p>The description and units of the dataset is available <a target="_blank" rel="noreferrer" href="https://www.ncei.noaa.gov/pub/data/ghcn/daily/readme.txt" class="">here</a>.</p></div><div id="MuyaGYx7sv" class="relative group/block"><h3 id="operations-on-pandas-dataframe" class="relative group"><span class="heading-text">Operations on pandas DataFrame</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#operations-on-pandas-dataframe" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>pandas DataFrames has several features that give us flexibility to do different calculations and analysis on our dataset. Let’s check some out:</p><h4 id="simple-analysis" class="relative group"><span class="heading-text">Simple Analysis</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#simple-analysis" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="CUpA4FHACa" class="relative group/block"><p>For example:</p><ul><li>When was the coldest day at this station during December of last year?</li></ul></div><div id="OKiG51BviZ" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># use python slicing notation inside .loc 
# use idxmin() to find the index of minimum valus
df.loc[&#x27;2022-12-01&#x27;:&#x27;2022-12-31&#x27;].TMIN.idxmin()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SxcHTgAYOqeXuJv8h6PH8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BvzZOTHE0B" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Here we easily plot the prior data using matplotlib from pandas
# -- .loc for value based indexing
df.loc[&#x27;2022-12-01&#x27;:&#x27;2022-12-31&#x27;].SNWD.plot(ylabel= &#x27;Daily Average Snow Depth [mm]&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="f0HOWTjDMI4EOuE5tIFmN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="rC277vN0iC" class="relative group/block"><ul><li>How many snow days do we have each year at this station?</li></ul><p>Pandas groupby is used for grouping the data according to the categories.</p></div><div id="dDkQmkJm4f" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># 1- First select days with snow &gt; 0
# 2- Create a &quot;groupby object&quot; based on the selected columns
# 3- use .size() to compute the size of each group
# 4- sort the values descending 

# we count days where SNOW&gt;0, and sort them and show top 5 years:
df[df[&#x27;SNOW&#x27;]&gt;0].groupby(&#x27;YEAR&#x27;).size().sort_values(ascending=False).head()
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_22i7zfSfoiq2Q-w4a5aO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="PVfIiFYm34" class="relative group/block"><p>Or for a more complex analysis:</p><p>For example, we have heard that this could be Denver’s first January in 13 years with no 60-degree days.</p><p><img id="dJ2z09Y591" style="margin:0 auto" src="/dask-cookbook/build/576ee6c7ccc2f9c50f73ce145e8f7592.png" alt="News article showing that this January is abnormally warm" data-canonical-url="https://raw.githubusercontent.com/ProjectPythia/dask-cookbook/main/notebooks/images/denver.png"/></p><p>Below, we show all days with high temperature above 60°F (155.5°C/10) since 2010:</p></div><div id="qc3fv4VrCc" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df[(df[&#x27;MONTH&#x27;]==1) &amp; (df[&#x27;YEAR&#x27;]&gt;=2010) &amp; (df[&#x27;TMAX&#x27;]&gt;155.5)].groupby([&#x27;YEAR&#x27;]).size()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gr2LC948hMbZYdcnxHSyE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="JrQO6NvkPb" class="relative group/block"><p>This is great! But how big is this dataset for one station?</p><p>First, let’s check the file size:</p></div><div id="mFeA9eG3II" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">!ls -lh ../data/USW00003017.csv</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="TxuvDgKxWKD7exp6f_psV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EZIZMxTc8Z" class="relative group/block"><p>Similar to the previous tutorial, we can use the following function to find the size of a variable on memory.</p></div><div id="bW2dpHl5FW" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Define function to display variable size in MB
import sys
def var_size(in_var):
    result = sys.getsizeof(in_var) / 1e6
    print(f&quot;Size of variable: {result:.2f} MB&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="UxZ4a7HN-F7xGi871vLTN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ehIQ7kRQwT" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">var_size(df)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="U7a9HxJvJbbEe5-aNBvi_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QGJHf2iuE4" class="relative group/block"><p>Remember, the above rule?</p><blockquote><dl class="my-5" id="I4ZmmYFV2v"><dt id="g3SktubpWb"><strong>“Have 5 to 10 times as much RAM as the size of your dataset”</strong></dt><dd>Wes McKinney (2017) in <a target="_blank" rel="noreferrer" href="https://wesmckinney.com/blog/apache-arrow-pandas-internals/" class="">10 things I hate about pandas</a></dd></dl></blockquote></div><div id="JxOFdFIqo4" class="relative group/block"><p><strong>So far, we read in and analyzed data for one station. We have a total of +118,000 stations over the world and +4500 stations in Colorado alone!</strong></p><p><strong>What if we want to look at the larger dataset?</strong></p><h2 id="scaling-up-to-a-larger-dataset" class="relative group"><span class="heading-text">Scaling up to a larger dataset</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#scaling-up-to-a-larger-dataset" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s start by reading data from selected stations. The downloaded data for this example includes the climatology observations from 66 selected sites in Colorado.</p><p>Pandas can concatenate data to load data spread across multiple files:</p></div><div id="kAEhZWAD8A" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">!du -csh ../data/*.csv |tail -n1</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="73CVSluDF9OhGrnhCx2JM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="DtYGp2McZo" class="relative group/block"><p>Using a for loop with <code>pandas.concat</code>, we can read multiple files at the same time:</p></div><div id="m6Qf5BydBK" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
import glob
co_sites = glob.glob(os.path.join(data_dir, &#x27;*.csv&#x27;))
df = pd.concat(pd.read_csv(f, index_col=0, parse_dates=[&#x27;DATE&#x27;]) for f in co_sites)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YW9HIf8o9WbwG8k6NEetv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ivwBy2FAXF" class="relative group/block"><ul><li>How many stations have we read in?</li></ul></div><div id="OAvE5y0rSJ" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print (&quot;Concatenated data for&quot;, len(df.ID.unique()), &quot;unique sites.&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MhlOKhtQa60C765HMtFmB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OQ0g2cKMKa" class="relative group/block"><p>Now that we concatenated the data for all sites in one DataFrame, we can do similar analysis on it:</p></div><div id="EkvPvUP6Dj" class="relative group/block"><ul><li>Which site has recorded the most snow days in a year?</li></ul></div><div id="Z5OLtIHlhc" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
# ~90s on 4GB RAM
snowy_days = df[df[&#x27;SNOW&#x27;]&gt;0].groupby([&#x27;ID&#x27;,&#x27;YEAR&#x27;]).size()

print (&#x27;This site has the highest number of snow days in a year : &#x27;)
snowy_days.agg([&#x27;idxmax&#x27;,&#x27;max&#x27;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SUoBE7Rc3TyNWB0HMAYep" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="uew72JwNxj" class="relative group/block"><p><strong>Excersise:</strong> Which Colorado site has recorded the most snow days in 2023?</p></div><div id="B9d5yarpF5" class="relative group/block"><p><strong>Dask allows us to conceptualize all of these files as a single dataframe!</strong></p></div><div id="T8UlVyNENY" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Let&#x27;s do a little cleanup
del df, snowy_days</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="IGAvLGmxMxkP7IH9730te" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="caqRH33zzm" class="relative group/block"><h2 id="computations-on-dask-dataframe" class="relative group"><span class="heading-text">Computations on Dask DataFrame</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#computations-on-dask-dataframe" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="U3jEBCfjCG" class="relative group/block"><h3 id="create-a-localcluster-client-with-dask" class="relative group"><span class="heading-text">Create a “LocalCluster” Client with Dask</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#create-a-localcluster-client-with-dask" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="S131vRRfxY" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from dask.distributed import Client, LocalCluster

cluster = LocalCluster()
client = Client(cluster)
client</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tQOLhGI5LpXueX2rveN0o" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xDpCQVQNrZ" class="relative group/block"><p>☝️ Click the Dashboard link above.</p><p>👈 Or click the “Search” 🔍 button in the dask-labextension dashboard.</p><h3 id="dask-dataframe-read-csv-to-read-multiple-files" class="relative group"><span class="heading-text">Dask DataFrame <code>read_csv</code> to read multiple files</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#dask-dataframe-read-csv-to-read-multiple-files" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><code>dask.dataframe.read_csv</code> function can be used in conjunction with <code>glob</code> to read multiple csv files at the same time.</p><p>Remember we can read one file with <code>pandas.read_csv</code>. For reading multiple files with pandas, we have to concatenate them with <code>pd.concatenate</code>. However, we can read many files at once just using <code>dask.dataframe.read_csv</code>.</p><p>Overall, Dask is designed to perform I/O in parallel and is more performant than pandas for operations with multiple files or large files.</p></div><div id="gPXfZFHfH2" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
import dask
import dask.dataframe as dd

ddf = dd.read_csv(co_sites, parse_dates=[&#x27;DATE&#x27;])
ddf</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="b8AvhhcpVqDyvajwA9a_A" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qTXpOOnEmH" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ddf.TMAX.mean()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bJh5oV_t-f5DCPyatkQ3O" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="kA6PKrYzpg" class="relative group/block"><p><strong>Notice that the representation of the DataFrame object contains no data just headers and datatypes.  Why?</strong></p><h4 id="lazy-evaluation" class="relative group"><span class="heading-text">Lazy Evaluation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lazy-evaluation" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Similar to Dask Arrays, Dask DataFrames are lazy. Here the data has not yet been read into the dataframe yet (a.k.a. lazy evaluation).<br/>Dask just construct the task graph of the computation but it will “evaluate” them only when necessary.</p><p><strong>So how does Dask know the name and dtype of each column?</strong></p><p>Dask has just read the start of the first file and infers the column names and dtypes.</p><p>Unlike <code>pandas.read_csv</code> that reads in all files before inferring data types, <code>dask.dataframe.read_csv</code> only reads in a sample from the beginning of the file (or first file if using a glob). The column names and dtypes are then enforced when reading the specific partitions (<em>Dask can make mistakes on these inferences if there is missing or misleading data in the early rows</em>).</p></div><div id="nTP362J8iR" class="relative group/block"><p>Let’s take a look at the start of our dataframe:</p></div><div id="F5PKhrlpDI" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ddf.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2tDrrdcB54NCFHBjCpqXF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="L877DGRzsA" class="relative group/block"><div class="alert alert-block alert-info"><p><strong>NOTE:</strong> Whenever we operate on our dataframe we read through all of our CSV data so that we don’t fill up RAM. Dask will delete intermediate results (like the full pandas DataFrame for each file) as soon as possible. This enables you to handle larger than memory datasets but, repeated computations will have to load all of the data in each time.</p></div></div><div id="AlRtMLTT5Q" class="relative group/block"><p>Similar data manipulations as <code>pandas.dataframe</code> can be done for <code>dask.dataframes</code>.<br/>For example, let’s find the highest number of snow days in Colorado:</p></div><div id="zN1EI5GGXm" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
print (&#x27;This site has the highest number of snow days in a year : &#x27;)
snowy_days = ddf[ddf[&#x27;SNOW&#x27;]&gt;0].groupby([&#x27;ID&#x27;,&#x27;YEAR&#x27;]).size()
snowy_days.compute().agg([&#x27;idxmax&#x27;,&#x27;max&#x27;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="eIGxakpAs_XzjJEMQbCk9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="RgSGHrfrPE" class="relative group/block"><h4 id="nice-but-what-did-dask-do" class="relative group"><span class="heading-text">Nice, but what did Dask do?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#nice-but-what-did-dask-do" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="PFdNyt28o8" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Requires ipywidgets

snowy_days.dask</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wsBe6o_XOGOU0j4R150DC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="iip5aEKOro" class="relative group/block"><p>You can also view the underlying task graph using <code>.visualize()</code>:</p></div><div id="eXuch1fIKj" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#graph is too large
snowy_days.visualize()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nM_ECT98gWBMKZ4X0vi47" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="GY1afi45xa" class="relative group/block"><h3 id="use-compute-wisely" class="relative group"><span class="heading-text">Use <code>.compute</code> wisely!</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-compute-wisely" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><h4 id="share-intermediate-results" class="relative group"><span class="heading-text">Share intermediate results</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#share-intermediate-results" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="WBGIkgtOKw" class="relative group/block"><p>For most operations, <code>dask.dataframe</code> hashes the arguments, allowing duplicate computations to be shared, and only computed once.</p><p>For example, let’s compute the mean and standard deviation for Maximum daily temperature of all snow days.</p></div><div id="KooaBlaIJV" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">snowy_days = ddf[ddf[&#x27;SNOW&#x27;]&gt;0]
mean_tmax = snowy_days.TMAX.mean()
std_tmax = snowy_days.TMAX.std()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="N-wFnnuHLlkc4KGoxNu22" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="AOawhOkNut" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time

mean_tmax_result = mean_tmax.compute()
std_tmax_result = std_tmax.compute()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5pwtng2gqD6Iyz9T_adMq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wtrGdu0cE8" class="relative group/block"><p>But if we pass both arguments in a single <code>.compute</code>, we can share the intermediate results:</p></div><div id="ZVdBmwYOxJ" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
mean_tmax_result, std_tmax_result = dask.compute(mean_tmax, std_tmax)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZZ5nVAqTaTZme9twWwssZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="WJymuccrwN" class="relative group/block"><p>Here using <code>dask.compute</code> only one allowed sharing intermediate results between TMAX mean and median calculations and improved total performance.</p></div><div id="tyySpuQCqM" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">mean_tmax.dask</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Lt5m3axG-8Ve_a3OO3Ry6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="j7UaEwOGOS" class="relative group/block"><p>Here some operations such as the calls to read the csv files, the filtering, and the grouping is exactly similar between both operations, so they can share intermediate results. Remember, Dask will delete intermediate results (like the full pandas DataFrame for each file) as soon as possible.</p></div><div id="BhyY2HvlZB" class="relative group/block"><h3 id="id-persist-or-caching" class="relative group"><span class="heading-text"><code>.persist</code> or caching</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-persist-or-caching" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Sometimes you might want your computers to keep intermediate results in memory, if it fits in the memory.</p><p>The <code>.persist()</code> method can be used to  “cache” data and tell Dask what results to keep around. You should only use <code>.persist()</code> with any data or computation that fits in memory.</p></div><div id="m6Sfv6OAYE" class="relative group/block"><p>For example, if we want to only do analysis on a subset of data (for example snow days at Boulder site):</p></div><div id="jVZV4N0MRF" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">boulder_snow = ddf[(ddf[&#x27;SNOW&#x27;]&gt;0)&amp;(ddf[&#x27;ID&#x27;]==&#x27;USC00050848&#x27;)]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4gdtUGjEntDUMUZ2TbHLh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xTcjWkigbl" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
tmax = boulder_snow.TMAX.mean().compute()
tmin = boulder_snow.TMIN.mean().compute()

print (tmin, tmax)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Y19Z_LYoGKSwEjoNHyH47" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="uOh8K4VJJw" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">boulder_snow = ddf[(ddf[&#x27;SNOW&#x27;]&gt;0)&amp;(ddf[&#x27;ID&#x27;]==&#x27;USC00050848&#x27;)].persist()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dACHAh0R6rd0N9AihS_e-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="DUhc0D3swB" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time

tmax = boulder_snow.TMAX.mean().compute()
tmin = boulder_snow.TMIN.mean().compute()
print (tmin, tmax)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="rTO7rr3MmwpOAokTvtcHO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="alWAQukJB5" class="relative group/block"><p>As you can see the analysis on this persisted data is much faster because we are not repeating the loading and selecting.</p></div><div id="YuvuH9SVPo" class="relative group/block"><h2 id="dask-dataframes-best-practices" class="relative group"><span class="heading-text">Dask DataFrames Best Practices</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#dask-dataframes-best-practices" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="use-pandas-when-you-can" class="relative group"><span class="heading-text">Use pandas (when you can)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-pandas-when-you-can" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>For data that fits into RAM, pandas can often be easier and more efficient to use than Dask DataFrame. However, Dask DataFrame is a powerful tool for larger-than-memory datasets.</p><p>When the data is still larger than memory, Dask DataFrame can be used to <strong>reduce</strong> the larger datasets to a manageable level that pandas can handle. Next, use pandas at that point.</p><h3 id="avoid-full-data-shuffling" class="relative group"><span class="heading-text">Avoid Full-Data Shuffling</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#avoid-full-data-shuffling" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Some operations are more expensive to compute in a parallel setting than if they are in-memory on a single machine (for example, <code>set_index</code> or <code>merge</code>). In particular, <strong>shuffling</strong> operations that rearrange data can become very communication intensive.</p><h3 id="pandas-performance-tips" class="relative group"><span class="heading-text">pandas performance tips</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#pandas-performance-tips" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>pandas performance tips such as using vectorized operations also apply to Dask DataFrames. See <a href="https://github.com/TomAugspurger/effective-pandas/blob/master/modern_1_intro.ipynb" class="italic" target="_blank" rel="noreferrer" data-state="closed">Modern Pandas notebook</a> for more tips on better performance with pandas.</p><h3 id="check-partition-size" class="relative group"><span class="heading-text">Check Partition Size</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#check-partition-size" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Similar to chunks, partitions should be small enough that they fit in the memory, but large enough to avoid that the communication overhead.</p><h4 id="blocksize" class="relative group"><span class="heading-text"><code>blocksize</code></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#blocksize" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li>The number of partitions can be set using the <code>blocksize</code> argument.
If none is given, the number of partitions/blocksize is calculated depending on the available memory and the number of cores on a machine up to a max of 64 MB. As we increase the blocksize, the number of partitions (calculated by Dask) will decrease. This is especially important when reading one large csv file.</li></ul><p><strong>As a good rule of thumb, you should aim for partitions that have around 100MB of data each.</strong></p><h3 id="smart-use-of-compute" class="relative group"><span class="heading-text">Smart use of <code>.compute()</code></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#smart-use-of-compute" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Try avoiding running <code>.compute()</code> operation as long as possible. Dask works best when users avoid computation until results are needed. The <code>.compute()</code> command informs Dask to trigger computations on the Dask DataFrame.<br/>As shown in the above example, the intermediate results can also be shared by calling <code>.compute()</code> only once.</p></div><div id="vKG7IQj5r9" class="relative group/block"><h3 id="close-your-local-dask-cluster" class="relative group"><span class="heading-text">Close your local Dask Cluster</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#close-your-local-dask-cluster" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>It is always a good practice to close the Dask cluster you created.</p></div><div id="ECzt8Cia1x" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">client.shutdown()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vpypQ2NpsNze17nWzwxKo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OzFbv9IFnE" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/></div><div id="fAIyTr1EEk" class="relative group/block"><h2 id="summary" class="relative group"><span class="heading-text">Summary</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#summary" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this notebook, we have learned about:</p><ul><li>Dask DataFrame concept and component.</li><li>When to use and when to avoid Dask DataFrames?</li><li>How to use Dask DataFrame?</li><li>Some best practices around Dask DataFrames.</li></ul><h2 id="resources-and-references" class="relative group"><span class="heading-text">Resources and references</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#resources-and-references" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li><p>Reference</p><ul><li><a target="_blank" rel="noreferrer" href="https://dask.org/" class="">Dask Docs</a></li><li><a target="_blank" rel="noreferrer" href="https://examples.dask.org/" class="">Dask Examples</a></li><li><a target="_blank" rel="noreferrer" href="https://github.com/dask/dask/" class="">Dask Code</a></li><li><a target="_blank" rel="noreferrer" href="https://blog.dask.org/" class="">Dask Blog</a></li><li><a target="_blank" rel="noreferrer" href="https://pandas.pydata.org/docs/" class="">Pandas Docs</a></li></ul></li><li><p>Ask for help</p><ul><li><a target="_blank" rel="noreferrer" href="http://stackoverflow.com/questions/tagged/dask" class=""><code>dask</code></a> tag on Stack Overflow, for usage questions</li><li><a target="_blank" rel="noreferrer" href="https://github.com/dask/dask/discussions" class="">github discussions: dask</a> for general, non-bug, discussion, and usage questions</li><li><a target="_blank" rel="noreferrer" href="https://github.com/dask/dask/issues/new" class="">github issues: dask</a> for bug reports and feature requests</li></ul></li></ul></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/dask-cookbook/dask-array"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Introductions to Dask</div>Dask Array</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/dask-cookbook/dask-cluster"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Dask Schedulers</div>Dask Schedulers</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/dask-cookbook/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-TMJFFFM7.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/dask-cookbook/build/root-LMCDRB6W.js"/><link rel="modulepreload" href="/dask-cookbook/build/_shared/chunk-GOFUXLLW.js"/><link rel="modulepreload" href="/dask-cookbook/build/routes/$-SJYMRUNJ.js"/><script>window.__remixContext = {"url":"/dask-dataframe","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.4.0","options":{"favicon":"/dask-cookbook/build/config-item-9b3afca6-fda85cf3357eae56bcb76c9fdd023aca.ico","logo":"/dask-cookbook/build/config-item-24692dda-8646e3e20bfe10d7830e24dfd28e57b7.svg","logo_dark":"/dask-cookbook/build/config-item-84d6d338-63dee7380e9a8578a26af3e2eae843b5.svg"},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery.html"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"title":"Dask Cookbook","authors":[{"nameParsed":{"literal":"Negin Sobhani","given":"Negin","family":"Sobhani"},"name":"Negin Sobhani","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Brian Vanderwende","given":"Brian","family":"Vanderwende"},"name":"Brian Vanderwende","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Deepak Cherian","given":"Deepak","family":"Cherian"},"name":"Deepak Cherian","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Ben Kirk","given":"Ben","family":"Kirk"},"name":"Ben Kirk","id":"contributors-myst-generated-uid-3"}],"github":"https://github.com/projectpythia/dask-cookbook","copyright":"2024","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/dask-cookbook","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/00-dask-overview.ipynb"},{"file":"notebooks/01-dask-array.ipynb"},{"file":"notebooks/02-dask-dataframe.ipynb"}],"title":"Introductions to Dask"},{"children":[{"file":"notebooks/04-dask-cluster.ipynb"}],"title":"Dask Schedulers"},{"children":[{"file":"notebooks/03-dask-xarray.ipynb"}],"title":"Dask and Xarray"}],"thumbnail":"/dask-cookbook/build/3c53e14c00df126aad2585b810fdb885.svg","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/dask-cookbook/build/8429bc1c1826b03711115c7ba028f37e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Introductions to Dask"},{"slug":"dask-overview","title":"Dask Overview","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dask-array","title":"Dask Array","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dask-dataframe","title":"Dask DataFrame","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Dask Schedulers"},{"slug":"dask-cluster","title":"Dask Schedulers","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Dask and Xarray"},{"slug":"dask-xarray","title":"Parallelizing Xarray with Dask","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/dask-cookbook"},"routes/$":{"config":{"version":2,"myst":"1.4.0","options":{"favicon":"/dask-cookbook/build/config-item-9b3afca6-fda85cf3357eae56bcb76c9fdd023aca.ico","logo":"/dask-cookbook/build/config-item-24692dda-8646e3e20bfe10d7830e24dfd28e57b7.svg","logo_dark":"/dask-cookbook/build/config-item-84d6d338-63dee7380e9a8578a26af3e2eae843b5.svg"},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery.html"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"title":"Dask Cookbook","authors":[{"nameParsed":{"literal":"Negin Sobhani","given":"Negin","family":"Sobhani"},"name":"Negin Sobhani","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Brian Vanderwende","given":"Brian","family":"Vanderwende"},"name":"Brian Vanderwende","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Deepak Cherian","given":"Deepak","family":"Cherian"},"name":"Deepak Cherian","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Ben Kirk","given":"Ben","family":"Kirk"},"name":"Ben Kirk","id":"contributors-myst-generated-uid-3"}],"github":"https://github.com/projectpythia/dask-cookbook","copyright":"2024","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/dask-cookbook","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/00-dask-overview.ipynb"},{"file":"notebooks/01-dask-array.ipynb"},{"file":"notebooks/02-dask-dataframe.ipynb"}],"title":"Introductions to Dask"},{"children":[{"file":"notebooks/04-dask-cluster.ipynb"}],"title":"Dask Schedulers"},{"children":[{"file":"notebooks/03-dask-xarray.ipynb"}],"title":"Dask and Xarray"}],"thumbnail":"/dask-cookbook/build/3c53e14c00df126aad2585b810fdb885.svg","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/dask-cookbook/build/8429bc1c1826b03711115c7ba028f37e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Introductions to Dask"},{"slug":"dask-overview","title":"Dask Overview","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dask-array","title":"Dask Array","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dask-dataframe","title":"Dask DataFrame","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Dask Schedulers"},{"slug":"dask-cluster","title":"Dask Schedulers","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Dask and Xarray"},{"slug":"dask-xarray","title":"Parallelizing Xarray with Dask","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"2bd7ef110d55ac498f81fcee8e1d87e7a2cd488ceba44d80e1ec84cd75d40f58","slug":"dask-dataframe","location":"/notebooks/02-dask-dataframe.ipynb","dependencies":[],"frontmatter":{"title":"Dask DataFrame","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Negin Sobhani","given":"Negin","family":"Sobhani"},"name":"Negin Sobhani","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Brian Vanderwende","given":"Brian","family":"Vanderwende"},"name":"Brian Vanderwende","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Deepak Cherian","given":"Deepak","family":"Cherian"},"name":"Deepak Cherian","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Ben Kirk","given":"Ben","family":"Kirk"},"name":"Ben Kirk","id":"contributors-myst-generated-uid-3"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/dask-cookbook","copyright":"2024","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/dask-cookbook/blob/main/notebooks/02-dask-dataframe.ipynb","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","exports":[{"format":"ipynb","filename":"02-dask-dataframe.ipynb","url":"/dask-cookbook/build/02-dask-dataframe-73d270086acaf58fc1f39b2a45e767ae.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","alt":"Dask logo","key":"IzFxmUAdBH","urlSource":"https://docs.dask.org/en/stable/_images/dask_horizontal.svg"}],"key":"oFszLpHXYr"},{"type":"heading","depth":1,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Dask DataFrame","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QpzucjmT0M"}],"identifier":"dask-dataframe","label":"Dask DataFrame","html_id":"dask-dataframe","implicit":true,"key":"zgDyjtDiR9"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In this tutorial, you learn:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"plg79cgl5E"}],"identifier":"in-this-tutorial-you-learn","label":"In this tutorial, you learn:","html_id":"in-this-tutorial-you-learn","implicit":true,"key":"CLSq7UqeFG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Basic concepts and features of Dask DataFrames","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"SSqmzu9KcM"}],"key":"sXE0bHjOCX"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Applications of Dask DataFrames","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"yRYBmzKpMe"}],"key":"XjUVfUHSIq"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Interacting with Dask DataFrames","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ntupQwhDsS"}],"key":"sUehRcHP8E"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Built-in operations with Dask DataFrames","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"GYljsvlKeG"}],"key":"j2mMFq9uzr"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Dask DataFrames Best Practices","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TpytUCT1V9"}],"key":"cvdo4rd3kw"}],"key":"SgluwZVoUi"},{"type":"heading","depth":3,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Related Documentation","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"bjHq3JsTMZ"}],"identifier":"related-documentation","label":"Related Documentation","html_id":"related-documentation","implicit":true,"key":"WJr3Ne0qJG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"link","url":"https://docs.dask.org/en/stable/dataframe.html","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Dask DataFrame documentation","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"djvibEYKVG"}],"urlSource":"https://docs.dask.org/en/stable/dataframe.html","key":"ozuN0SwK5A"}],"key":"P1VuPb7Ll2"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"link","url":"https://docs.dask.org/en/stable/dataframe-api.html","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Dask DataFrame API","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"cbEVOw3tO0"}],"urlSource":"https://docs.dask.org/en/stable/dataframe-api.html","key":"zrwrPYornv"}],"key":"rQqJC3NkEP"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"link","url":"https://examples.dask.org/dataframe.html","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Dask DataFrame examples","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"QxkzWpnLaD"}],"urlSource":"https://examples.dask.org/dataframe.html","key":"hWOqZ240Zn"}],"key":"tdwIsqPGPG"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"link","url":"https://pandas.pydata.org/pandas-docs/stable/","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"pandas documentation","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"YOKzW3hMP8"}],"urlSource":"https://pandas.pydata.org/pandas-docs/stable/","key":"XSYc4yE1Bw"}],"key":"hz51a1R2ie"}],"key":"e630sxwdmm"},{"type":"heading","depth":3,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"HmFwWTQaxb"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"adFwhsQrdw"},{"type":"table","position":{"start":{"line":25,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"harJEbbqLj"}],"key":"oALZOQIS2k"},{"type":"tableCell","header":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"CP72IPHMC4"}],"key":"S8v02MqqLL"},{"type":"tableCell","header":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"J0fVSLS2wM"}],"key":"Ce3ljD3EUD"}],"key":"DhmRsHzCuJ"},{"type":"tableRow","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"link","url":"https://pandas.pydata.org/docs/user_guide/10min.html","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Familiarity with Pandas DataFrame","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"q8mVB1Erhb"}],"urlSource":"https://pandas.pydata.org/docs/user_guide/10min.html","key":"P1kLKroFAM"}],"key":"rRgl0KXDaa"},{"type":"tableCell","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"owDn3Wj6Ev"}],"key":"YryhoeHqLn"},{"type":"tableCell","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[],"key":"M87RJ0JiDx"}],"key":"rBAjtPOx5A"},{"type":"tableRow","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"link","url":"https://pandas.pydata.org/docs/user_guide/10min.html","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Dask Overview","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"bW2mTPcqhD"}],"urlSource":"https://pandas.pydata.org/docs/user_guide/10min.html","key":"O2n5E2ACe3"}],"key":"TOwHLtPKLu"},{"type":"tableCell","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"HTPUvLnT3I"}],"key":"mth66DXWBN"},{"type":"tableCell","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[],"key":"AYVO1IisEE"}],"key":"evDYvWNWKY"}],"key":"aatBGf3c1S"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"strong","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"eadtPj5Zkk"}],"key":"w5ut6j6fCB"},{"type":"text","value":": 40 minutes","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"ASqcTJZRC1"}],"key":"harxi2WLDO"}],"key":"xwGKHAOKyv"},{"type":"thematicBreak","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Kb3jqVDMIc"},{"type":"heading","depth":2,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"q3NLa7pWKl"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"nij5iqL5ZK"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"image","url":"/dask-cookbook/build/b82c470bd299758cae1ef1bfd8655169.svg","alt":"Dask DataFrame is composed of pandas DataFrames","key":"Dvnk8i1MdP","urlSource":"https://docs.dask.org/en/stable/_images/dask-dataframe.svg"}],"key":"ObAr7bJ2lb"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Image credit: Dask Contributors","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"cVpE5l3fCZ"}],"key":"BudW3knRvV"}],"key":"K3HafQGAZq"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"pandas is a very popular tool for working with ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"EPlXii0gBq"},{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"tabular datasets","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Fl2sFDh9LH"}],"key":"HQN99ijniB"},{"type":"text","value":", but the dataset needs to ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"WAtJ05Vi6t"},{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"fit into the memory","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Uv1tcpdexj"}],"key":"JFYH0pcloF"},{"type":"text","value":".","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"KIbydUMqeb"}],"key":"DBbgd3ItHE"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"pandas operates best with smaller datasets, and if you have a large dataset, you’ll receive an out of memory error using pandas. A general rule of thumb for pandas is:","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"AcVRW3mIL6"}],"key":"kt1k9gqTpn"},{"type":"blockquote","position":{"start":{"line":46,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"definitionList","position":{"start":{"line":46,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"definitionTerm","position":{"start":{"line":46,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"“Have 5 to 10 times as much RAM as the size of your dataset”","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"gPDpQUpJkb"}],"key":"uezShz8toG"},{"type":"definitionDescription","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Wes McKinney (2017) in ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"tN0AY02jvd"},{"type":"link","url":"https://wesmckinney.com/blog/apache-arrow-pandas-internals/","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"10 things I hate about pandas","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"Ni4kO14GIE"}],"urlSource":"https://wesmckinney.com/blog/apache-arrow-pandas-internals/","key":"pxfkjx2sIe"}],"key":"HwssDYga0P"}],"key":"GZfibzoi2H"}],"key":"DCfiVjgD4p"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"But Dask DataFrame can be used to solve pandas performance issues with larger-than-memory datasets.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"iop73PQ6Nt"}],"key":"a5TdzB8Fyd"},{"type":"heading","depth":3,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"What is Dask DataFrame?","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"mFY8tzTbfl"}],"identifier":"what-is-dask-dataframe","label":"What is Dask DataFrame?","html_id":"what-is-dask-dataframe","implicit":true,"key":"AGhvloghvu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":56,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"strong","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"A Dask DataFrame is a parallel DataFrame composed of smaller pandas DataFrames (also known as ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"Y1D6QtEDpc"},{"type":"emphasis","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"partitions","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"mEL3mteSdZ"}],"key":"o0pEHm96Kr"},{"type":"text","value":").","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"w8nEuBaKz5"}],"key":"M4fn3BWJ5n"}],"key":"QeBlKe9dyz"}],"key":"e1OPAECTfH"},{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Dask Dataframes look and feel like the pandas DataFrames on the surface.","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"Xh5Wvqql33"}],"key":"MXDP0yO8aE"}],"key":"cU06QKqUr3"},{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Dask DataFrames partition the data into manageable ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"m7QCaixcfH"},{"type":"strong","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"partitions","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"BzuqbYHFZE"}],"key":"Fjr1GxEunn"},{"type":"text","value":" that can be processed in parallel and across multiple cores or computers.","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"QIrQbNrALT"}],"key":"Fdz6gPvgmd"}],"key":"QbkAoCK8gT"},{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Similar to Dask Arrays, Dask DataFrames are lazy!","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"n2KcXEuJBy"}],"key":"tToT6TGtf9"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Unlike pandas, operations on Dask DataFrames are not computed until you explicitly request them (e.g. by calling ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"ZzyiYs0mdu"},{"type":"inlineCode","value":".compute","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"enhVD0PLAo"},{"type":"text","value":").","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"UPDTp9YYrQ"}],"key":"FvsNWCwmWS"}],"key":"leTBNpYlwZ"}],"key":"dUu1qd3IMa"}],"key":"qoxqgq1G7j"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When to use Dask DataFrame and when to avoid it?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VspRLReuOv"}],"identifier":"when-to-use-dask-dataframe-and-when-to-avoid-it","label":"When to use Dask DataFrame and when to avoid it?","html_id":"when-to-use-dask-dataframe-and-when-to-avoid-it","implicit":true,"key":"BaT5V6PHIR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Dask DataFrames are used in situations where pandas ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i9YRbtGSs4"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"fails","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JiBiwWAihA"}],"key":"CDajPdt6Zd"},{"type":"text","value":" or has ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FXd5ZGjqs7"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"poor performance due to data size","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gaJhbhegsC"}],"key":"CwwSRUvhRr"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZsWr9t8QxT"}],"key":"V7UCnwxoy7"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Dask DataFrame is a good choice when doing ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"v6RLATWId5"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"parallalizeable computations","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Orn0IObQSq"}],"key":"EhLcOc5LBv"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MGwu6pCLFn"},{"type":"break","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kwdF62IGsO"},{"type":"text","value":"Some examples are:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CNZrFAVFMo"}],"key":"jOjRIzn0Rc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Element-wise operations such as ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BOakPMKwPU"},{"type":"inlineCode","value":"df.x + df.y","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VYSy5aiN3F"}],"key":"XF3W9hpN3E"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Row-wise filtering such as ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cggSOiM7hQ"},{"type":"inlineCode","value":"df[df.x\u003e0]","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"k4AnMBJHP7"}],"key":"Cybh5DhT3g"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Common aggregations such as ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VIkjy3svlq"},{"type":"inlineCode","value":"df.x.max()","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"E83zheixOt"}],"key":"knmPDcpYHP"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Dropping duplicates such as ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eAFfDnQI95"},{"type":"inlineCode","value":"df.x.drop_duplicate()","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AZGcQOWGtA"}],"key":"QgPq4wmFS3"}],"key":"TfRM4U1e5j"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"However, Dask is not great for operations that requires shuffling or re-indexing.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Sm4XLFHUsx"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Ve2RqRpXkH"},{"type":"text","value":"Some examples are:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"k6S2fEybue"}],"key":"nCLFwpr9ja"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Set index: ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ctnKluo0QI"},{"type":"inlineCode","value":"df.set_index(df.x)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"SoSxTF10gu"}],"key":"veVnrn0sxX"}],"key":"GYjYjQ54iV"},{"type":"div","class":"alert alert-block alert-warning","children":[{"type":"strong","children":[{"type":"text","value":"WARNING:","key":"ju9Fu3zWVZ"}],"key":"cCUktpROGu"},{"type":"text","value":" Although, Dask DataFrame has a very similar interface to the pandas DataFrame (as we will see in this tutorial), it does NOT include some of the pandas interface yet.","key":"FAVrmleanA"},{"type":"paragraph","children":[{"type":"text","value":"See the ","key":"kb4KMqpDK5"},{"type":"link","url":"https://docs.dask.org/en/stable/dataframe-api.html","children":[{"type":"text","value":"Dask DataFrame API documentation","key":"jJ6IcfX6DY"}],"urlSource":"https://docs.dask.org/en/stable/dataframe-api.html","key":"FHUA4JndCU"},{"type":"text","value":" for a compehnsive list of available functions.","key":"n2eW9L59K8"}],"key":"ZNde6mFItm"}],"key":"AtkRhoP25O"},{"type":"thematicBreak","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"m9HhCYUwP7"}],"key":"QtEdsvzPiW"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Tutorial Dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"izNuW01qXK"}],"identifier":"tutorial-dataset","label":"Tutorial Dataset","html_id":"tutorial-dataset","implicit":true,"key":"Yj3hnZtg0p"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In this tutorial, we are going to use the NOAA Global Historical Climatology Network Daily (GHCN-D) dataset.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YwaGJnXN0N"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KNjhDNx9k0"},{"type":"text","value":"GHCN-D is a public available dataset that includes daily climate records from +100,000 surface observations around the world.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"W8spBfKMpA"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JUd90g8gua"},{"type":"text","value":"This is an example of a real dataset that is used by NCAR scientists for their research. GHCN-D raw dataset for all stations is available through ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yhyfFgqB3J"},{"type":"link","url":"https://www.ncdc.noaa.gov/cdo-web/search?datasetid=GHCND","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"NOAA Climate Data Online","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"TdWGNqBz0Z"}],"urlSource":"https://www.ncdc.noaa.gov/cdo-web/search?datasetid=GHCND","key":"VDGLjuN7T6"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Fr9RAF2Ogq"}],"key":"Ot5NvfuA16"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"To learn more about GHCNd dataset, please visit:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"A5QPmwA4ok"}],"key":"gCRibg48CO"}],"key":"zUxQDIpNwL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://journals.ametsoc.org/view/journals/atot/29/7/jtech-d-11-00103_1.xml","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GHCNd Journal Paper","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uoeconqyjY"}],"urlSource":"https://journals.ametsoc.org/view/journals/atot/29/7/jtech-d-11-00103_1.xml","key":"jun8NGvCGf"}],"key":"b9qglKKJjZ"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"link","url":"https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"GHCNd Official Website","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NfecRs5lDT"}],"urlSource":"https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily","key":"zmSmDb66fB"}],"key":"MivIWYnxyo"}],"key":"jxUVRRwJWG"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Download the data","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AqygWUpUK4"}],"identifier":"download-the-data","label":"Download the data","html_id":"download-the-data","implicit":true,"key":"JAK1awA0iR"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"For this example, we are going to look through a subset of data from the GHCN-D dataset.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"JPbSNmg5Ov"}],"key":"Y9IlBGkVLo"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"First, we look at the daily observations from Denver International Airport, next we are going to look through selected stations in the US.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"RcnfRb0rb2"}],"key":"NRHd9ny1BR"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The access the preprocessed dataset for this tutorial, please run the following script:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"JmBbBeQ2i4"}],"key":"e0F1RQva1o"}],"visibility":"show","key":"vlQKSbjhiC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"!./get_data.sh","key":"OHxuLtuRTr"},{"type":"output","id":"kyMy1U7GGcNQrTduWZI6M","data":[{"output_type":"stream","name":"stdout","text":"Downloading https://docs.google.com/uc?export=download\u0026id=14doSRn8hT14QYtjZz28GKv14JgdIsbFF\r\n"},{"output_type":"stream","name":"stdout","text":"\r\ngzip: stdin: not in gzip format\r\ntar: Child returned status 1\r\ntar: Error is not recoverable: exiting now\r\nDownloading https://docs.google.com/uc?export=download\u0026id=15rCwQUxxpH6angDhpXzlvbe1nGetYHrf\r\n"},{"output_type":"stream","name":"stdout","text":"tar (child): data.tar.gz: Cannot open: No such file or directory\r\ntar (child): Error is not recoverable: exiting now\r\ntar: Child returned status 2\r\ntar: Error is not recoverable: exiting now\r\nrm: cannot remove 'data.tar.gz': No such file or directory\r\nDownloading https://docs.google.com/uc?export=download\u0026id=1Tbuom1KMCwHjy7-eexEQcOXSr51i6mae\r\n"},{"output_type":"stream","name":"stdout","text":"\r\ngzip: stdin: not in gzip format\r\ntar: Child returned status 1\r\ntar: Error is not recoverable: exiting now\r\n"}],"key":"MRgUQdkmg8"}],"key":"DBL7ilh1pZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This script should save the preprocessed GHCN-D data in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Npao2nHvCG"},{"type":"inlineCode","value":"../data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sWut1BSGIG"},{"type":"text","value":" path.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y3hOVKlGU5"}],"key":"t5rb64cbdF"}],"key":"qb8UzMpZsx"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mVF5yyaQpx"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Pandas DataFrame Basics","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rbtize3WYq"}],"identifier":"pandas-dataframe-basics","label":"Pandas DataFrame Basics","html_id":"pandas-dataframe-basics","implicit":true,"key":"liTdIxY6zN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s start with an example using pandas DataFrame.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lqzfieJYjE"}],"key":"YnM4XXIaKd"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"First, let’s read in the comma-seperated GHCN-D dataset for one station at ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZG9fmfz1KB"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Denver International Airport (DIA), CO","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vf1v3YvNCJ"}],"key":"ba1TQujQ4F"},{"type":"text","value":" (site ID : ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LfOvbqo4Pg"},{"type":"inlineCode","value":"USW00003017","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iy6RhcUvu5"},{"type":"text","value":").","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DUQKvdduSE"}],"key":"E5c3GKEY64"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To see the list of all available GHCN-D sites and their coordinates and IDs, please see ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SMMiyF4ToQ"},{"type":"link","url":"https://www.ncei.noaa.gov/pub/data/ghcn/daily/ghcnd-stations.txt","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"this link","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XACyAgVW1w"}],"urlSource":"https://www.ncei.noaa.gov/pub/data/ghcn/daily/ghcnd-stations.txt","key":"UzwfbcB877"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hb0hnuRKhN"}],"key":"jqvBZ6CERI"}],"key":"Bs1aSo12Vi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport pandas as pd\n\n# DIA ghcnd id\nsite = 'USW00003017'\ndata_dir = '../data/'\n\n\ndf = pd.read_csv(os.path.join(data_dir, site+'.csv'), parse_dates=['DATE'], index_col=0)","key":"ZatW8AKdW0"},{"type":"output","id":"_oy5WQfxONzhMMAou83I7","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mFileNotFoundError\u001b[39m                         Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[2]\u001b[39m\u001b[32m, line 9\u001b[39m\n\u001b[32m      5\u001b[39m site = \u001b[33m'\u001b[39m\u001b[33mUSW00003017\u001b[39m\u001b[33m'\u001b[39m\n\u001b[32m      6\u001b[39m data_dir = \u001b[33m'\u001b[39m\u001b[33m../data/\u001b[39m\u001b[33m'\u001b[39m\n\u001b[32m----\u003e \u001b[39m\u001b[32m9\u001b[39m df = \u001b[43mpd\u001b[49m\u001b[43m.\u001b[49m\u001b[43mread_csv\u001b[49m\u001b[43m(\u001b[49m\u001b[43mos\u001b[49m\u001b[43m.\u001b[49m\u001b[43mpath\u001b[49m\u001b[43m.\u001b[49m\u001b[43mjoin\u001b[49m\u001b[43m(\u001b[49m\u001b[43mdata_dir\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43msite\u001b[49m\u001b[43m+\u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43m.csv\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparse_dates\u001b[49m\u001b[43m=\u001b[49m\u001b[43m[\u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mDATE\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mindex_col\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m0\u001b[39;49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/parsers/readers.py:1026\u001b[39m, in \u001b[36mread_csv\u001b[39m\u001b[34m(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)\u001b[39m\n\u001b[32m   1013\u001b[39m kwds_defaults = _refine_defaults_read(\n\u001b[32m   1014\u001b[39m     dialect,\n\u001b[32m   1015\u001b[39m     delimiter,\n\u001b[32m   (...)\u001b[39m\u001b[32m   1022\u001b[39m     dtype_backend=dtype_backend,\n\u001b[32m   1023\u001b[39m )\n\u001b[32m   1024\u001b[39m kwds.update(kwds_defaults)\n\u001b[32m-\u003e \u001b[39m\u001b[32m1026\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43m_read\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfilepath_or_buffer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mkwds\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/parsers/readers.py:620\u001b[39m, in \u001b[36m_read\u001b[39m\u001b[34m(filepath_or_buffer, kwds)\u001b[39m\n\u001b[32m    617\u001b[39m _validate_names(kwds.get(\u001b[33m\"\u001b[39m\u001b[33mnames\u001b[39m\u001b[33m\"\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m))\n\u001b[32m    619\u001b[39m \u001b[38;5;66;03m# Create the parser.\u001b[39;00m\n\u001b[32m--\u003e \u001b[39m\u001b[32m620\u001b[39m parser = \u001b[43mTextFileReader\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfilepath_or_buffer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwds\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    622\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m chunksize \u001b[38;5;129;01mor\u001b[39;00m iterator:\n\u001b[32m    623\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m parser\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/parsers/readers.py:1620\u001b[39m, in \u001b[36mTextFileReader.__init__\u001b[39m\u001b[34m(self, f, engine, **kwds)\u001b[39m\n\u001b[32m   1617\u001b[39m     \u001b[38;5;28mself\u001b[39m.options[\u001b[33m\"\u001b[39m\u001b[33mhas_index_names\u001b[39m\u001b[33m\"\u001b[39m] = kwds[\u001b[33m\"\u001b[39m\u001b[33mhas_index_names\u001b[39m\u001b[33m\"\u001b[39m]\n\u001b[32m   1619\u001b[39m \u001b[38;5;28mself\u001b[39m.handles: IOHandles | \u001b[38;5;28;01mNone\u001b[39;00m = \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[32m-\u003e \u001b[39m\u001b[32m1620\u001b[39m \u001b[38;5;28mself\u001b[39m._engine = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_make_engine\u001b[49m\u001b[43m(\u001b[49m\u001b[43mf\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mengine\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/parsers/readers.py:1880\u001b[39m, in \u001b[36mTextFileReader._make_engine\u001b[39m\u001b[34m(self, f, engine)\u001b[39m\n\u001b[32m   1878\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[33m\"\u001b[39m\u001b[33mb\u001b[39m\u001b[33m\"\u001b[39m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m mode:\n\u001b[32m   1879\u001b[39m         mode += \u001b[33m\"\u001b[39m\u001b[33mb\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m-\u003e \u001b[39m\u001b[32m1880\u001b[39m \u001b[38;5;28mself\u001b[39m.handles = \u001b[43mget_handle\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   1881\u001b[39m \u001b[43m    \u001b[49m\u001b[43mf\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1882\u001b[39m \u001b[43m    \u001b[49m\u001b[43mmode\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1883\u001b[39m \u001b[43m    \u001b[49m\u001b[43mencoding\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43moptions\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mencoding\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1884\u001b[39m \u001b[43m    \u001b[49m\u001b[43mcompression\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43moptions\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mcompression\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1885\u001b[39m \u001b[43m    \u001b[49m\u001b[43mmemory_map\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43moptions\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mmemory_map\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1886\u001b[39m \u001b[43m    \u001b[49m\u001b[43mis_text\u001b[49m\u001b[43m=\u001b[49m\u001b[43mis_text\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1887\u001b[39m \u001b[43m    \u001b[49m\u001b[43merrors\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43moptions\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mencoding_errors\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mstrict\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1888\u001b[39m \u001b[43m    \u001b[49m\u001b[43mstorage_options\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43moptions\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mstorage_options\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1889\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1890\u001b[39m \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28mself\u001b[39m.handles \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[32m   1891\u001b[39m f = \u001b[38;5;28mself\u001b[39m.handles.handle\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/dask-cookbook/lib/python3.13/site-packages/pandas/io/common.py:873\u001b[39m, in \u001b[36mget_handle\u001b[39m\u001b[34m(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)\u001b[39m\n\u001b[32m    868\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(handle, \u001b[38;5;28mstr\u001b[39m):\n\u001b[32m    869\u001b[39m     \u001b[38;5;66;03m# Check whether the filename is to be opened in binary mode.\u001b[39;00m\n\u001b[32m    870\u001b[39m     \u001b[38;5;66;03m# Binary mode does not support 'encoding' and 'newline'.\u001b[39;00m\n\u001b[32m    871\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m ioargs.encoding \u001b[38;5;129;01mand\u001b[39;00m \u001b[33m\"\u001b[39m\u001b[33mb\u001b[39m\u001b[33m\"\u001b[39m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m ioargs.mode:\n\u001b[32m    872\u001b[39m         \u001b[38;5;66;03m# Encoding\u001b[39;00m\n\u001b[32m--\u003e \u001b[39m\u001b[32m873\u001b[39m         handle = \u001b[38;5;28;43mopen\u001b[39;49m\u001b[43m(\u001b[49m\n\u001b[32m    874\u001b[39m \u001b[43m            \u001b[49m\u001b[43mhandle\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    875\u001b[39m \u001b[43m            \u001b[49m\u001b[43mioargs\u001b[49m\u001b[43m.\u001b[49m\u001b[43mmode\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    876\u001b[39m \u001b[43m            \u001b[49m\u001b[43mencoding\u001b[49m\u001b[43m=\u001b[49m\u001b[43mioargs\u001b[49m\u001b[43m.\u001b[49m\u001b[43mencoding\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    877\u001b[39m \u001b[43m            \u001b[49m\u001b[43merrors\u001b[49m\u001b[43m=\u001b[49m\u001b[43merrors\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    878\u001b[39m \u001b[43m            \u001b[49m\u001b[43mnewline\u001b[49m\u001b[43m=\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[32m    879\u001b[39m \u001b[43m        \u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    880\u001b[39m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    881\u001b[39m         \u001b[38;5;66;03m# Binary mode\u001b[39;00m\n\u001b[32m    882\u001b[39m         handle = \u001b[38;5;28mopen\u001b[39m(handle, ioargs.mode)\n\n\u001b[31mFileNotFoundError\u001b[39m: [Errno 2] No such file or directory: '../data/USW00003017.csv'","ename":"FileNotFoundError","evalue":"[Errno 2] No such file or directory: '../data/USW00003017.csv'"}],"key":"Y8JSfvZ7lg"}],"key":"cBDObOZAtM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Display the top five rows of the dataframe\ndf.head()","key":"n09SHTILIp"},{"type":"output","id":"T4i99m8492MPU1C5vIu-n","data":[],"key":"oaaIl63SIV"}],"key":"JgL1TqsDU3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PfgbwyNVvc"}],"key":"urUR2LVn4S"},{"type":"text","value":" What variables are available?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"StPyiGn1eX"}],"key":"upzQp0qo9E"}],"key":"anKfg04cOr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df.columns","key":"MeQbUCQPSX"},{"type":"output","id":"_JH_YJSiZZAdTEsdRas5S","data":[],"key":"Als9v15SyL"}],"key":"gRDqcZGZV0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The description and units of the dataset is available ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qit2jD6SV9"},{"type":"link","url":"https://www.ncei.noaa.gov/pub/data/ghcn/daily/readme.txt","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wd2ldVc1Ue"}],"urlSource":"https://www.ncei.noaa.gov/pub/data/ghcn/daily/readme.txt","key":"RjnQDNtEqc"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yh8dKhOXQe"}],"key":"dCxwAi7TkD"}],"key":"KGKWNIT89g"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Operations on pandas DataFrame","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DpVZ6hdt0M"}],"identifier":"operations-on-pandas-dataframe","label":"Operations on pandas DataFrame","html_id":"operations-on-pandas-dataframe","implicit":true,"key":"DcoUyoCGn2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"pandas DataFrames has several features that give us flexibility to do different calculations and analysis on our dataset. Let’s check some out:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZFRZIbuFNA"}],"key":"UvHgr2MJ2r"},{"type":"heading","depth":4,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Simple Analysis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sEGmid3QTx"}],"identifier":"simple-analysis","label":"Simple Analysis","html_id":"simple-analysis","implicit":true,"key":"bdKeENWZaI"}],"key":"MuyaGYx7sv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For example:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xyFQigIEYK"}],"key":"tMcRl8B3Hh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"When was the coldest day at this station during December of last year?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RlTyUhk28U"}],"key":"FzKhX4VWxU"}],"key":"C1J62IJFJB"}],"key":"CUpA4FHACa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# use python slicing notation inside .loc \n# use idxmin() to find the index of minimum valus\ndf.loc['2022-12-01':'2022-12-31'].TMIN.idxmin()","key":"tWaBKWUQQj"},{"type":"output","id":"SxcHTgAYOqeXuJv8h6PH8","data":[],"key":"IrSG3Dmse0"}],"key":"OKiG51BviZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Here we easily plot the prior data using matplotlib from pandas\n# -- .loc for value based indexing\ndf.loc['2022-12-01':'2022-12-31'].SNWD.plot(ylabel= 'Daily Average Snow Depth [mm]')","key":"wdTwOJVN0n"},{"type":"output","id":"f0HOWTjDMI4EOuE5tIFmN","data":[],"key":"m8xufah8Tk"}],"key":"BvzZOTHE0B"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"How many snow days do we have each year at this station?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M75lG3GW06"}],"key":"D3QvjhK5j7"}],"key":"AJYe3592od"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Pandas groupby is used for grouping the data according to the categories.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"y9jpCO5jLQ"}],"key":"lHf91bAU7V"}],"key":"rC277vN0iC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 1- First select days with snow \u003e 0\n# 2- Create a \"groupby object\" based on the selected columns\n# 3- use .size() to compute the size of each group\n# 4- sort the values descending \n\n# we count days where SNOW\u003e0, and sort them and show top 5 years:\ndf[df['SNOW']\u003e0].groupby('YEAR').size().sort_values(ascending=False).head()\n","key":"h9C9xsecq1"},{"type":"output","id":"_22i7zfSfoiq2Q-w4a5aO","data":[],"key":"HMqe3M7z7h"}],"key":"dDkQmkJm4f"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Or for a more complex analysis:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kruGyYQKMD"}],"key":"iguIJYHGyQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For example, we have heard that this could be Denver’s first January in 13 years with no 60-degree days.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UX1qgLdrkK"}],"key":"dwYEJx9MRY"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"image","url":"/dask-cookbook/build/576ee6c7ccc2f9c50f73ce145e8f7592.png","alt":"News article showing that this January is abnormally warm","key":"dJ2z09Y591","urlSource":"https://raw.githubusercontent.com/ProjectPythia/dask-cookbook/main/notebooks/images/denver.png"}],"key":"FPaFACWrQV"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Below, we show all days with high temperature above 60°F (155.5°C/10) since 2010:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"chEBysJC3q"}],"key":"M52bgU8XTY"}],"key":"PVfIiFYm34"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df[(df['MONTH']==1) \u0026 (df['YEAR']\u003e=2010) \u0026 (df['TMAX']\u003e155.5)].groupby(['YEAR']).size()","key":"hMBIjcO6EL"},{"type":"output","id":"gr2LC948hMbZYdcnxHSyE","data":[],"key":"cCCZFE6k4O"}],"key":"qc3fv4VrCc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is great! But how big is this dataset for one station?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fcXLnN4z59"}],"key":"uBSAuufSi4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"First, let’s check the file size:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ORyJrGo5dX"}],"key":"rvLZn2QjPY"}],"key":"JrQO6NvkPb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"!ls -lh ../data/USW00003017.csv","key":"fwFrrvp0Vm"},{"type":"output","id":"TxuvDgKxWKD7exp6f_psV","data":[],"key":"z0hp311upp"}],"key":"mFeA9eG3II"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Similar to the previous tutorial, we can use the following function to find the size of a variable on memory.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VFbID0CuIa"}],"key":"fEXKVFSt5C"}],"key":"EZIZMxTc8Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define function to display variable size in MB\nimport sys\ndef var_size(in_var):\n    result = sys.getsizeof(in_var) / 1e6\n    print(f\"Size of variable: {result:.2f} MB\")","key":"N9Upr4drsf"},{"type":"output","id":"UxZ4a7HN-F7xGi871vLTN","data":[],"key":"RC3fu9qUY7"}],"key":"bW2dpHl5FW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"var_size(df)","key":"nLAIGBadu0"},{"type":"output","id":"U7a9HxJvJbbEe5-aNBvi_","data":[],"key":"IPk5iM9ZNY"}],"key":"ehIQ7kRQwT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Remember, the above rule?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hrODmh6ZbT"}],"key":"IMcRqDrOFD"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"definitionList","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"definitionTerm","position":{"start":{"line":3,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"“Have 5 to 10 times as much RAM as the size of your dataset”","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dHUxJi9jfZ"}],"key":"g3SktubpWb"},{"type":"definitionDescription","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Wes McKinney (2017) in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rwweLR32mY"},{"type":"link","url":"https://wesmckinney.com/blog/apache-arrow-pandas-internals/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"10 things I hate about pandas","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VDO7H5UF63"}],"urlSource":"https://wesmckinney.com/blog/apache-arrow-pandas-internals/","key":"og7CLSXB0s"}],"key":"Ylzx4SkNrM"}],"key":"I4ZmmYFV2v"}],"key":"LMoWtRm3T1"}],"key":"QGJHf2iuE4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So far, we read in and analyzed data for one station. We have a total of +118,000 stations over the world and +4500 stations in Colorado alone!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cIzwV2H4EZ"}],"key":"gMeivfw0Bx"}],"key":"ogNmi3FVgK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"What if we want to look at the larger dataset?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N5FZEWqzjn"}],"key":"XBV5Txtuyh"}],"key":"CfYbeNmW11"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Scaling up to a larger dataset","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kjXO32dtyJ"}],"identifier":"scaling-up-to-a-larger-dataset","label":"Scaling up to a larger dataset","html_id":"scaling-up-to-a-larger-dataset","implicit":true,"key":"eAsU7GMt72"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Let’s start by reading data from selected stations. The downloaded data for this example includes the climatology observations from 66 selected sites in Colorado.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kw0CPct3hv"}],"key":"lCsn018E4O"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Pandas can concatenate data to load data spread across multiple files:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"LuvfJ35q83"}],"key":"ihGvMZtUMT"}],"key":"JxOFdFIqo4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"!du -csh ../data/*.csv |tail -n1","key":"iugq4eWnVP"},{"type":"output","id":"73CVSluDF9OhGrnhCx2JM","data":[],"key":"x0A8kYETQf"}],"key":"kAEhZWAD8A"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using a for loop with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xzAICqLwUT"},{"type":"inlineCode","value":"pandas.concat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XTjEiM9jwj"},{"type":"text","value":", we can read multiple files at the same time:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vdn8RyF1c3"}],"key":"wr1vrd2Z91"}],"key":"DtYGp2McZo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nimport glob\nco_sites = glob.glob(os.path.join(data_dir, '*.csv'))\ndf = pd.concat(pd.read_csv(f, index_col=0, parse_dates=['DATE']) for f in co_sites)","key":"fz38pJQ0Cp"},{"type":"output","id":"YW9HIf8o9WbwG8k6NEetv","data":[],"key":"OvszHKw6mh"}],"key":"m6Qf5BydBK"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"How many stations have we read in?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mZWjor9n6N"}],"key":"WXBR0zgfsl"}],"key":"hSZqSscAAA"}],"key":"ivwBy2FAXF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print (\"Concatenated data for\", len(df.ID.unique()), \"unique sites.\")","key":"E0g05hQOm8"},{"type":"output","id":"MhlOKhtQa60C765HMtFmB","data":[],"key":"Hu2LQpAYcc"}],"key":"OAvE5y0rSJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now that we concatenated the data for all sites in one DataFrame, we can do similar analysis on it:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oAT4QphhKl"}],"key":"LEtcA2NLss"}],"key":"OQ0g2cKMKa"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Which site has recorded the most snow days in a year?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I7nheHpEgw"}],"key":"bT0ifr8Mnp"}],"key":"x0ImLOPZg0"}],"key":"EkvPvUP6Dj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# ~90s on 4GB RAM\nsnowy_days = df[df['SNOW']\u003e0].groupby(['ID','YEAR']).size()\n\nprint ('This site has the highest number of snow days in a year : ')\nsnowy_days.agg(['idxmax','max'])","key":"KOAbi1z7uD"},{"type":"output","id":"SUoBE7Rc3TyNWB0HMAYep","data":[],"key":"BPy1Q31rOJ"}],"key":"Z5OLtIHlhc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Excersise:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cymO37jIjB"}],"key":"U3Pr1KeJnJ"},{"type":"text","value":" Which Colorado site has recorded the most snow days in 2023?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y7lW7FLRRO"}],"key":"juG0kYujLA"}],"key":"uew72JwNxj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dask allows us to conceptualize all of these files as a single dataframe!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kZxCAj0lbi"}],"key":"Rl3zJaWYSp"}],"key":"ELdHXZqWQB"}],"key":"B9d5yarpF5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Let's do a little cleanup\ndel df, snowy_days","key":"OaN275ltsQ"},{"type":"output","id":"IGAvLGmxMxkP7IH9730te","data":[],"key":"kQxFu9GuoV"}],"key":"T8UlVyNENY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Computations on Dask DataFrame","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aIACIdLAlf"}],"identifier":"computations-on-dask-dataframe","label":"Computations on Dask DataFrame","html_id":"computations-on-dask-dataframe","implicit":true,"key":"hNRpEesGu3"}],"key":"caqRH33zzm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a “LocalCluster” Client with Dask","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"czodamrZsP"}],"identifier":"create-a-localcluster-client-with-dask","label":"Create a “LocalCluster” Client with Dask","html_id":"create-a-localcluster-client-with-dask","implicit":true,"key":"x2wYM6axKC"}],"key":"U3jEBCfjCG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from dask.distributed import Client, LocalCluster\n\ncluster = LocalCluster()\nclient = Client(cluster)\nclient","key":"yy3K88NOze"},{"type":"output","id":"tQOLhGI5LpXueX2rveN0o","data":[],"key":"H7UKufBuzc"}],"key":"S131vRRfxY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"☝️ Click the Dashboard link above.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lO2NBS3a5J"}],"key":"Qbdh1RmPvH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"👈 Or click the “Search” 🔍 button in the dask-labextension dashboard.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d135pgRHgS"}],"key":"X1FJglnFzh"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Dask DataFrame ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oOiQR4ClUt"},{"type":"inlineCode","value":"read_csv","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"C8zo5RzCC7"},{"type":"text","value":" to read multiple files","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZvtlGKGnrZ"}],"identifier":"dask-dataframe-read-csv-to-read-multiple-files","label":"Dask DataFrame read_csv to read multiple files","html_id":"dask-dataframe-read-csv-to-read-multiple-files","implicit":true,"key":"xSAR4x36YU"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"dask.dataframe.read_csv","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uh3aFyKDhG"},{"type":"text","value":" function can be used in conjunction with ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eWEfDCgueX"},{"type":"inlineCode","value":"glob","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KgfetU142A"},{"type":"text","value":" to read multiple csv files at the same time.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nnBGPjc3VS"}],"key":"Ad450AA5CY"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Remember we can read one file with ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"T5aJtMcblg"},{"type":"inlineCode","value":"pandas.read_csv","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"wCYPzwGea5"},{"type":"text","value":". For reading multiple files with pandas, we have to concatenate them with ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"xqoELmJ1nQ"},{"type":"inlineCode","value":"pd.concatenate","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gMDsVDqIyw"},{"type":"text","value":". However, we can read many files at once just using ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"LwctBIugKG"},{"type":"inlineCode","value":"dask.dataframe.read_csv","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VJMpBkIVei"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"toDO70FsMd"}],"key":"a3PwmBgXNS"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Overall, Dask is designed to perform I/O in parallel and is more performant than pandas for operations with multiple files or large files.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"O8X4cy2O9C"}],"key":"z6yhm2YQrA"}],"key":"xDpCQVQNrZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nimport dask\nimport dask.dataframe as dd\n\nddf = dd.read_csv(co_sites, parse_dates=['DATE'])\nddf","key":"qPBJ8P189V"},{"type":"output","id":"b8AvhhcpVqDyvajwA9a_A","data":[],"key":"YeFijGZT8t"}],"key":"gPXfZFHfH2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ddf.TMAX.mean()","key":"V9fEo9NOj3"},{"type":"output","id":"bJh5oV_t-f5DCPyatkQ3O","data":[],"key":"Y4jrzacRtD"}],"key":"qTXpOOnEmH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notice that the representation of the DataFrame object contains no data just headers and datatypes.  Why?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xitb8ll1w0"}],"key":"Htz7G9N4Rh"}],"key":"EHOgBkmpkB"},{"type":"heading","depth":4,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Lazy Evaluation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BigT0NQ8qg"}],"identifier":"lazy-evaluation","label":"Lazy Evaluation","html_id":"lazy-evaluation","implicit":true,"key":"xJAB0quEQ1"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Similar to Dask Arrays, Dask DataFrames are lazy. Here the data has not yet been read into the dataframe yet (a.k.a. lazy evaluation).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"p8vtyNVbU6"},{"type":"break","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"brGQ8gbviK"},{"type":"text","value":"Dask just construct the task graph of the computation but it will “evaluate” them only when necessary.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uMPXC2dBxg"}],"key":"Bz5yuuZZk7"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"So how does Dask know the name and dtype of each column?","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"eEriHmPpsY"}],"key":"NEPxlLWNHy"}],"key":"tVSIMSy347"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Dask has just read the start of the first file and infers the column names and dtypes.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"m9kjj7hU7l"}],"key":"e1g9cRLHT7"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Unlike ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"OVHbkzbl1b"},{"type":"inlineCode","value":"pandas.read_csv","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Q0dG6AtBKS"},{"type":"text","value":" that reads in all files before inferring data types, ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"GbDrR2GEPZ"},{"type":"inlineCode","value":"dask.dataframe.read_csv","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"r3uUGI9wUF"},{"type":"text","value":" only reads in a sample from the beginning of the file (or first file if using a glob). The column names and dtypes are then enforced when reading the specific partitions (","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Wm5uFD6vWv"},{"type":"emphasis","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Dask can make mistakes on these inferences if there is missing or misleading data in the early rows","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PJq58a3NEA"}],"key":"ffzkCp1rJK"},{"type":"text","value":").","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"UtcqU4sP2b"}],"key":"kodn3wr3Vq"}],"key":"kA6PKrYzpg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s take a look at the start of our dataframe:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nc1vzs2UyX"}],"key":"LwooeNXD4E"}],"key":"nTP362J8iR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ddf.head()","key":"FC0T2rSxUT"},{"type":"output","id":"2tDrrdcB54NCFHBjCpqXF","data":[],"key":"nWC8qMBsQq"}],"key":"F5PKhrlpDI"},{"type":"block","kind":"notebook-content","children":[{"type":"div","class":"alert alert-block alert-info","children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"NOTE:","key":"WzufoiRuFx"}],"key":"KuSbbsyShM"},{"type":"text","value":" Whenever we operate on our dataframe we read through all of our CSV data so that we don’t fill up RAM. Dask will delete intermediate results (like the full pandas DataFrame for each file) as soon as possible. This enables you to handle larger than memory datasets but, repeated computations will have to load all of the data in each time.","key":"UIHFXwwC17"}],"key":"Z5mV7nSoNa"}],"key":"JLRCyZ0qtZ"}],"key":"L877DGRzsA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Similar data manipulations as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dd3zfOPyPA"},{"type":"inlineCode","value":"pandas.dataframe","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"akdOnLI4Vz"},{"type":"text","value":" can be done for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FfIyy5fyAe"},{"type":"inlineCode","value":"dask.dataframes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zKc7xmiRyh"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FWAz3tBQk9"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mJkByGHgsO"},{"type":"text","value":"For example, let’s find the highest number of snow days in Colorado:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mf3cKacIrb"}],"key":"hPLzBytsSL"}],"key":"AlRtMLTT5Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nprint ('This site has the highest number of snow days in a year : ')\nsnowy_days = ddf[ddf['SNOW']\u003e0].groupby(['ID','YEAR']).size()\nsnowy_days.compute().agg(['idxmax','max'])","key":"UDURrXHmYX"},{"type":"output","id":"eIGxakpAs_XzjJEMQbCk9","data":[],"key":"eI4ZgTOGsf"}],"key":"zN1EI5GGXm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Nice, but what did Dask do?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FvfiiGNqoM"}],"identifier":"nice-but-what-did-dask-do","label":"Nice, but what did Dask do?","html_id":"nice-but-what-did-dask-do","implicit":true,"key":"msZggUNl0O"}],"key":"RgSGHrfrPE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Requires ipywidgets\n\nsnowy_days.dask","key":"mOVOz2fq2H"},{"type":"output","id":"wsBe6o_XOGOU0j4R150DC","data":[],"key":"ie4R5H1RJX"}],"key":"PFdNyt28o8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can also view the underlying task graph using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oy6gfhc6mY"},{"type":"inlineCode","value":".visualize()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gFluQeAPdh"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uyWonJVfbw"}],"key":"IDn3LjLNgK"}],"key":"iip5aEKOro"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#graph is too large\nsnowy_days.visualize()","key":"uEQxZTukoj"},{"type":"output","id":"nM_ECT98gWBMKZ4X0vi47","data":[],"key":"ZnU1fEkD99"}],"key":"eXuch1fIKj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xVDqxWWG6j"},{"type":"inlineCode","value":".compute","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QMH2cJbKad"},{"type":"text","value":" wisely!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"REH9mK8APi"}],"identifier":"use-compute-wisely","label":"Use .compute wisely!","html_id":"use-compute-wisely","implicit":true,"key":"Nf602VnyVA"},{"type":"heading","depth":4,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Share intermediate results","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FbBZZjmiaC"}],"identifier":"share-intermediate-results","label":"Share intermediate results","html_id":"share-intermediate-results","implicit":true,"key":"cEtxJjDPof"}],"key":"GY1afi45xa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For most operations, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sJBxWmlpcW"},{"type":"inlineCode","value":"dask.dataframe","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZX1iGmAZdw"},{"type":"text","value":" hashes the arguments, allowing duplicate computations to be shared, and only computed once.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gakh4TG6tb"}],"key":"IUioefq5mQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For example, let’s compute the mean and standard deviation for Maximum daily temperature of all snow days.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Uw9wZADnLU"}],"key":"pv7mnbNjkc"}],"key":"WBGIkgtOKw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"snowy_days = ddf[ddf['SNOW']\u003e0]\nmean_tmax = snowy_days.TMAX.mean()\nstd_tmax = snowy_days.TMAX.std()","key":"HDsewXF8D5"},{"type":"output","id":"N-wFnnuHLlkc4KGoxNu22","data":[],"key":"g3CbZJzcUh"}],"key":"KooaBlaIJV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nmean_tmax_result = mean_tmax.compute()\nstd_tmax_result = std_tmax.compute()","key":"BHTlY7HHNh"},{"type":"output","id":"5pwtng2gqD6Iyz9T_adMq","data":[],"key":"Osz6QHoETk"}],"key":"AOawhOkNut"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"But if we pass both arguments in a single ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BqahVDuDv0"},{"type":"inlineCode","value":".compute","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pzy8PfggK2"},{"type":"text","value":", we can share the intermediate results:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jg8BqjxUqn"}],"key":"Ld8E0GIWS1"}],"key":"wtrGdu0cE8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nmean_tmax_result, std_tmax_result = dask.compute(mean_tmax, std_tmax)","key":"S7vX7ZhNCZ"},{"type":"output","id":"ZZ5nVAqTaTZme9twWwssZ","data":[],"key":"nNrrMOtmA0"}],"key":"ZVdBmwYOxJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FjT3ggQ8nj"},{"type":"inlineCode","value":"dask.compute","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LL7Pi5iLHs"},{"type":"text","value":" only one allowed sharing intermediate results between TMAX mean and median calculations and improved total performance.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jhGznjALad"}],"key":"hTEKH6M9E2"}],"key":"WJymuccrwN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mean_tmax.dask","key":"CXLlAk2ehi"},{"type":"output","id":"Lt5m3axG-8Ve_a3OO3Ry6","data":[],"key":"pvCrMNWKC3"}],"key":"tyySpuQCqM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here some operations such as the calls to read the csv files, the filtering, and the grouping is exactly similar between both operations, so they can share intermediate results. Remember, Dask will delete intermediate results (like the full pandas DataFrame for each file) as soon as possible.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AU0l1DGpA8"}],"key":"I8csIW6rLx"}],"key":"j7UaEwOGOS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":".persist","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CCmlUTQ6nw"},{"type":"text","value":" or caching","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D7zlvoIGqI"}],"identifier":"id-persist-or-caching","label":".persist or caching","html_id":"id-persist-or-caching","implicit":true,"key":"JB16e0ngAY"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Sometimes you might want your computers to keep intermediate results in memory, if it fits in the memory.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SEp5SaZJwM"}],"key":"qTxnqA5GiH"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WVszZjnwYe"},{"type":"inlineCode","value":".persist()","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZbQz6fFG1p"},{"type":"text","value":" method can be used to  “cache” data and tell Dask what results to keep around. You should only use ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Ve9r4F4IHj"},{"type":"inlineCode","value":".persist()","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"qVH51eHbsw"},{"type":"text","value":" with any data or computation that fits in memory.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bZocrN6Dv1"}],"key":"zM8Xmh9PKl"}],"key":"BhyY2HvlZB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For example, if we want to only do analysis on a subset of data (for example snow days at Boulder site):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J23rtEi17U"}],"key":"LvtBfGIoY4"}],"key":"m6Sfv6OAYE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"boulder_snow = ddf[(ddf['SNOW']\u003e0)\u0026(ddf['ID']=='USC00050848')]","key":"jtISidX4UG"},{"type":"output","id":"4gdtUGjEntDUMUZ2TbHLh","data":[],"key":"CJaSrYDn55"}],"key":"jVZV4N0MRF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\ntmax = boulder_snow.TMAX.mean().compute()\ntmin = boulder_snow.TMIN.mean().compute()\n\nprint (tmin, tmax)","key":"waMYpiIxgf"},{"type":"output","id":"Y19Z_LYoGKSwEjoNHyH47","data":[],"key":"FSYxIYZIBD"}],"key":"xTcjWkigbl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"boulder_snow = ddf[(ddf['SNOW']\u003e0)\u0026(ddf['ID']=='USC00050848')].persist()","key":"IXi3V7v6K1"},{"type":"output","id":"dACHAh0R6rd0N9AihS_e-","data":[],"key":"Bxn9Pc4DpJ"}],"key":"uOh8K4VJJw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\ntmax = boulder_snow.TMAX.mean().compute()\ntmin = boulder_snow.TMIN.mean().compute()\nprint (tmin, tmax)","key":"LzS6elyJOT"},{"type":"output","id":"rTO7rr3MmwpOAokTvtcHO","data":[],"key":"DyuqDvHJnK"}],"key":"DUhc0D3swB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see the analysis on this persisted data is much faster because we are not repeating the loading and selecting.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TYLKrzmusA"}],"key":"HJAC7fMRqs"}],"key":"alWAQukJB5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dask DataFrames Best Practices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KcXhi5Nu04"}],"identifier":"dask-dataframes-best-practices","label":"Dask DataFrames Best Practices","html_id":"dask-dataframes-best-practices","implicit":true,"key":"yCqDYOMEOG"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Use pandas (when you can)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NQYblk8HNW"}],"identifier":"use-pandas-when-you-can","label":"Use pandas (when you can)","html_id":"use-pandas-when-you-can","implicit":true,"key":"RszST1OJgI"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"For data that fits into RAM, pandas can often be easier and more efficient to use than Dask DataFrame. However, Dask DataFrame is a powerful tool for larger-than-memory datasets.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hD7yBu2WX3"}],"key":"sXUdfsrhFk"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"When the data is still larger than memory, Dask DataFrame can be used to ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hP08r8bIdA"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"reduce","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"i82upPBG5i"}],"key":"UPaswbKHDv"},{"type":"text","value":" the larger datasets to a manageable level that pandas can handle. Next, use pandas at that point.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xEmtzCJcfd"}],"key":"ko7VhUjkDL"},{"type":"heading","depth":3,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Avoid Full-Data Shuffling","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"gnYDoK31xe"}],"identifier":"avoid-full-data-shuffling","label":"Avoid Full-Data Shuffling","html_id":"avoid-full-data-shuffling","implicit":true,"key":"Ri4BcCtv3C"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Some operations are more expensive to compute in a parallel setting than if they are in-memory on a single machine (for example, ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hKKA4cH05I"},{"type":"inlineCode","value":"set_index","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jws3NyzJvr"},{"type":"text","value":" or ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XNpuAyFiL6"},{"type":"inlineCode","value":"merge","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"eJdMklbDmM"},{"type":"text","value":"). In particular, ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"WvSfrkGXqF"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"shuffling","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vSpNGL5Pol"}],"key":"Xr8GQ4yJ83"},{"type":"text","value":" operations that rearrange data can become very communication intensive.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jzn9AtLJ4K"}],"key":"vpEpFXbw1f"},{"type":"heading","depth":3,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"pandas performance tips","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"zoyxjt9KMC"}],"identifier":"pandas-performance-tips","label":"pandas performance tips","html_id":"pandas-performance-tips","implicit":true,"key":"lV4mmYP2xq"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"pandas performance tips such as using vectorized operations also apply to Dask DataFrames. See ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"N8QHxdOML7"},{"type":"link","url":"https://github.com/TomAugspurger/effective-pandas/blob/master/modern_1_intro.ipynb","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Modern Pandas notebook","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"XVVZYHRBPF"}],"urlSource":"https://github.com/TomAugspurger/effective-pandas/blob/master/modern_1_intro.ipynb","data":{"kind":"file","org":"TomAugspurger","repo":"effective-pandas","reference":"master","file":"modern_1_intro.ipynb","raw":"https://raw.githubusercontent.com/TomAugspurger/effective-pandas/master/modern_1_intro.ipynb"},"internal":false,"protocol":"github","key":"wly169RjIm"},{"type":"text","value":" for more tips on better performance with pandas.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"fNqAhPzvu3"}],"key":"b0ADQf6Ft8"},{"type":"heading","depth":3,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Check Partition Size","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"hY7MpvcIUm"}],"identifier":"check-partition-size","label":"Check Partition Size","html_id":"check-partition-size","implicit":true,"key":"q0VVgicFpo"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Similar to chunks, partitions should be small enough that they fit in the memory, but large enough to avoid that the communication overhead.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"B6MyWISUUk"}],"key":"KhLnsGZwPv"},{"type":"heading","depth":4,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"inlineCode","value":"blocksize","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"cdqtQ9I2ok"}],"identifier":"blocksize","label":"blocksize","html_id":"blocksize","implicit":true,"key":"oJNuy2WNpV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"The number of partitions can be set using the ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"hFTJ9WTsKx"},{"type":"inlineCode","value":"blocksize","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"nsB1g0OHf8"},{"type":"text","value":" argument.\nIf none is given, the number of partitions/blocksize is calculated depending on the available memory and the number of cores on a machine up to a max of 64 MB. As we increase the blocksize, the number of partitions (calculated by Dask) will decrease. This is especially important when reading one large csv file.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"T87IsJx3F1"}],"key":"VoJ62DbHuB"}],"key":"MhFKBLxi5x"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"As a good rule of thumb, you should aim for partitions that have around 100MB of data each.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"D24NnbBBKS"}],"key":"VucfeonBEg"}],"key":"BDBtSaEFjS"},{"type":"heading","depth":3,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Smart use of ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"vPr7lK3Mae"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"aDZdSaFRYs"}],"identifier":"smart-use-of-compute","label":"Smart use of .compute()","html_id":"smart-use-of-compute","implicit":true,"key":"g74oqhNVqp"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Try avoiding running ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"R1XXQ7I2Xy"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"FD5HTJCgfr"},{"type":"text","value":" operation as long as possible. Dask works best when users avoid computation until results are needed. The ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ips4BJWhne"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"cF7arLf9Pm"},{"type":"text","value":" command informs Dask to trigger computations on the Dask DataFrame.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"cjaiy1IFvq"},{"type":"break","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"GRABRUY5Iy"},{"type":"text","value":"As shown in the above example, the intermediate results can also be shared by calling ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"icwYMrtmuc"},{"type":"inlineCode","value":".compute()","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"QIbVcxwXMu"},{"type":"text","value":" only once.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"bB95gVknxY"}],"key":"LpkA8swwST"}],"key":"YuvuH9SVPo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Close your local Dask Cluster","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mv36HxcP79"}],"identifier":"close-your-local-dask-cluster","label":"Close your local Dask Cluster","html_id":"close-your-local-dask-cluster","implicit":true,"key":"YzT5YuTeNW"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"It is always a good practice to close the Dask cluster you created.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Y0tXcPrU4r"}],"key":"FWQyTIkxt6"}],"key":"vKG7IQj5r9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"client.shutdown()","key":"ulqvCgjuJm"},{"type":"output","id":"vpypQ2NpsNze17nWzwxKo","data":[],"key":"RYeO79RXh2"}],"key":"ECzt8Cia1x"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hu1syoQrzu"}],"key":"OzFbv9IFnE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iWaITKKvNb"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"o1RWxVUfBF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this notebook, we have learned about:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OpAIvtUCAO"}],"key":"SzsyXRgKlr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Dask DataFrame concept and component.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TgCU89S7hm"}],"key":"LSi3ZVrSYf"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"When to use and when to avoid Dask DataFrames?","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uM4YKIAoXr"}],"key":"hOVUvfKLf6"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"How to use Dask DataFrame?","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LRloHeHdMX"}],"key":"x6arAOS65O"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Some best practices around Dask DataFrames.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UrXrC2JMza"}],"key":"R8po9w0Fn1"}],"key":"edxWRRoeQw"},{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"JLVfuX5YX7"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"jsMQAEZX5v"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Reference","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KeJAoYMRtu"}],"key":"wxwm5b779x"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"https://dask.org/","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Dask Docs","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"UCabwtcKsk"}],"urlSource":"https://dask.org/","key":"zIzteCf7Mg"}],"key":"mFWV7kIHJG"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"https://examples.dask.org/","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Dask Examples","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TexuvIKt6Y"}],"urlSource":"https://examples.dask.org/","key":"BkmT16WEqz"}],"key":"SIBG3Qdtzk"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"link","url":"https://github.com/dask/dask/","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Dask Code","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"n0GBf5JXVU"}],"urlSource":"https://github.com/dask/dask/","error":true,"key":"pJzfLPeGKZ"}],"key":"CUU6mwGuHJ"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"link","url":"https://blog.dask.org/","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Dask Blog","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"gjvXVCsRXB"}],"urlSource":"https://blog.dask.org/","key":"HgJA8hFY0Q"}],"key":"ooRPGEVf5l"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"link","url":"https://pandas.pydata.org/docs/","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Pandas Docs","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ONHbHSRaGe"}],"urlSource":"https://pandas.pydata.org/docs/","key":"x9RThBy2VW"}],"key":"h8XbFVNhYO"}],"key":"Xw9nMKswvj"}],"key":"vxRv7RbTkP"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Ask for help","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"zFxAn7lGiw"}],"key":"ykrpKaWwXF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"link","url":"http://stackoverflow.com/questions/tagged/dask","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"inlineCode","value":"dask","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"VvWna9M8m3"}],"urlSource":"http://stackoverflow.com/questions/tagged/dask","key":"RQEGcRNZ58"},{"type":"text","value":" tag on Stack Overflow, for usage questions","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Q6kf6xvryj"}],"key":"subK1JLviv"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"link","url":"https://github.com/dask/dask/discussions","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"github discussions: dask","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"FoWSO74V9a"}],"urlSource":"https://github.com/dask/dask/discussions","error":true,"key":"Z9SLbT9uG7"},{"type":"text","value":" for general, non-bug, discussion, and usage questions","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"BDEQux9fvw"}],"key":"z7sNt3vY6T"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"link","url":"https://github.com/dask/dask/issues/new","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"github issues: dask","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FxqQMUXe5g"}],"urlSource":"https://github.com/dask/dask/issues/new","error":true,"key":"RDZ9JPwXQ9"},{"type":"text","value":" for bug reports and feature requests","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"K57SznNOtF"}],"key":"CrUCPNAlNS"}],"key":"Ub7g1fzJ0Z"}],"key":"YEu8HWQyAu"}],"key":"IZvQxvrJ0J"}],"key":"fAIyTr1EEk"}],"key":"W7QRW8e2l9"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Dask Array","url":"/dask-array","group":"Introductions to Dask"},"next":{"title":"Dask Schedulers","url":"/dask-cluster","group":"Dask Schedulers"}}},"domain":"http://localhost:3000"},"project":{"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"title":"Dask Cookbook","authors":[{"nameParsed":{"literal":"Negin Sobhani","given":"Negin","family":"Sobhani"},"name":"Negin Sobhani","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Brian Vanderwende","given":"Brian","family":"Vanderwende"},"name":"Brian Vanderwende","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Deepak Cherian","given":"Deepak","family":"Cherian"},"name":"Deepak Cherian","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Ben Kirk","given":"Ben","family":"Kirk"},"name":"Ben Kirk","id":"contributors-myst-generated-uid-3"}],"github":"https://github.com/projectpythia/dask-cookbook","copyright":"2024","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/dask-cookbook","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/00-dask-overview.ipynb"},{"file":"notebooks/01-dask-array.ipynb"},{"file":"notebooks/02-dask-dataframe.ipynb"}],"title":"Introductions to Dask"},{"children":[{"file":"notebooks/04-dask-cluster.ipynb"}],"title":"Dask Schedulers"},{"children":[{"file":"notebooks/03-dask-xarray.ipynb"}],"title":"Dask and Xarray"}],"thumbnail":"/dask-cookbook/build/3c53e14c00df126aad2585b810fdb885.svg","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/dask-cookbook/build/8429bc1c1826b03711115c7ba028f37e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Introductions to Dask"},{"slug":"dask-overview","title":"Dask Overview","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dask-array","title":"Dask Array","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dask-dataframe","title":"Dask DataFrame","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Dask Schedulers"},{"slug":"dask-cluster","title":"Dask Schedulers","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Dask and Xarray"},{"slug":"dask-xarray","title":"Parallelizing Xarray with Dask","description":"","date":"","thumbnail":"/dask-cookbook/build/efb0893141695015b5a57e9702d22b2e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/dask-cookbook/build/manifest-2671EB98.js";
import * as route0 from "/dask-cookbook/build/root-LMCDRB6W.js";
import * as route1 from "/dask-cookbook/build/routes/$-SJYMRUNJ.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/dask-cookbook/build/entry.client-UNPC4GT3.js");</script></body></html>